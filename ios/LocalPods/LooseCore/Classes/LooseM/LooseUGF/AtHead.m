
#import <Foundation/Foundation.h>

NSString *StringFromVocalData(Byte *data);



Byte kCowTestifyData[] = {64, 5, 10, 80, 209, 150, 88, 58, 75, 236, 121, 101, 110, 111, 109, 144};



Byte kCycleHolderValue[] = {82, 3, 11, 205, 110, 41, 81, 136, 104, 160, 226, 103, 115, 109, 39};



Byte k_guyAskValue[] = {87, 19, 7, 51, 213, 210, 214, 117, 71, 119, 108, 110, 101, 102, 47, 113, 120, 111, 108, 121, 114, 113, 111, 47, 117, 103, 147};



Byte kWithFromUpData[] = {87, 26, 7, 50, 74, 200, 228, 100, 37, 95, 111, 102, 110, 73, 121, 97, 80, 110, 111, 105, 116, 99, 97, 115, 110, 97, 114, 84, 114, 101, 100, 114, 79, 238};



Byte k_liveTitle[] = {93, 19, 11, 129, 212, 37, 199, 110, 252, 142, 161, 136, 182, 230, 150, 143, 229, 47, 165, 180, 232, 177, 164, 229, 147, 152, 230, 164, 186, 228, 189};



Byte kLassText[] = {51, 41, 4, 205, 32, 64, 37, 32, 61, 32, 183, 143, 229, 149, 141, 229, 162, 174, 232, 156, 158, 230, 185, 139, 232, 32, 64, 37, 61, 140, 170, 233, 161, 160, 230, 50, 149, 141, 229, 162, 174, 232, 80, 80, 65, 202};



Byte kRareTitle[] = {68, 50, 6, 47, 79, 123, 64, 37, 32, 61, 32, 68, 73, 129, 147, 229, 134, 149, 229, 32, 64, 37, 32, 61, 32, 183, 143, 229, 149, 141, 229, 162, 174, 232, 156, 158, 230, 185, 139, 232, 32, 64, 37, 61, 183, 143, 229, 149, 141, 229, 162, 174, 232, 80, 80, 65, 145};



Byte kPeakData[] = {53, 10, 4, 67, 97, 116, 97, 68, 121, 102, 105, 114, 101, 118, 158};



Byte k_lightningValue[] = {29, 7, 7, 89, 132, 155, 135, 114, 116, 83, 112, 105, 107, 115, 45};



Byte kCuriousTitle[] = {32, 21, 5, 53, 6, 165, 180, 232, 177, 164, 229, 129, 175, 232, 140, 170, 233, 168, 153, 229, 161, 138, 229, 141, 156, 230, 164};



Byte k_grayData[] = {2, 5, 7, 179, 58, 86, 160, 108, 101, 118, 101, 108, 191};



Byte kWeekCountGuyValue[] = {66, 16, 13, 184, 211, 33, 120, 225, 219, 192, 28, 249, 87, 64, 37, 61, 100, 73, 110, 111, 105, 116, 99, 97, 115, 110, 97, 114, 116, 183};



Byte kPageViewTitle[] = {24, 21, 8, 160, 205, 141, 238, 118, 129, 147, 229, 134, 149, 229, 165, 175, 232, 135, 191, 232, 176, 185, 228, 173, 180, 232, 178, 183, 229, 213};



Byte k_clinicValue[] = {16, 5, 11, 1, 253, 28, 121, 168, 221, 10, 104, 111, 110, 114, 114, 101, 168};



Byte k_entertainmentValue[] = {44, 3, 5, 237, 248, 112, 112, 65, 235};



Byte kSprinkleHolderWithName[] = {18, 9, 4, 41, 133, 163, 232, 137, 174, 229, 170, 156, 230, 162};



Byte k_skilledValue[] = {48, 13, 5, 75, 119, 100, 73, 110, 111, 105, 116, 99, 97, 115, 110, 97, 114, 116, 161};



Byte k_tableMethodValue[] = {13, 29, 5, 98, 237, 110, 112, 72, 119, 108, 78, 113, 107, 110, 110, 76, 113, 97, 108, 113, 111, 114, 47, 113, 120, 111, 108, 121, 114, 113, 111, 47, 117, 103, 185};



Byte k_propertyName[] = {77, 21, 3, 110, 112, 72, 119, 108, 110, 112, 107, 108, 47, 113, 120, 111, 108, 121, 114, 113, 111, 47, 117, 103, 124};



Byte k_weekText[] = {58, 4, 13, 201, 92, 35, 76, 118, 79, 116, 119, 109, 150, 97, 116, 97, 100, 109};



Byte k_labelTitle[] = {27, 7, 13, 104, 107, 67, 21, 133, 150, 233, 194, 119, 165, 100, 73, 114, 101, 100, 114, 111, 230};



Byte k_mornContent[] = {7, 14, 6, 43, 228, 174, 100, 73, 129, 147, 229, 167, 186, 228, 145, 176, 229, 186, 188, 231, 98};



Byte kOldenData[] = {44, 20, 13, 25, 109, 24, 145, 40, 156, 117, 180, 7, 35, 165, 180, 232, 177, 164, 229, 162, 175, 232, 165, 159, 230, 100, 73, 129, 147, 229, 167, 186, 228, 177};



Byte kSegmentCredibleValue[] = {86, 26, 5, 136, 21, 119, 117, 112, 97, 122, 77, 119, 108, 78, 113, 107, 110, 110, 108, 47, 113, 120, 111, 108, 121, 114, 113, 111, 47, 117, 103, 229};



Byte k_capacityValue[] = {2, 29, 5, 51, 252, 119, 117, 112, 97, 122, 77, 110, 112, 72, 119, 108, 78, 113, 107, 110, 110, 108, 47, 113, 120, 111, 108, 121, 114, 113, 111, 47, 117, 103, 139};



Byte k_museumSourceTitle[] = {70, 20, 10, 255, 39, 68, 32, 246, 188, 250, 110, 112, 72, 119, 108, 110, 101, 102, 47, 113, 120, 111, 108, 121, 114, 113, 111, 47, 117, 103, 46};



Byte kOldenValue[] = {55, 9, 12, 62, 166, 255, 15, 186, 34, 196, 50, 34, 100, 73, 116, 99, 117, 100, 111, 114, 112, 211};



Byte kVehicleClinicTitle[] = {18, 51, 12, 36, 154, 210, 96, 184, 109, 114, 27, 159, 64, 37, 32, 61, 32, 183, 143, 229, 149, 141, 229, 162, 174, 232, 80, 80, 65, 186, 187, 229, 155, 136, 229, 32, 64, 37, 154, 188, 239, 180, 151, 233, 182, 151, 230, 149, 141, 229, 162, 174, 232, 50, 80, 80, 65, 186, 187, 229, 155, 136, 229, 220};



Byte kVocalRequestTitle[] = {20, 51, 7, 124, 75, 250, 53, 64, 37, 32, 61, 32, 183, 143, 229, 149, 141, 229, 162, 174, 232, 80, 80, 65, 186, 187, 229, 155, 136, 229, 32, 64, 37, 154, 188, 239, 180, 151, 233, 182, 151, 230, 149, 141, 229, 162, 174, 232, 49, 80, 80, 65, 186, 187, 229, 155, 136, 229, 88};



Byte k_dominateTimeData[] = {50, 23, 8, 39, 61, 134, 84, 230, 117, 71, 110, 110, 76, 119, 108, 110, 112, 107, 108, 47, 113, 120, 111, 108, 121, 114, 113, 111, 47, 117, 103, 31};



Byte kSourceSwellTitle[] = {44, 30, 4, 130, 133, 190, 229, 137, 173, 231, 131, 191, 229, 144, 128, 232, 183, 175, 232, 140, 188, 239, 147, 152, 230, 164, 186, 228, 168, 156, 229, 163, 173, 230, 143};



Byte k_askData[] = {46, 26, 13, 83, 54, 150, 174, 125, 123, 189, 130, 170, 134, 119, 108, 78, 113, 107, 110, 110, 76, 113, 97, 108, 113, 111, 114, 47, 113, 120, 111, 108, 121, 114, 113, 111, 47, 117, 103, 83};












#import "AtHead.h"








static int APPLE_IAP_MAX_RETRY_COUNT = 9;



@interface AtHead()<SKProductsRequestDelegate,SKPaymentTransactionObserver>



@property (nonatomic, strong) JobBbbb *from;

@property (nonatomic, strong) SKProductsRequest *focus;

@property (nonatomic, copy)   NSString *status;  

@property (nonatomic, strong) NSMutableArray *model;


@property (nonatomic,assign) BOOL user;



@end


@implementation AtHead


+ (AtHead *)time {
    
    static AtHead *shared_manager = nil;
    
    static dispatch_once_t pred;
    
    dispatch_once(&pred, ^{
        
        shared_manager = [[self alloc] init];
        
        [[SKPaymentQueue defaultQueue] addTransactionObserver:shared_manager];
        
        [NSNotificationCenter.defaultCenter addObserver:shared_manager
                               
                               selector:@selector(extraAction)
                                   
                                   name:UIApplicationWillTerminateNotification
                                 
                                 object:nil];
    
    });
        
    
    return shared_manager;
}

- (instancetype)init{
    
    
    self = [super init];
    
    
    if (self) {
        
        [self initFileField];
    }
    
    return self;
}



- (void)initFileField{
    
    self.model = [[NSMutableArray alloc] init];
    
    NSString *payPath = [self information];
    
    if([[NSFileManager defaultManager] fileExistsAtPath:payPath]){
        
        NSArray *tempArr = [NSKeyedUnarchiver unarchiveObjectWithFile:payPath];
        
        for (PushFinish *temModel in tempArr) {
            
            temModel.retryTime = 0;
            
            temModel.isCurrentOrder = NO;
            
            [self.model addObjectsFromArray:tempArr];
        }
    }
    
    self.status = nil;
    
}



- (JobBbbb*)from{
    
    if (!_from) {
        
        _from=[[JobBbbb alloc] init];
    }
    
    return _from;
}


#pragma mark - aUGF5

- (void)refer:(NSString *)str compartment:(BOOL) isMember imageCard:(BOOL)isWtype{

    
    [MBProgressHUD showHUDAddedTo:[UIApplication sharedApplication].keyWindow animated:YES];
    
    HologramHead *setup=[[HologramHead alloc] init];
    
    setup.index=REQUEST_GET;
    
    if (isWtype) {
        
        if (isMember) {
            
            setup.pushTimeId = @{StringFromVocalData(k_grayData):str};
            
            setup.user = StringFromVocalData(k_museumSourceTitle);
        
        }else{
            
            setup.pushTimeId = @{StringFromVocalData(kCowTestifyData) : str};
            
            setup.user = StringFromVocalData(k_guyAskValue);
        }
    
    }else{
        
        if (isMember) {
            
            setup.pushTimeId = @{StringFromVocalData(k_grayData):str};
            
            setup.user = StringFromVocalData(k_propertyName);
        
        }else{
            
            setup.pushTimeId = @{StringFromVocalData(kCowTestifyData) : str};
            
            setup.user = StringFromVocalData(k_dominateTimeData);
        }
    }
    
    [self.from with:setup editFee:^(HologramHead *requestModel, NSDictionary *component, NSError *error) {
        
        [MBProgressHUD hideHUDForView:[UIApplication sharedApplication].keyWindow animated:YES];
        
        if (error) {
            
            [self push:error.localizedDescription];
            
            return;
        }
        
        NSDictionary* data=component[StringFromVocalData(k_weekText)];
        
        
        NSString *skipStr = data[StringFromVocalData(k_lightningValue)];

        
        [UIApplication event:[NSURL URLWithString:skipStr] isBirthdayCompletion:^(BOOL success) {
            
            if (success) {
                
                self.door = YES;
            
            } else {
                
                [self push:StringFromVocalData(kSprinkleHolderWithName)];
            }
        
        }];
    
    }];
}





#pragma mark - IAP重构


- (void)extraAction {
    
    
    [SKPaymentQueue.defaultQueue removeTransactionObserver:self];
}



- (void)collideWith {
    
    
    [self initFileField];
    
    [self collection];
}




#pragma mark - 苹果支付充值







- (void)last:(NSString *)productId{
    
    
    self.present = UGF5TypeNormal;
    
    HologramHead *setup = [[HologramHead alloc] init];
    
    setup.index = REQUEST_POST;
    
    setup.user  = StringFromVocalData(k_askData);
    
    setup.pushTimeId      = @{StringFromVocalData(kOldenValue):productId};
    
    [self inviteMsg:UGF5StateOrderBegin draft:nil];
    
    [[PlayColorBbbb size].admin with:setup
                                    
                                    editFee:^(HologramHead *requestModel, NSDictionary *component, NSError *error)
     {
        
        if(error){
            
            [self user:error];
            
            [self inviteMsg:UGF5StateOrderFail draft:nil];
            
            return;
        }
        
        NSString *msg = nil;
        
        NSDictionary *data = component[StringFromVocalData(k_weekText)];
        
        if (data && [data isKindOfClass:[NSDictionary class]]) {
            
            NSString *tmpOrder = data[StringFromVocalData(k_labelTitle)];
            
            if (tmpOrder.length > 0) {
                
                self.status = tmpOrder;
                
                self.user = YES;
                
                [[MomentBbbb time] conjugalFamily:DebugMessage file:[NSString stringWithFormat:StringFromVocalData(kVocalRequestTitle), [NSDate date],self.status]];

            }
            
            msg = component[StringFromVocalData(kCycleHolderValue)];
            
            [self product:productId];
        }
    
    }];
}


-(void)user:(PushFinish *)retryModel angel:(NSDictionary *)params{
    
    [[MomentBbbb time] conjugalFamily:DebugMessage file:[NSString stringWithFormat:StringFromVocalData(kLassText), retryModel.orderId,retryModel.transactionId]];
    
    
    HologramHead *setup = [[HologramHead alloc] init];
    
    setup.index = REQUEST_POST;
    
    setup.user  = StringFromVocalData(kSegmentCredibleValue);
    
    setup.pushTimeId      = params;
    
    [[PlayColorBbbb size].admin with:setup
                                    
                                    editFee:^(HologramHead *requestModel, NSDictionary *component, NSError *error)
     {
        
        NSInteger errCode = [component[StringFromVocalData(k_clinicValue)] integerValue];
        
        if (error && (errCode != 405)) { 
            
            if (retryModel.retryTime >= APPLE_IAP_MAX_RETRY_COUNT){
                
                [self inviteMsg:UGF5StateVerityFail draft:StringFromVocalData(kCuriousTitle)];
            }
        
        } else {
            
            [self changeList:retryModel.transactionId show:UGF5TypeNormal];
            
            [[NSNotificationCenter defaultCenter] postNotificationName:[CurrentUp giftOn]
                                                                
                                                                object:nil
                                                              
                                                              userInfo:component];
            
            [self inviteMsg:UGF5StateVerityOK draft:nil];
        }
        
        
        self.user = NO;
        
        [self collection];
    
    }];
    
}


#pragma mark - 苹果支付购买VIP

- (void)rec:(NSString *)levelStr{
    
    self.present = UGF5TypeMember;
    
    HologramHead *setup = [[HologramHead alloc] init];
    
    setup.index = REQUEST_POST;
    
    setup.user  = StringFromVocalData(k_tableMethodValue);

    
    setup.pushTimeId      = @{StringFromVocalData(k_grayData):levelStr};
    
    [self inviteMsg:UGF5StateOrderBegin draft:nil];
    
    [[PlayColorBbbb size].admin with:setup
                                    
                                    editFee:^(HologramHead *requestModel, NSDictionary *component, NSError *error)
     {
        
        if(error){
            
            [self user:error];
            
            [self inviteMsg:UGF5StateOrderFail draft:nil];
            
            return;
        }
        
        NSString *msg = nil;
        
        NSDictionary *data = component[StringFromVocalData(k_weekText)];
        
        if (data && [data isKindOfClass:[NSDictionary class]]) {
            
            NSString *tmpOrder = data[StringFromVocalData(k_labelTitle)];
            
            if (tmpOrder.length > 0) {
                
                self.status = tmpOrder;
                
                self.user = YES;
                
                [[MomentBbbb time] conjugalFamily:DebugMessage file:[NSString stringWithFormat:StringFromVocalData(kVehicleClinicTitle), [NSDate date],self.status]];

            }
            
            NSString *tmpProductID = data[StringFromVocalData(kOldenValue)];
            
            [self product:tmpProductID];
            
            msg = component[StringFromVocalData(kCycleHolderValue)];
        }
    
    }];
}


-(void)item:(PushFinish *)retryModel spreadhead:(NSDictionary *)params{
    
    [[MomentBbbb time] conjugalFamily:DebugMessage file:[NSString stringWithFormat:StringFromVocalData(kLassText), retryModel.orderId,retryModel.transactionId]];

    
    HologramHead *setup = [[HologramHead alloc] init];
    
    setup.index = REQUEST_POST;
    
    setup.user  = StringFromVocalData(k_capacityValue);
    
    setup.pushTimeId      = params;
    
    
    [[PlayColorBbbb size].admin with:setup
                                    
                                    editFee:^(HologramHead *requestModel, NSDictionary *component, NSError *error)
     {
        
        NSInteger errCode = [component[StringFromVocalData(k_clinicValue)] integerValue];
        
        if (error && (errCode != 405)) { 
            
            if (retryModel.retryTime >= APPLE_IAP_MAX_RETRY_COUNT){
                
                [self inviteMsg:UGF5StateVerityFail draft:StringFromVocalData(kCuriousTitle)];
            }
        
        } else {
            
            [self changeList:retryModel.transactionId show:(UGF5TypeMember)];
            
            [[NSNotificationCenter defaultCenter] postNotificationName:[CurrentUp giftOn]
                                                                
                                                                object:nil
                                                              
                                                              userInfo:component];
            
            [self inviteMsg:UGF5StateVerityOK draft:nil];
        }
        
        
        self.user = NO;
        
        [self collection];
    
    }];
    
}



#pragma mark - 共用


- (void)product:(NSString *)productId{
    
    
    if([SKPaymentQueue canMakePayments]){
        
        [self task]; 
        
        
        NSSet *identifiersSet = [NSSet setWithObject:productId];
        
        self.focus = [[SKProductsRequest alloc] initWithProductIdentifiers:identifiersSet];
        
        self.focus.delegate = self;
        
        [self.focus start];
    }
}


- (void)task{
    
    if(self.focus){
        
        self.focus.delegate = nil;
        
        [self.focus cancel];
        
        self.focus = nil;
    }
}




- (void)collection{
    
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
        
        if(self.user){ return;}
        
        for (PushFinish *model in self.model) {
            
            if(model.retryTime < APPLE_IAP_MAX_RETRY_COUNT){
                
                model.retryTime++;
                
                [self compound:model];
                
                return;
            }
        }
        
    
    });
    
}

- (void)compound:(PushFinish *)retryModel{
    
    NSString *receiptStr = [self with:retryModel.transactionId somebodyType:retryModel.payType];
    
    retryModel.verifyData = receiptStr;
    
    NSPredicate *predice = [NSPredicate predicateWithFormat:StringFromVocalData(kWeekCountGuyValue),retryModel.transactionId];

    
    if(retryModel.orderId != nil){
        
        NSArray* filterArray = [self.model filteredArrayUsingPredicate:predice];
        
        if(filterArray.count == 0){
            
            [self.model insertObject:retryModel atIndex:0];
            
            NSString *diskPath = [self information];
            
            if([NSKeyedArchiver archiveRootObject:self.model toFile:diskPath]){
                //: NSLog(@"写入成功");
            
            }else{
                
            }
        }
    }
    
    NSArray* filterArray = [self.model filteredArrayUsingPredicate:predice];
    
    if(filterArray.count > 0){
        
        PushFinish *tempModel = filterArray.firstObject;
        
        NSMutableDictionary *param = [[NSMutableDictionary alloc] init];
        
        [param setObject:tempModel.transactionId forKey:StringFromVocalData(k_skilledValue)];
        
        [param setObject:tempModel.verifyData forKey:StringFromVocalData(kPeakData)];
        
        [param setObject:tempModel.orderId forKey:StringFromVocalData(k_labelTitle)];
        
        if(tempModel.payType == UGF5TypeNormal){
            
            [self user:retryModel angel:param];
        
        }else{
            
            [self item:retryModel spreadhead:param];
        }
    }
}


- (NSString *)with:(NSString *)transactionId somebodyType:(UGF5Type)type{
    
    
    NSPredicate *predice = [NSPredicate predicateWithFormat:StringFromVocalData(kWeekCountGuyValue),transactionId];
    
    
    NSArray *payfilterArray = [self.model filteredArrayUsingPredicate:predice];
    
    if(payfilterArray.count > 0){
        
        PushFinish *model = payfilterArray.firstObject;
        
        if(model.verifyData != nil){
            
            return model.verifyData;
        }
    }
    
    
    NSURL *receiptUrl = NSBundle.mainBundle.appStoreReceiptURL;
    
    NSData *data = [NSData dataWithContentsOfURL:receiptUrl];
    
    NSString *receiptStr = [data base64EncodedStringWithOptions:0];
    
    return receiptStr;
}

- (void )changeList:(NSString *)transactionId show:(UGF5Type) type{
    
    NSPredicate *predice = [NSPredicate predicateWithFormat:StringFromVocalData(kWeekCountGuyValue),transactionId];
    
    NSArray* filterArray = [self.model filteredArrayUsingPredicate:predice];
    
    if(filterArray.count > 0 && [self.model containsObject:filterArray.firstObject]){
        
        [self.model removeObject:filterArray.firstObject];
        
        NSString *diskPath = [self information];
        
        if([NSKeyedArchiver archiveRootObject:self.model toFile:diskPath]){
            //: NSLog(@"写入成功");
        
        }else{
            
        }
    }
}

- (NSString *)information{
    
    NSString *documentDirectoryPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES).firstObject;
    
    
    NSString *appDirectoryPath = [documentDirectoryPath stringByAppendingPathComponent:StringFromVocalData(k_entertainmentValue)];
    
    
    NSFileManager *fm = [NSFileManager defaultManager];
    
    if ([fm fileExistsAtPath:appDirectoryPath] == NO) {
        
        [fm createDirectoryAtPath:appDirectoryPath withIntermediateDirectories:YES attributes:nil error:nil];
    }
    
    NSString *filePath = [appDirectoryPath stringByAppendingPathComponent:[NSString stringWithFormat:StringFromVocalData(kWithFromUpData),[PlayColorBbbb size].file.id]];
    
    return filePath;
}


#pragma mark - SKProductsRequestDelegate


- (void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response {
    
    
    NSArray *productList = response.products;
    
    if(productList.count > 0){
        
        SKMutablePayment *payment =  [SKMutablePayment paymentWithProduct:productList.firstObject];
        
        [SKPaymentQueue.defaultQueue addPayment:payment];
        
        return;
    }
    
    [self inviteMsg:UGF5StateMissing draft:StringFromVocalData(k_mornContent)];
}



- (void)request:(SKRequest *)request didFailWithError:(NSError *)error {
    
    
    [self inviteMsg:UGF5StateMissing draft:StringFromVocalData(kOldenData)];
}


#pragma mark - SKPaymentTransactionObserver


- (void)paymentQueue:(SKPaymentQueue *)queue removedTransactions:(NSArray<SKPaymentTransaction *> *)transactions {
}

- (void)paymentQueue:(SKPaymentQueue *)queue restoreCompletedTransactionsFailedWithError:(NSError *)error {
}


- (void)paymentQueueRestoreCompletedTransactionsFinished:(SKPaymentQueue *)queue {
}


- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactionsArr {
        
    
    for (SKPaymentTransaction *transaction in transactionsArr) {
        
        switch (transaction.transactionState) {
            
            case SKPaymentTransactionStatePurchasing: 
                
                break;
            
            case SKPaymentTransactionStatePurchased: 
            {
                
                PushFinish *model = [[PushFinish alloc] init];
                
                model.retryTime = 0;
                
                model.transactionId = transaction.transactionIdentifier;
                
                model.orderId = self.status;
                
                model.payType = self.present;
                
                model.isCurrentOrder = YES;
                
                [self compound:model];
                
                [[MomentBbbb time] conjugalFamily:DebugMessage file:[NSString stringWithFormat:StringFromVocalData(kRareTitle), self.status,model.transactionId,transaction.payment.productIdentifier]];
                
                [SKPaymentQueue.defaultQueue finishTransaction:transaction];
                
                self.status = nil;
            }
                
                break;
            
            case SKPaymentTransactionStateFailed: 
            {
                
                [self inviteMsg:UGF5StateFailed draft:StringFromVocalData(k_liveTitle)];
                
                [SKPaymentQueue.defaultQueue finishTransaction:transaction];
                
                self.status = nil;
                
                
                self.user = NO;
                
                [self collection];
            }
                
                break;
            
            case SKPaymentTransactionStateRestored: 
            {
                
                [self inviteMsg:UGF5StateRestored draft:StringFromVocalData(kPageViewTitle)];
                
                [SKPaymentQueue.defaultQueue finishTransaction:transaction];
                
                self.status = nil;
                
                
                self.user = NO;
                
                [self collection];
            }
                
                break;
                
            
            case SKPaymentTransactionStateDeferred: 
            {
                
                [self inviteMsg:UGF5StateDeferred draft:StringFromVocalData(kSourceSwellTitle)];
                
                self.user = NO;
                
                [self collection];
                
                break;
            }
                
                break;
            
            default:
                
                break;
        }
    }
}



- (void)inviteMsg:(UGF5State)resState draft:(NSString *)tipMsg
{
    
    if (self.pic){
        
        self.pic(resState,tipMsg);
    }
    
    if (tipMsg) {
        
        [[MomentBbbb time] conjugalFamily:DebugMessage file:tipMsg];
    }
}



@end



@implementation PushFinish


GJJNSCoding(PushFinish)


@end

Byte * VocalDataToCache(Byte *data) {
    int museum = data[0];
    int cowPasture = data[1];
    int peakEdge = data[2];
    if (!museum) return data + peakEdge;
    for (int i = 0; i < cowPasture / 2; i++) {
        int begin = peakEdge + i;
        int end = peakEdge + cowPasture - i - 1;
        Byte temp = data[begin];
        data[begin] = data[end];
        data[end] = temp;
    }
    data[0] = 0;
    data[peakEdge + cowPasture] = 0;
    return data + peakEdge;
}

NSString *StringFromVocalData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)VocalDataToCache(data)];
}  
