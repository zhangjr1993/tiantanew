
#import <Foundation/Foundation.h>

NSString *StringFromTotalmitData(Byte *data);



Byte kDemocraticLampData[] = {84, 18, 4, 105, 136, 182, 230, 150, 143, 229, 169, 188, 231, 139, 142, 229, 145, 162, 233, 134, 167, 232, 96};



Byte kSpinePrimaryText[] = {95, 12, 12, 233, 219, 131, 218, 30, 40, 8, 67, 190, 160, 188, 228, 138, 184, 228, 179, 141, 229, 139, 171, 231, 193};



Byte k_strawViewGiftName[] = {28, 23, 7, 236, 43, 157, 125, 83, 83, 83, 45, 115, 115, 58, 109, 109, 58, 72, 72, 45, 100, 100, 45, 77, 77, 45, 121, 121, 121, 121, 63};



Byte k_antiName[] = {61, 4, 11, 179, 72, 239, 190, 136, 124, 84, 32, 112, 109, 116, 47, 200};



Byte kRenderThreeData[] = {79, 33, 13, 82, 141, 70, 167, 214, 72, 130, 200, 166, 192, 166, 147, 229, 146, 167, 231, 100, 108, 37, 145, 176, 229, 179, 135, 232, 130, 177, 230, 129, 166, 232, 166, 186, 229, 191, 149, 233, 145, 162, 233, 134, 167, 232, 20};



Byte kJourneyValue[] = {4, 10, 10, 195, 194, 190, 154, 139, 217, 191, 101, 107, 97, 104, 115, 38, 109, 111, 111, 122, 209};



Byte kLatteValue[] = {52, 15, 7, 62, 41, 141, 254, 101, 108, 97, 99, 115, 46, 109, 114, 111, 102, 115, 110, 97, 114, 116, 118};



Byte k_viewTwiceValue[] = {85, 6, 9, 89, 122, 49, 93, 35, 113, 144, 136, 230, 140, 174, 229, 40};



Byte k_notebookData[] = {19, 24, 13, 190, 140, 106, 234, 59, 31, 44, 88, 38, 72, 143, 188, 229, 188, 160, 230, 145, 162, 233, 134, 167, 232, 132, 154, 231, 129, 140, 230, 175, 148, 230, 141, 184, 228, 184};



Byte kAssociationText[] = {52, 6, 10, 193, 124, 133, 36, 204, 109, 199, 136, 182, 230, 150, 143, 229, 200};



Byte kMinimizeTitle[] = {15, 27, 13, 197, 177, 98, 10, 120, 12, 194, 229, 3, 175, 135, 137, 231, 167, 133, 231, 160, 188, 229, 128, 184, 228, 169, 139, 230, 137, 128, 233, 145, 176, 229, 179, 135, 232, 183, 175, 232, 6};



Byte k_mailContent[] = {33, 23, 9, 115, 252, 213, 61, 208, 80, 114, 111, 110, 95, 112, 104, 111, 116, 111, 95, 97, 100, 100, 95, 89, 56, 73, 119, 121, 114, 110, 116, 98, 48};



Byte k_positName[] = {96, 20, 9, 135, 226, 231, 69, 41, 66, 52, 112, 109, 46, 100, 37, 45, 64, 37, 45, 111, 101, 100, 105, 118, 47, 112, 109, 116, 47, 169};



Byte k_peatWorldwideData[] = {76, 26, 8, 43, 59, 67, 206, 163, 114, 111, 110, 95, 112, 104, 111, 116, 111, 95, 99, 104, 111, 105, 99, 101, 95, 108, 112, 84, 50, 81, 82, 110, 116, 98, 9};



Byte k_chickValue[] = {40, 26, 9, 245, 209, 82, 234, 184, 153, 101, 114, 112, 95, 112, 104, 111, 116, 111, 95, 99, 104, 111, 105, 99, 101, 95, 48, 99, 90, 67, 104, 117, 110, 116, 98, 202};



Byte k_adoptionTitle[] = {99, 4, 10, 5, 161, 105, 95, 187, 108, 162, 53, 49, 44, 51, 50};



Byte kWhisperSpecificData[] = {68, 18, 10, 13, 71, 32, 170, 242, 161, 150, 110, 111, 105, 116, 97, 116, 111, 114, 46, 109, 114, 111, 102, 115, 110, 97, 114, 116, 103};



Byte k_celebrateText[] = {90, 6, 5, 248, 65, 131, 188, 229, 190, 148, 230, 251};



Byte kLeaseData[] = {60, 46, 4, 162, 126, 166, 147, 229, 129, 128, 230, 168, 138, 229, 131, 184, 229, 145, 143, 229, 165, 187, 228, 175, 143, 229, 141, 137, 230, 142, 144, 229, 143, 131, 229, 180, 164, 229, 186, 186, 228, 159, 156, 231, 160, 188, 228, 138, 184, 228, 24};




















#import "AtCurrent.h"
#import "CloudHeadViewController.h"
#import "DisplayColorViewController.h"
#import "TextBbbb.h"
#import "ByPush.h"
#import "ManagingDirectorBbbb.h"
#import "TZImagePickerController.h"

@implementation AtCurrent


+ (void)unclasp:(UIButton *)btn {

    
    if (btn == nil) {
        
        return;
    }

    
    CGFloat angle1 = DegreesToRadians(0);
    
    CGFloat angle2 = DegreesToRadians(10);
    
    CGFloat angle3 = DegreesToRadians(-10);
    
    CGFloat angle4 = DegreesToRadians(10);
    
    CGFloat angle5 = DegreesToRadians(-10);
    
    CGFloat angle6 = DegreesToRadians(0);


    
    CGFloat du1 = 0;
    
    CGFloat du2 = 0.13;
    
    CGFloat du3 = 0.3;
    
    CGFloat du4 = 0.47;
    
    CGFloat du5 = 0.8;
    
    CGFloat du6 = 1.f;

    
    
    CAKeyframeAnimation *roate = [CAKeyframeAnimation animationWithKeyPath:StringFromTotalmitData(kWhisperSpecificData)];
    
    roate.values = @[@(angle1),@(angle2),@(angle3),@(angle4),@(angle5),@(angle6),];
    
    roate.keyTimes = @[@(du1),@(du2),@(du3),@(du4),@(du5),@(du6),];

    
    
    CAKeyframeAnimation *zoom = [CAKeyframeAnimation animationWithKeyPath:StringFromTotalmitData(kLatteValue)];
    
    zoom.values = @[@(1.f),@(1.2),@(1.f),];
    
    zoom.keyTimes = @[@(0),@(0.5),@(1.f),];

    
    
    CAAnimationGroup *groupAnnimation = [CAAnimationGroup animation];
    
    groupAnnimation.autoreverses = NO;
    
    groupAnnimation.animations = @[roate,zoom,];
    
    groupAnnimation.duration = 1.f;
    
    groupAnnimation.repeatCount = 2;
    
    groupAnnimation.removedOnCompletion = NO;
    
    groupAnnimation.fillMode = kCAFillModeForwards;
    
    [btn.layer addAnimation:groupAnnimation forKey:StringFromTotalmitData(kJourneyValue)];

}


+ (void)streetSmart:(UIViewController *)vc
                              
                              mobileBbbb:(NSInteger)maxCount
                            
                            from:(BOOL)isCanVideo
                       
                       accept:(void(^)(NSArray <UIImage *> *photos))imageCompletion
                       
                       blood:(void(^)(ServerBbbb *videoInfo))videoCompletion
{

    
    @autoreleasepool {} __weak __typeof__(self) self_weak_ = (self);;




    
    [RidBbbb initAnyItemBbbb:vc
                                     
                                     index:maxCount
                                 
                                 picBbbb:isCanVideo
                                 
                                 hide:YES
                               
                               manufacturer:YES
                                
                                away:(maxCount != 9)
                                
                                gender:nil
                                     
                                     momentOfTruth:^(NSArray<UIImage *> * _Nonnull photos) {
        
        if (imageCompletion) {
            
            imageCompletion(photos);
        }
    
    } pull:^(NSURL * _Nonnull filePath) {
        
        @autoreleasepool {}
         __strong __typeof__(self) self = self_weak_;
                        ;
        
        DisplayColorViewController *videoVC = [[DisplayColorViewController alloc] initMax:30 disableHandler:filePath voiceBy:^(DisplayColorViewController * _Nonnull vc, ServerBbbb * _Nonnull videoInfo, BOOL flag) {
            
            if (flag == NO && vc.heather) {
                
                dispatch_after(dispatch_time((0ull), (int64_t)(0.5 * 1000000000ull)), dispatch_get_main_queue(), ^{
                    
                    [self push:StringFromTotalmitData(kDemocraticLampData)];
                
                });
            }
            
            if (flag) {
                
                [[TextBbbb commonBlock] phaseOfTheMoon:videoInfo displayMicTime:^(NSString * _Nonnull outputPath,NSString * _Nonnull coverPath) {
                    
                    videoInfo.videoPath = outputPath;
                    
                    videoInfo.coverPath = coverPath;
                    
                    if (videoCompletion) {
                        
                        [[self faceDelay] dismissViewControllerAnimated:YES completion:^{
                            
                            videoCompletion(videoInfo);
                        
                        }];
                    }
                
                }];
            
            }else{
                
                [[TextBbbb commonBlock] sharedBbbb];
            }
        
        }];
        
        [[self faceDelay].navigationController pushViewController:videoVC animated:YES];
    
    }];
}


+ (BOOL)video{
    
    if ([PlayColorBbbb size].itemImage == skinStyle_Normal == NO) {
        
        return YES;
    }

    
    
    if ([PlayColorBbbb size].file.hasFemaleAuditDoor) {
        
        if ([PlayColorBbbb size].file.femaleAuditDoor) {
            
            return YES;
        
        }else{
            
            [[ByPush instance]equalBbbb];
            
            return NO;
        }
    }

    
    BOOL enable = YES;
    
    
    if ([PlayColorBbbb size].file.sex == Gender_Female )
    {
        
        if ([PlayColorBbbb size].familyDescriptionAddtion.doorType == 1 && ![[PlayColorBbbb size].file.isTPAuth isEqualToString:@"2"]) {
            
            enable = NO;
            
            [[ByPush instance] masterKey];
        }
    
    }else{
        
        if (![PlayColorBbbb size].file.hasPic) {
            
            enable = NO;
            
            ImageButton* giveup = [[ImageButton alloc] initWithTimeCurrent:StringFromTotalmitData(k_celebrateText) merge:(AlertButtonType0) like:^{

            
            }];
            
            ImageButton* upload = [[ImageButton alloc] initWithTimeCurrent:StringFromTotalmitData(kSpinePrimaryText) merge:(AlertButtonType1) like:^{
                
                [[PlayColorBbbb size] storageInfo];
            
            }];
            
            MutualView* uploadAvatarAlert = [[MutualView alloc] initWithPlanSquare:nil phone:StringFromTotalmitData(kLeaseData) age:@[giveup,upload]];
            
            [uploadAvatarAlert setLevelIn:(NSTextAlignmentCenter)];
            
            [uploadAvatarAlert of];
        }
    }


    
    return enable;
}


+ (void)show:(UIViewController *)vc
                          
                          bbbb:(NSInteger)maxCount
                   
                   associate:(void (^)(NSArray<UIImage *> * _Nonnull))imageCompletion
                   
                   standing:(void (^)(ServerBbbb * _Nonnull))videoCompletion {

    
    [RidBbbb initAnyItemBbbb:vc
                                     
                                     index:1
                                 
                                 picBbbb:YES
                                 
                                 hide:YES
                               
                               manufacturer:YES
                                
                                away:NO
                                
                                gender:StringFromTotalmitData(k_adoptionTitle)
                                     
                                     momentOfTruth:^(NSArray<UIImage *> * _Nonnull photos) {
        
        if (imageCompletion) {
            
            imageCompletion(photos);
        }
    
    } pull:^(NSURL * _Nonnull filePath) {
        
        DisplayColorViewController *videoVC = [[DisplayColorViewController alloc] initMax:15 disableHandler:filePath voiceBy:^(DisplayColorViewController * _Nonnull vc, ServerBbbb * _Nonnull videoInfo, BOOL flag) {

            
            if (flag == NO && vc.heather) {
                
                dispatch_after(dispatch_time((0ull), (int64_t)(0.5 * 1000000000ull)), dispatch_get_main_queue(), ^{
                    
                    [self push:StringFromTotalmitData(kDemocraticLampData)];
                
                });
            }
            
            if (flag) {
                
                [[TextBbbb commonBlock] phaseOfTheMoon:videoInfo displayMicTime:^(NSString * _Nonnull outputPath,NSString * _Nonnull coverPath) {
                    
                    videoInfo.videoPath = outputPath;
                    
                    videoInfo.coverPath = coverPath;
                    
                    if (videoCompletion) {
                        
                        [[self faceDelay] dismissViewControllerAnimated:YES completion:^{
                            
                            videoCompletion(videoInfo);
                        
                        }];
                    }
                
                }];
            
            }else{
                
                [[TextBbbb commonBlock] sharedBbbb];
            }
        
        }];
        
        [[self faceDelay].navigationController pushViewController:videoVC animated:YES];
    
    }];
}


+ (void)bbbbCustom:(UIViewController *)vc
                        
                        cycleGiftBbbb:(NSInteger)count
                          
                          move:(void(^)(UserBbbb *wrap))completion{
    
    
    if (![self video]) {
        
        return;
    }

    
    [AtCurrent streetSmart:vc mobileBbbb:count from:YES accept:^(NSArray<UIImage *> * _Nonnull photos) {

        
        CloudHeadViewController *releaseVC = [[CloudHeadViewController alloc]initWithName:photos];

        
        [releaseVC setCanAssociated:^(UserBbbb *wrap) {
            
            if (completion) {
                
                completion(wrap);
            }
        
        }];

         
         UINavigationController *navi = [[UINavigationController alloc]initWithRootViewController:releaseVC];
         
         if (@available(iOS 13, *)) {
             
             navi.modalPresentationStyle = UIModalPresentationFullScreen;
         }
         
         [vc presentViewController:navi animated:YES completion:nil];

    
    } blood:^(ServerBbbb * _Nonnull videoInfo) {
        
        CloudHeadViewController *releaseVC = [[CloudHeadViewController alloc]initGirl:videoInfo];


         
         [releaseVC setCanAssociated:^(UserBbbb *wrap) {
             
             if (completion) {
                 
                 completion(wrap);
             }
         
         }];

         
         UINavigationController *navi = [[UINavigationController alloc]initWithRootViewController:releaseVC];
         
         if (@available(iOS 13, *)) {
             
             navi.modalPresentationStyle = UIModalPresentationFullScreen;
         }
         
         [vc presentViewController:navi animated:YES completion:nil];
    
    }];
}





+ (void)display:(UIViewController *)vc
                                   
                                   statusBbbb:(BOOL)isCanVideo
                              
                              memberBbbb:(void(^)(NSArray <UIImage *> *photos))imageCompletion
                              
                              telecasting:(void(^)(ServerBbbb *videoInfo))videoCompletion {
    
    TZImagePickerController *imagePickerVc = [self view:1];
    
    imagePickerVc.allowPickingVideo = isCanVideo;
    
    @autoreleasepool {} __weak __typeof__(self) self_weak_ = (self);;
    
    [imagePickerVc setDidFinishPickingPhotosHandle:^(NSArray<UIImage *> *photos, NSArray *assets, BOOL isSelectOriginalPhoto) {
        
        if (imageCompletion) {
            
            imageCompletion(photos);
        }
    
    }];
    
    [imagePickerVc setDidFinishPickingVideoHandle:^(UIImage *coverImage, PHAsset *asset) {
        
        @autoreleasepool {}
         __strong __typeof__(self) self = self_weak_;
                        ;
        
        if (roundf(asset.duration) < 5) {
            
            [self push:[NSString stringWithFormat:StringFromTotalmitData(kRenderThreeData),5]];
            
            return;
        }
        
        [self requestBy:asset store:YES comeUponTop:videoCompletion];
    
    }];

    
    [imagePickerVc setSelectVideoBlock:^(PHAsset *asset) {
        
        @autoreleasepool {}
         __strong __typeof__(self) self = self_weak_;
                        ;
        
        [self requestBy:asset store:NO comeUponTop:videoCompletion];
    
    }];
    
    if (@available(iOS 13, *)) {
        
        imagePickerVc.modalPresentationStyle = UIModalPresentationFullScreen;
    }
    
    [vc presentViewController:imagePickerVc animated:YES completion:nil];

}



+ (TZImagePickerController *)view:(NSInteger)maxCount{

    
    TZImagePickerController *imagePickerVc = [[TZImagePickerController alloc] initWithMaxImagesCount:maxCount columnNumber:4 delegate:nil];

    
    imagePickerVc.navigationBar.barTintColor = [UIColor blackColor];

    
    imagePickerVc.allowPickingVideo = YES;






    
    imagePickerVc.allowTakeVideo = imagePickerVc.allowTakePicture;
    
    imagePickerVc.minPhotoWidthSelectable = 250;
    
    imagePickerVc.minPhotoHeightSelectable = 250;
    
    imagePickerVc.hideWhenCanNotSelect = YES;
    
    imagePickerVc.autoDismiss = YES;
    
    imagePickerVc.showSelectBtn = YES;
    
    imagePickerVc.sortAscendingByModificationDate = NO;
    
    imagePickerVc.oKButtonTitleColorNormal = UIColor.whiteColor;
    
    imagePickerVc.oKButtonTitleColorDisabled = UIColor.whiteColor;
    
    imagePickerVc.photoNumberIconImage = nil;
    
    imagePickerVc.photoSelImage = [UserTextImage imageNamed:StringFromTotalmitData(k_chickValue)];
    
    imagePickerVc.photoDefImage = [UserTextImage imageNamed:StringFromTotalmitData(k_peatWorldwideData)];
    
    imagePickerVc.naviBgColor = UIColor.whiteColor;

    
    imagePickerVc.naviTitleColor = [UIColor colorWithHexString:((__bridge NSString *)CFSTR("#333333"))];
    
    imagePickerVc.naviTitleFont = [UIFont underbelly:PFSCTypeMedium substance:16];

    
    imagePickerVc.barItemTextColor = [UIColor colorWithHexString:((__bridge NSString *)CFSTR("#666666"))];
    
    imagePickerVc.barItemTextFont = [UIFont underbelly:PFSCTypeMedium substance:16];

    
    imagePickerVc.allowPickingOriginalPhoto = NO;
    
    imagePickerVc.showPhotoCannotSelectLayer = YES;
    
    imagePickerVc.cannotSelectLayerColor = [UIColor colorWithRed:(255)/255.0f green:(255)/255.0f blue:(255)/255.0f alpha:0.5];
    
    imagePickerVc.takePictureImage = [UserTextImage imageNamed:StringFromTotalmitData(k_mailContent)];

    
    imagePickerVc.doneBtnTitleStr = StringFromTotalmitData(k_viewTwiceValue);

    
    imagePickerVc.alwaysEnableDoneBtn = YES;
    
    imagePickerVc.isCustomUI = YES;

    
    [imagePickerVc setUiImagePickerControllerSettingBlock:^(UIImagePickerController *imagePickerController) {
        
        imagePickerController.videoQuality = UIImagePickerControllerQualityTypeIFrame1280x720;
    
    }];

    
    imagePickerVc.statusBarStyle = UIStatusBarStyleDefault;

    
    [imagePickerVc setNavLeftBarButtonSettingBlock:^(UIButton *leftButton) {
        
        [leftButton setTitle:StringFromTotalmitData(kAssociationText) forState:(UIControlStateNormal)];
        
        [leftButton setTitleColor:[UIColor colorWithHexString:((__bridge NSString *)CFSTR("#666666"))] forState:(UIControlStateNormal)];
        
        leftButton.titleLabel.font = [UIFont underbelly:PFSCTypeMedium substance:16];
    
    }];

    [imagePickerVc setDoneButtonClickNoData:^{
        
        MBProgressHUD *HUD = [MBProgressHUD showHUDAddedTo:[UIApplication sharedApplication].delegate.window animated:YES];
        
        HUD.label.text = StringFromTotalmitData(kMinimizeTitle);
        
        HUD.mode = MBProgressHUDModeText;

        
        HUD.contentColor = [UIColor whiteColor];
        
        HUD.bezelView.color = [UIColor blackColor];

        
        HUD.removeFromSuperViewOnHide = YES;
        
        [HUD showAnimated:YES];
        
        [HUD hideAnimated:YES afterDelay:1];
    
    }];


    
    [imagePickerVc setPhotoPickerPageDidLayoutSubviewsBlock:^(UICollectionView *collectionView, UIView *bottomToolBar, UIButton *previewButton, UIButton *originalPhotoButton, UILabel *originalPhotoLabel, UIButton *doneButton, UIImageView *numberImageView, UILabel *numberLabel, UIView *divideLine) {

        
        doneButton.frame = CGRectMake(screenWidth() - 70 - 15, 10, 70, 28);
        
        doneButton.layer.cornerRadius = 14;
        
        doneButton.titleLabel.font = [UIFont underbelly:PFSCTypeMedium substance:14];
        
        [doneButton setTitleColor:UIColor.whiteColor forState:UIControlStateNormal];
        
        doneButton.userInteractionEnabled = NO;
        
        doneButton.backgroundColor = [UIColor colorWithHexString:((__bridge NSString *)CFSTR("#eeeeee"))];
        
        numberLabel.hidden = YES;
        
        previewButton.hidden = YES;
    
    }];

    
    [imagePickerVc setPhotoPreviewPageDidLayoutSubviewsBlock:^(UICollectionView *collectionView, UIView *naviBar, UIButton *backButton, UIButton *selectButton, UILabel *indexLabel, UIView *toolBar, UIButton *originalPhotoButton, UILabel *originalPhotoLabel, UIButton *doneButton, UIImageView *numberImageView, UILabel *numberLabel) {
        
        doneButton.frame = CGRectMake(screenWidth() - 70 - 15, 10, 70, 28);
        
        doneButton.layer.cornerRadius = 14;
        
        doneButton.titleLabel.font = [UIFont underbelly:PFSCTypeMedium substance:14];
        
        [doneButton setTitleColor:UIColor.whiteColor forState:UIControlStateNormal];
        
        numberLabel.hidden = YES;
    
    }];

    
    [imagePickerVc setAssetCellDidLayoutSubviewsBlock:^(TZAssetCell *cell, UIImageView *imageView, UIImageView *selectImageView, UILabel *indexLabel, UIView *bottomView, UILabel *timeLength, UIImageView *videoImgView) {
        
        selectImageView.frame = CGRectMake(imageView.width - 28, 4, 24, 24);
    
    }];

    
    return imagePickerVc;
}


+ (void)requestBy:(PHAsset *)asset store:(BOOL)isPush comeUponTop:(void(^)(ServerBbbb *videoInfo))videoCompletion
{
    
    @autoreleasepool {} __weak __typeof__(self) self_weak_ = (self);;
    
    [self from:asset recordAlbum:^(NSURL *filePatch) {
        
        @autoreleasepool {}
         __strong __typeof__(self) self = self_weak_;
                        ;
        
        DisplayColorViewController *videoVC = [[DisplayColorViewController alloc] initMax:30 disableHandler:filePatch voiceBy:^(DisplayColorViewController * _Nonnull vc, ServerBbbb * _Nonnull videoInfo, BOOL flag) {
            
            if (flag == NO && vc.heather) {
                
                dispatch_after(dispatch_time((0ull), (int64_t)(0.5 * 1000000000ull)), dispatch_get_main_queue(), ^{
                    
                    [self push:StringFromTotalmitData(kDemocraticLampData)];
                
                });
            }
            
            if (flag) {
                
                [[TextBbbb commonBlock] phaseOfTheMoon:videoInfo displayMicTime:^(NSString * _Nonnull outputPath,NSString * _Nonnull coverPath) {
                    
                    videoInfo.videoPath = outputPath;
                    
                    videoInfo.coverPath = coverPath;

                    
                    if (videoCompletion) {
                        
                        if(isPush){
                            
                            videoCompletion(videoInfo);
                            
                            [[self faceDelay].navigationController popViewControllerAnimated:YES];
                        
                        }else{
                            
                            [[self faceDelay] dismissViewControllerAnimated:YES completion:^{
                                
                                videoCompletion(videoInfo);
                            
                            }];
                        }

                    }
                
                }];
            
            }else{
                
                [[TextBbbb commonBlock] sharedBbbb];
            }
        
        }];
        
        [[self faceDelay].navigationController pushViewController:videoVC animated:YES];

    
    }];

}


+ (void)from:(PHAsset *)phaasset recordAlbum:(void (^)(NSURL *filePatch))result {

    
    PHVideoRequestOptions *options = [[PHVideoRequestOptions alloc] init];
    
    options.version = PHVideoRequestOptionsVersionCurrent;
    
    options.deliveryMode = PHVideoRequestOptionsDeliveryModeAutomatic;
    
    options.networkAccessAllowed = YES;
    
    [[PHImageManager defaultManager] requestAVAssetForVideo:phaasset options:options resultHandler:^(AVAsset * _Nullable asset, AVAudioMix * _Nullable audioMix, NSDictionary * _Nullable info) {
         
         if ([asset isKindOfClass:[AVURLAsset class]]) {
             
             AVURLAsset *urlAsset = (AVURLAsset *)asset;
             
             NSURL *urlPath = urlAsset.URL;
             
             dispatch_async(dispatch_get_main_queue(), ^{
                 
                 result(urlPath);
             
             });
         
         }else if([asset isKindOfClass:[AVComposition class]]){ 
             
             NSString *outPutPath = [self send];
             
             NSURL *outPutUrl = [NSURL fileURLWithPath:outPutPath];
             
             AVAssetExportSession *exportSession = [[AVAssetExportSession alloc]initWithAsset:asset presetName:AVAssetExportPresetHighestQuality];
              
              exportSession.outputURL = outPutUrl;
              
              exportSession.outputFileType = AVFileTypeMPEG4;
              
              exportSession.shouldOptimizeForNetworkUse = YES;
             
             if (![[NSFileManager defaultManager] fileExistsAtPath:[NSHomeDirectory() stringByAppendingFormat:StringFromTotalmitData(k_antiName)]]) {
                 
                 [[NSFileManager defaultManager] createDirectoryAtPath:[NSHomeDirectory() stringByAppendingFormat:StringFromTotalmitData(k_antiName)] withIntermediateDirectories:YES attributes:nil error:nil];
             }
              //: [exportSession exportAsynchronouslyWithCompletionHandler:^{
              [exportSession exportAsynchronouslyWithCompletionHandler:^{
                  //: switch ([exportSession status])
                  switch ([exportSession status])
                  {
                       //: case AVAssetExportSessionStatusFailed:
                       case AVAssetExportSessionStatusFailed:
                            //: NSLog(@"Export session failed");
                            
                            break;
                       
                       case AVAssetExportSessionStatusCancelled:
                            //: NSLog(@"Export canceled");
                            
                            break;
                       
                       case AVAssetExportSessionStatusCompleted:
                       {
                            //: NSLog(@"Successful!");
                           
                           dispatch_async(dispatch_get_main_queue(), ^{
                               
                               result(outPutUrl);
                           
                           });
                       }
                            
                            break;
                       
                       default:
                            
                            break;
                   }
              
              }];
         
         }else{
             
             [self push:StringFromTotalmitData(k_notebookData)];
         }
     
     }];
}

+ (NSString *)send {
    
    NSDateFormatter *formater = [[NSDateFormatter alloc] init];
    
    [formater setDateFormat:StringFromTotalmitData(k_strawViewGiftName)];
    
    NSString *outputPath = [NSHomeDirectory() stringByAppendingFormat:StringFromTotalmitData(k_positName), [formater stringFromDate:[NSDate date]], arc4random_uniform(10000000)];
    
    return outputPath;
}


+ (UIViewController *)faceDelay{
    
    UIWindow *window = [[UIApplication sharedApplication].delegate window];
    
    UIViewController *topViewController = [window rootViewController];

    
    while (true) {

        
        if (topViewController.presentedViewController) {

            
            topViewController = topViewController.presentedViewController;

        
        } else if ([topViewController isKindOfClass:[UINavigationController class]] && [(UINavigationController*)topViewController topViewController]) {

            
            topViewController = [(UINavigationController *)topViewController topViewController];

        
        } else if ([topViewController isKindOfClass:[UITabBarController class]]) {

            
            UITabBarController *tab = (UITabBarController *)topViewController;
            
            topViewController = tab.selectedViewController;

        
        } else {
            
            break;
        }
    }
    
    return topViewController;
}


@end


Byte * TotalmitDataToCache(Byte *data) {
    int synchroniseEnjoy = data[0];
    int refuseYer = data[1];
    int participateTab = data[2];
    if (!synchroniseEnjoy) return data + participateTab;
    for (int i = 0; i < refuseYer / 2; i++) {
        int begin = participateTab + i;
        int end = participateTab + refuseYer - i - 1;
        Byte temp = data[begin];
        data[begin] = data[end];
        data[end] = temp;
    }
    data[0] = 0;
    data[participateTab + refuseYer] = 0;
    return data + participateTab;
}

NSString *StringFromTotalmitData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)TotalmitDataToCache(data)];
}  
