
#import <Foundation/Foundation.h>
typedef struct {
    Byte pathTableSucceed;
    Byte *labelHut;
    unsigned int sandwichWalking;
    bool sourcePhenomSpar;
	int perceivedSucceed;
} AstonishingFinish;

NSString *StringFromAmazingData(AstonishingFinish *data);



AstonishingFinish kEticData = (AstonishingFinish){161, (Byte []){195, 213, 207, 228, 243, 153, 195, 151, 205, 254, 216, 205, 209, 196, 211, 254, 202, 205, 192, 213, 254, 207, 206, 211, 183}, 24, false, 202};



AstonishingFinish kDateTitle = (AstonishingFinish){116, (Byte []){146, 228, 232, 147, 192, 214, 156, 213, 220, 146, 247, 241, 150, 244, 210, 150}, 15, false, 100};



AstonishingFinish kForeignEnableData = (AstonishingFinish){83, (Byte []){49, 39, 61, 55, 34, 1, 6, 62, 97, 12, 55, 33, 60, 49, 42, 54, 56, 12, 56, 63, 50, 39, 12, 35, 33, 54, 193}, 26, false, 94};



AstonishingFinish kNumberactTitle = (AstonishingFinish){231, (Byte []){2, 104, 113, 1, 81, 111, 34}, 6, false, 184};



AstonishingFinish k_currentWeekCountData = (AstonishingFinish){232, (Byte []){132, 141, 134, 143, 156, 128, 184}, 6, false, 218};



AstonishingFinish k_rareName = (AstonishingFinish){161, (Byte []){68, 46, 48, 72, 33, 32, 125}, 6, false, 184};



AstonishingFinish kAmazingBackName = (AstonishingFinish){108, (Byte []){14, 24, 2, 51, 24, 13, 0, 7, 51, 7, 9, 21, 14, 3, 13, 30, 8, 51, 2, 3, 30, 188}, 21, false, 144};



AstonishingFinish k_amazingContent = (AstonishingFinish){236, (Byte []){133, 130, 156, 153, 152, 179, 201, 172, 179, 201, 172, 217}, 11, false, 20};



AstonishingFinish kPunchTitle = (AstonishingFinish){230, (Byte []){148, 135, 136, 129, 131, 235}, 5, false, 217};



AstonishingFinish k_residencyName = (AstonishingFinish){3, (Byte []){228, 128, 174, 230, 185, 165, 235, 189, 189, 53, 51, 230, 140, 172, 235, 164, 160, 234, 151, 130, 235, 172, 174, 234, 156, 176, 95}, 26, false, 133};



AstonishingFinish k_boringAttributeTitle = (AstonishingFinish){230, (Byte []){1, 91, 72, 15, 71, 80, 0, 80, 110, 0, 103, 73, 9, 90, 124, 195, 156, 130, 15, 116, 93, 1, 121, 85, 201, 0, 123, 71, 206}, 28, false, 209};



AstonishingFinish kBiologicValue = (AstonishingFinish){78, (Byte []){171, 193, 223, 167, 206, 207, 166, 225, 227, 167, 209, 253, 167, 210, 206, 166, 232, 207, 166, 224, 241, 167, 217, 224, 168, 204, 230, 169, 212, 202, 167, 244, 232, 171, 203, 197, 167, 237, 192, 161, 242, 194, 166, 225, 249, 171, 199, 195, 171, 240, 206, 166, 224, 240, 169, 243, 224, 167, 212, 222, 169, 233, 207, 170, 246, 227, 168, 199, 221, 171, 242, 206, 167, 244, 232, 171, 203, 197, 167, 237, 192, 168, 211, 205, 167, 215, 222, 40}, 87, false, 47};



AstonishingFinish k_filmLabelValue = (AstonishingFinish){222, (Byte []){56, 82, 87, 58, 99, 81, 254, 54, 113, 106, 54, 113, 67, 170}, 13, false, 22};



AstonishingFinish kWalkingValue = (AstonishingFinish){91, (Byte []){53, 58, 54, 62, 245}, 4, false, 130};



AstonishingFinish k_matedLabelTitle = (AstonishingFinish){252, (Byte []){158, 136, 146, 163, 136, 157, 144, 151, 163, 138, 147, 149, 159, 153, 163, 140, 142, 153, 46}, 18, false, 162};



AstonishingFinish k_fromForeignContent = (AstonishingFinish){110, (Byte []){5, 39, 29, 40, 7, 28, 29, 26, 34, 1, 15, 10, 36, 27, 3, 30, 37, 11, 23, 49, 75, 46, 243}, 22, false, 127};



AstonishingFinish k_eticWeekName = (AstonishingFinish){114, (Byte []){16, 6, 28, 0, 51, 34, 59, 5, 75, 45, 22, 0, 29, 16, 11, 23, 25, 45, 25, 30, 19, 6, 45, 28, 29, 0, 8}, 26, false, 116};



AstonishingFinish k_unemploymentOftenTitle = (AstonishingFinish){5, (Byte []){225, 189, 133, 236, 145, 171, 224, 138, 148, 227, 179, 141, 227, 132, 170, 1}, 15, false, 174};



AstonishingFinish k_listWeekValue = (AstonishingFinish){39, (Byte []){4, 101, 101, 98, 101, 98, 30, 65}, 7, false, 198};



AstonishingFinish kBlackData = (AstonishingFinish){130, (Byte []){224, 246, 236, 192, 216, 200, 202, 229, 213, 221, 230, 230, 227, 221, 233, 238, 227, 246, 221, 242, 240, 231, 191}, 22, false, 149};



AstonishingFinish kPlaintQuantityValue = (AstonishingFinish){148, (Byte []){115, 15, 32, 114, 6, 57, 125, 3, 32, 113, 18, 17, 114, 3, 52, 114, 39, 1, 112, 41, 43, 115, 0, 60, 114, 57, 48, 113, 30, 11, 124, 23, 41, 232}, 33, false, 232};



AstonishingFinish k_viewSpineValue = (AstonishingFinish){37, (Byte []){6, 97, 23, 97, 23, 97, 23, 253}, 7, false, 181};



AstonishingFinish k_askViewContent = (AstonishingFinish){67, (Byte []){52, 34, 53, 189}, 3, false, 218};



AstonishingFinish k_sprinkleContent = (AstonishingFinish){38, (Byte []){207, 166, 188, 206, 137, 187, 194, 158, 139, 201, 154, 170, 192, 177, 134, 192, 149, 179, 194, 155, 153, 193, 178, 142, 192, 139, 130, 195, 172, 185, 206, 165, 155, 189}, 33, false, 13};



AstonishingFinish k_attitudeTitle = (AstonishingFinish){71, (Byte []){37, 51, 41, 2, 16, 48, 20, 48, 3, 24, 62, 43, 55, 34, 53, 24, 44, 43, 38, 51, 24, 55, 53, 34, 156}, 24, false, 98};



AstonishingFinish kIndicatorName = (AstonishingFinish){215, (Byte []){181, 163, 185, 145, 146, 161, 165, 177, 152, 136, 179, 179, 182, 136, 188, 187, 182, 163, 136, 185, 184, 165, 210}, 22, false, 144};



AstonishingFinish k_highwayFibData = (AstonishingFinish){214, (Byte []){180, 162, 184, 137, 176, 183, 187, 191, 186, 175, 137, 162, 183, 186, 189, 137, 162, 185, 166, 137, 185, 166, 179, 184, 194}, 24, false, 108};



AstonishingFinish k_bureauData = (AstonishingFinish){223, (Byte []){189, 171, 177, 128, 171, 190, 179, 180, 128, 180, 186, 166, 189, 176, 190, 173, 187, 128, 175, 173, 186, 97}, 21, false, 99};



AstonishingFinish k_mootName = (AstonishingFinish){52, (Byte []){65, 93, 80, 189}, 3, false, 56};



AstonishingFinish kDateEticValue = (AstonishingFinish){227, (Byte []){192, 165, 213, 165, 165, 165, 165, 152}, 7, false, 2};



AstonishingFinish k_removeData = (AstonishingFinish){254, (Byte []){156, 138, 144, 186, 156, 146, 202, 176, 142, 161, 142, 145, 138, 161, 149, 146, 159, 138, 161, 135, 146, 151, 147, 159, 152, 161, 157, 146, 145, 141, 155, 154, 26}, 32, false, 101};



AstonishingFinish kCellName = (AstonishingFinish){1, (Byte []){233, 174, 181, 230, 131, 184, 229, 186, 129, 229, 184, 137, 47, 47, 47, 250}, 15, false, 55};



AstonishingFinish kRakeName = (AstonishingFinish){254, (Byte []){156, 138, 144, 161, 138, 159, 146, 149, 161, 136, 145, 151, 157, 155, 161, 144, 145, 140, 175}, 18, false, 206};



AstonishingFinish kOpenData = (AstonishingFinish){197, (Byte []){167, 177, 171, 243, 188, 172, 176, 163, 177, 154, 160, 166, 164, 163, 154, 174, 169, 164, 177, 154, 171, 170, 183, 44}, 23, false, 179};



AstonishingFinish k_requestRateSuspendContent = (AstonishingFinish){117, (Byte []){145, 205, 245, 147, 232, 212, 147, 195, 253, 147, 244, 218, 147, 233, 245, 144, 209, 239, 144, 250, 223, 157, 246, 200, 53, 68, 69, 145, 205, 223, 145, 207, 207, 243}, 33, false, 13};



AstonishingFinish k_seniorStrokeMagicName = (AstonishingFinish){149, (Byte []){169, 244, 225, 171, 213, 176, 213, 169, 186, 244, 225, 171, 181, 242}, 13, false, 57};



AstonishingFinish kDustTitle = (AstonishingFinish){15, (Byte []){231, 160, 187, 232, 141, 182, 235, 180, 143, 235, 182, 135, 237, 143, 169, 201}, 15, false, 174};



AstonishingFinish kShelfValue = (AstonishingFinish){59, (Byte []){220, 134, 149, 210, 154, 141, 221, 141, 179, 221, 186, 148, 223, 131, 182, 211, 184, 134, 211, 141, 190, 211, 132, 188, 14, 11, 223, 131, 145, 222, 150, 172, 222, 168, 157, 41}, 35, false, 70};












#import "NameTaskView.h"




#import <AVFoundation/AVFoundation.h>


#import "ChartView.h"

#import "RankDisplayView.h"

#import "TaskView.h"


#import "ClickView.h"

#import "PicJsonModel.h"


#import "DeviceView.h"

#import "AttentionTitleAttachment.h"


#import "ManagingDirectorBbbb.h"


#import "ChartTimeIdentity.h"


#import "UIControl+Info.h"



#import "InstanceView.h"


#import "ThemeControl.h"





static NSMutableDictionary *_inputStrDict, *_inputMediaDict;


@interface NameTaskView () <UITextViewDelegate,AVAudioRecorderDelegate>


@property (nonatomic, strong) DeviceView *panoramicView;

@property (nonatomic, strong) RankDisplayView* block;

@property (nonatomic, strong) UIScrollView *infoView;



@property (nonatomic, strong) UIButton *quantity;

@property (nonatomic, strong) UIButton *button;

@property (nonatomic, strong) UIButton *item;


@property (nonatomic, strong) UIButton *state;

@property (nonatomic, strong) UIButton *inputColorButton;

@property (nonatomic, strong) UIButton *model;

@property (nonatomic, strong) UIButton *record;

@property (nonatomic, strong) UIButton *allBbbb;    


@property (nonatomic, assign) CGFloat beam;

@property (nonatomic, assign) LFCSocialChatInputViewState bar;


@property (nonatomic, strong) NSMutableSet *rank;


@property(nonatomic,assign,readwrite) GJInputViewType commonList;

@property (nonatomic, assign) UserIMBizType app;



@property (nonatomic, strong) ChartView *agenda;


@property (nonatomic, strong) TaskView *blockViewBbbb;



@property (nonatomic, strong) InstanceView *nameAt;


@property (nonatomic, strong) ThemeControl *clear;



@property (nonatomic, assign) BOOL barNext;



@property (nonatomic, assign) BOOL info;



@property (nonatomic, copy) NSString *city;



@property (nonatomic, copy) NSAttributedString *systemAttributedText;



@property (nonatomic, strong) UIButton *add;


@property(nonatomic,strong,readwrite) NSDictionary* angelDrop;



@property (nonatomic, strong) ClickView *with;

@property (nonatomic, strong) NSDate *play;

@property (nonatomic, strong) AVAudioRecorder *change;

@property (nonatomic, strong) NSTimer *writtenAccountPub;

@property (nonatomic, assign) NSInteger family;




@end




@implementation NameTaskView {
    
    
    NSString *_toversion;
    
    NSInteger _tointimacy;
}


- (void)dealloc{
    
    
    [_rank removeAllObjects];
    
    _rank = nil;
    
    
    [[NSNotificationCenter defaultCenter] removeObserver:self name:UIKeyboardWillChangeFrameNotification object:nil];
    
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}


- (id)initWithFrame:(CGRect)frame{
    
    
    self = [super initWithFrame:frame];
    
    if (self) {
        
        
        self.backgroundColor = [UIColor whiteColor];
        
        _beam       = CGRectGetHeight(frame);
        
        _bar          = LFCSocialChatInputViewStateSystem;
        
        _everHeadBbbb        = NO;
        
        _directButtonBbbb       = NO;
        
        _coatButtonView        = NO;
        
        _hide      = YES;
        
        _sprechstimme      = YES;
        
        
        UIPanGestureRecognizer *panGesture = [[UIPanGestureRecognizer alloc]
                                              
                                              initWithTarget:self
                                              
                                              action:@selector(brushed:)];
        
        [self addGestureRecognizer:panGesture];
        
        
        [PicJsonModel dataEnable];
        
        
    }
    
    
    return self;
}



- (void)quantityerest:(NSString *)version user:(NSInteger)intimacy {
    
    _toversion = version;
    
    _tointimacy = intimacy;
}


- (void)setTop:(CGFloat)top {
    
    CGRect frame    = self.frame;
    
    frame.origin.y  = top - (screenHeight()-self.superview.height)-46;
    
    self.frame      = frame;
}


- (void)setFrame:(CGRect)frame{
    
    
    CGFloat oldheightToBottom = screenHeight() - CGRectGetMinY(self.frame);
    
    CGFloat newheightToBottom = screenHeight() - CGRectGetMinY(frame);
    
    [super setFrame:frame];
    
    
    if (fabs(oldheightToBottom - newheightToBottom) > 0.1) {

        
        if (oldheightToBottom > newheightToBottom) {
            
            [self mobile];
        }
        
        
        if (_messageDelegateBbbb && [_messageDelegateBbbb respondsToSelector:@selector(underperformer:follow:)]) {
            
            [self.messageDelegateBbbb underperformer:self follow:newheightToBottom];
        }
    }
}


- (void)setBar:(LFCSocialChatInputViewState)inputState{
    
    
    if (_bar != inputState) {
        
        _bar = inputState;
        
        switch (_bar) {
            
            case LFCSocialChatInputViewStateSystem:{
                
                [_name mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
                
                }];
                
                [_nameAt mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
                
                }];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kIndicatorName)] forState:UIControlStateNormal];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kBlackData)] forState:UIControlStateHighlighted];
                
                [self top:UserIMBiz_Social pill:self.commonList == GJInputViewTypeGroupChat];
                
                self.item.selected = NO;
                
                break;
            }
            
            case LFCSocialChatInputViewStateEmotion:{
                
                [_name mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
                
                }];
                
                [_nameAt mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
                
                }];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kIndicatorName)] forState:UIControlStateNormal];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kBlackData)] forState:UIControlStateHighlighted];
                
                self.agenda.max = NO;
                
                self.item.selected = YES;
                
                [self top:UserIMBiz_EmojiAndGif pill:self.commonList == GJInputViewTypeGroupChat];
                
                break;
            }
            
            case LFCSocialChatInputViewStateReply:{
                
                [_name mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
                
                }];
                
                [_nameAt mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
                
                }];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kIndicatorName)] forState:UIControlStateNormal];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kBlackData)] forState:UIControlStateHighlighted];
                
                [self top:UserIMBiz_Social pill:self.commonList == GJInputViewTypeGroupChat];
                
                self.item.selected = NO;
                
                break;
            }
            
            case LFCSocialChatInputViewStateAdd:{
                
                [_name mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
                
                }];
                
                [_nameAt mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
                
                }];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&k_eticWeekName)] forState:UIControlStateNormal];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kForeignEnableData)] forState:UIControlStateHighlighted];
                
                [self top:UserIMBiz_Social pill:self.commonList == GJInputViewTypeGroupChat];
                
                self.item.selected = NO;
                
                break;
            }
            
            case LFCSocialChatInputViewStateGif:{
                
                [_name mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-88);
                
                }];
                
                [_nameAt mas_updateConstraints:^(MASConstraintMaker *make) {
                    
                    make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-88);
                
                }];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kIndicatorName)] forState:UIControlStateNormal];
                
                [self.button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kBlackData)] forState:UIControlStateHighlighted];
                
                self.agenda.max = YES;
                
                self.item.selected = YES;
                
                [self top:UserIMBiz_EmojiAndGif pill:self.commonList == GJInputViewTypeGroupChat];
                
                break;
            }
            
            default:
                
                break;
        }
    }
}


- (void)setImage:(NSString *)placeHolder{
    
    
    if (_time) {
        
        _time.content = placeHolder;
    }
}



- (void)brushed:(UIPanGestureRecognizer *)panGesture {
    
    
    if (panGesture.state == UIGestureRecognizerStateChanged) {
        
        
        CGFloat verticalDiff = [panGesture translationInView:self].y;
        
        if (verticalDiff > 60) {
            
            [self drunk];
        }
    }
}


- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event{
 
    
    if (CGRectContainsPoint(self.agenda.frame, point)) {
        
        
        CGPoint tPoint = [self convertPoint:point toView:self.agenda];
        
        UIView *ret = [self.agenda hitTest:tPoint withEvent:event];
        
        return ret;
    }
    
    
    return [super hitTest:point withEvent:event];
    
}

 
 

#pragma mark remember input

- (NSMutableDictionary *)betweenStart{
    
    if (!_inputStrDict) {
        
        _inputStrDict = [[NSMutableDictionary alloc] init];
    }
    
    return _inputStrDict;
}


- (NSMutableDictionary *)priceBy{
    
    if (!_inputMediaDict) {
        
        _inputMediaDict = [[NSMutableDictionary alloc] init];
    }
    
    return _inputMediaDict;
}


- (NSString *)conversationInfo{
    
    NSString *inputKey = nil;
    
    if (_death) {
        
        inputKey = [NSString stringWithFormat:StringFromAmazingData(&k_amazingContent), _death.stringValue,@""];
    }
    
    return inputKey;
}


- (NSString *)limit{
    
    NSString *inputKey = [self conversationInfo];
    
    if (inputKey) {
        
        return [[self betweenStart] objectForKey:inputKey];
    }
    
    return nil;
}


- (void)scene{
    
    NSString *inputKey = [self conversationInfo];
    
    if (inputKey) {
        
        [[self betweenStart] removeObjectForKey:inputKey];
        
        [[self priceBy] removeObjectForKey:inputKey];
    }
}


- (void)mobile{
    
    NSString *inputStr = _time.text;
    
    NSString *inputKey = [self conversationInfo];
    
    if (inputKey && inputKey.length > 0) {
        
        if (inputStr && inputStr.length > 0) {
            
            [[self betweenStart] setObject:inputStr forKey:inputKey];
        
        }else{
            
            [[self betweenStart] removeObjectForKey:inputKey];
        }
    }
} 


#pragma mark Public M

- (void)targetOff:(UIView*)view{
     
    
    if ([self superview] == view) return;
    
    
    [view addSubview:self];
    
    [view bringSubviewToFront:self];
    
    
    [view addSubview:_panoramicView];
    
    [view bringSubviewToFront:_panoramicView];
    
    
    [view addSubview:_block];
    
    
    [view addSubview:_name];
    
    [_name mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
        
        make.left.mas_equalTo(15);
        
        make.width.mas_equalTo(94);
        
        make.height.mas_equalTo(28);
    
    }];
    
    
    [view addSubview:_nameAt];
    
    [_nameAt mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
        
        make.left.right.mas_equalTo(0);
        
        make.height.mas_equalTo(28);
    
    }];
    
    
    
    [view addSubview:_blockViewBbbb];
    
    [_blockViewBbbb mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.bottom.mas_equalTo(self.mas_top).mas_equalTo(0);
        
        make.width.mas_equalTo(screenWidth());
        
        make.height.mas_equalTo(80);
    
    }];
    
    
    
    [view addSubview:self.clear];
    
    [self.clear mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.bottom.mas_equalTo(self.mas_top).mas_equalTo(-8);
        
        make.right.mas_equalTo(-15);
        
        make.width.height.mas_equalTo(35);
    
    }];
    
    
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             
                                             selector:@selector(momented:)
                                                 
                                                 name:UIKeyboardWillChangeFrameNotification
                                               
                                               object:nil];
    
    
    if (_everHeadBbbb && ![self funcis]) {
        
        [self setTop:screenHeight() - CGRectGetHeight(self.frame) - safeAreaBottomHeight()];
        
    
    }else{
        
        [self setTop:screenHeight()];
    }
}


- (void)start{
    
    [self targetOff:[UIApplication sharedApplication].delegate.window];
}


- (void)largenessBbbb{
    
    
    if ([self superview] == nil) return;
    
    
    [self bbbb];
    
    [self drunk];
    
    [self setTop:screenHeight()];
    
    [_panoramicView removeFromSuperview];
    
    [_block removeFromSuperview];
    
    [_name removeFromSuperview];
    
    [_nameAt removeFromSuperview];
    
    [_blockViewBbbb removeFromSuperview];
    
    [_clear removeFromSuperview];
    
    [self removeFromSuperview];
    
    
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}


- (BOOL)red{
     
    
    self.bar = LFCSocialChatInputViewStateSystem;
    
    
    if ([_time isFirstResponder]) {
        
        return NO;
    
    }else{
        
        dispatch_async(dispatch_get_main_queue(), ^{
            
            [_time becomeFirstResponder];
        
        });
        
        
        if (self.time.text) {
            
            dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.4 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
                
                [self overShow:NO];
            
            });
        }
        
        
        return YES;
    }
    

}
 


- (BOOL)drunk{
    
    
    if (   self.bar == LFCSocialChatInputViewStateAdd
        
        || self.bar == LFCSocialChatInputViewStateEmotion
        
        || self.bar == LFCSocialChatInputViewStateReply) {
        
        
        [_panoramicView setTop:screenHeight()];
        
        [_block setTop:screenHeight()];
        
        self.item.selected = NO;
        
        [self kick];
        
        
        if (self.everHeadBbbb) {
            
            [self setTop:screenHeight()- CGRectGetHeight(self.frame)-safeAreaBottomHeight()];
        
        }else{
            
            [self setTop:screenHeight()];
        }
        
        
        self.bar = LFCSocialChatInputViewStateSystem;
        
        
        if (self.valueContent) {
            
            self.valueContent(self.panoramicView,NO);
        }
        
        
        if (self.address) {
            
            self.address(self.block, NO);
        }
        
        return YES;
        
    }
    
    
    else{
        
        if ([_time isFirstResponder]) {
            
            [_time resignFirstResponder];
            
            return YES;
        
        }else{
            
            return NO;
        }
    }

}



- (BOOL)funcis{
    
    return ([_time isFirstResponder] ||
            
            self.bar == LFCSocialChatInputViewStateAdd ||
            
            self.bar == LFCSocialChatInputViewStateEmotion || self.bar == LFCSocialChatInputViewStateReply);
}


+ (instancetype)bbbb:(id<DragError>)delegate{
    
    
    NameTaskView *messageInputView = [self tab:delegate restore:(GJInputViewTypePrivateChat)];
    
    return messageInputView;
}


+ (instancetype)tab:(id<DragError>)delegate restore:(GJInputViewType)inputType{
   
    
    NameTaskView *messageInputView = [[NameTaskView alloc]
                                               
                                               initWithFrame:CGRectMake(0,
                                                                        
                                                                        screenHeight(),
                                                                        
                                                                        screenWidth(),
                                                                        
                                                                        48 + 46)];
    
    messageInputView.messageDelegateBbbb  = delegate;
    
    messageInputView.commonList = inputType;
    
    if (inputType == GJInputViewTypeGroupChat) {
        
        messageInputView.sprechstimme = NO;
        
        messageInputView.turnNeed = YES;
        
        messageInputView.turnNeed = YES;
    }
    
    [messageInputView entity];
    
    
    NSString *placeHolder = inputType == GJInputViewTypeGroupChat ? @"" : [PlayColorBbbb size].familyDescriptionAddtion.defaultTxt;
    
    if (FZUtils.isEmptyString(placeHolder)) {
        
        placeHolder = NSLocalizedString(StringFromAmazingData(&kCellName), @"");
    }
    
    
    messageInputView.cell = placeHolder;
    
    return messageInputView;
}


- (void)entity{
    
    
    CGFloat contentViewHeight = 48 - 10;
    
    CGFloat contentViewR      = 10;
    
    
    if (self.directButtonBbbb) {
        
        contentViewR += 70;
        
        contentViewR += 10;
    }
    
    
    if (self.hide) {
        
        contentViewR += 26;
        
        contentViewR += 10;
    }
    
    
    CGFloat contentViewL = 10;
    
    if (self.coatButtonView) {
        
        contentViewL += 10 + 26;
    }
    
    
    if (self.sprechstimme) {
        
        contentViewL += 10 + 26;
    }
    
    
    if (self.turnNeed) {
        
        contentViewL += 47 + 10;
    }
    
    
    __weak typeof(self) weakSelf = self;
 
    
    if (!_infoView) {
        
        _infoView = [[UIScrollView alloc] init];
        
        _infoView.backgroundColor        = [UIColor whiteColor];
        
        _infoView.layer.borderWidth      = 1;
        
        _infoView.layer.borderColor      = [UIColor color:StringFromAmazingData(&k_viewSpineValue)].CGColor;
        
        _infoView.layer.cornerRadius     = 5;
        
        _infoView.alwaysBounceVertical   = YES;
        
        [self addSubview:_infoView];
        
        [_infoView mas_makeConstraints:^(MASConstraintMaker *make) {
            
            make.edges.equalTo(self).insets(UIEdgeInsetsMake(10,
                                                             
                                                             contentViewL,
                                                             
                                                             0,
                                                             
                                                             contentViewR));
        
        }];
     }
    
    
    if (!_time) {
        
        CGFloat w = screenWidth() - contentViewL - contentViewR;
        
        _time = [[ColorView alloc] initWithFrame:CGRectMake(0,
                                                                          
                                                                          (contentViewHeight - 36)/2.f,
                                                                          
                                                                          w,
                                                                          
                                                                          contentViewHeight)];
        
        _time.font                 = [UIFont underbelly:PFSCTypeMedium substance:16];
        
        _time.block = RGBA(180, 180, 180, 1);
        
        _time.returnKeyType        = UIReturnKeySend;
        
        _time.scrollsToTop         = NO;
        
        _time.delegate             = self;
        
        _time.textColor            = [ShowColor current];
        
        self.angelDrop = @{NSForegroundColorAttributeName:[ShowColor current],NSFontAttributeName:[UIFont underbelly:PFSCTypeMedium substance:16]};
        
        _time.typingAttributes     = self.angelDrop;

        
        UIEdgeInsets inserts        = _time.contentInset;
        
        inserts.right               = 0;
        
        _time.contentInset = inserts;
        
        _time.backgroundColor = UIColor.clearColor;
        
        [self.infoView addSubview:_time];

        
        if (self.sprechstimme && !_record) {
            
            _record = [[UIButton alloc] init];
            
            [_record.titleLabel setFont:[UIFont underbelly:PFSCTypeMedium substance:16]];
            
            [_record addTarget:self action:@selector(isRecordBbbb:) forControlEvents:UIControlEventTouchDown];
            
            [_record addTarget:self action:@selector(upwardsing:) forControlEvents:UIControlEventTouchUpInside];
            
            [_record addTarget:self action:@selector(outsideMain:) forControlEvents:UIControlEventTouchUpOutside | UIControlEventTouchCancel];
            
            [_record addTarget:self action:@selector(socials:) forControlEvents:UIControlEventTouchDragExit];
            
            [_record addTarget:self action:@selector(accessTime:) forControlEvents:UIControlEventTouchDragEnter];
            
            [_record setTitle:StringFromAmazingData(&k_filmLabelValue) forState:UIControlStateNormal];
            
            [_record setTitleColor:[ShowColor current] forState:UIControlStateNormal];
            
            [_record setBackgroundColor:UIColor.clearColor];
            
            _record.frame = CGRectMake(contentViewL, 0, w, contentViewHeight);
            
            _record.hidden = YES;
        }

    }
    
    
    if (!_add) {
        
        _add = [[UIButton alloc]init];
        
        _add.hidden = YES;
        
        [_add setTitle:StringFromAmazingData(&kNumberactTitle) forState:UIControlStateNormal];
        
        [_add setTitleColor:[ShowColor input] forState:UIControlStateNormal];
        
        [_add addTarget:self action:@selector(scrubSign) forControlEvents:UIControlEventTouchUpInside];
        
        _add.titleLabel.font = [UIFont regularShared:16];
        
        [self addSubview:_add];
        
        [_add mas_makeConstraints:^(MASConstraintMaker *make) {
            
            make.top.mas_equalTo(10);
            
            make.bottom.mas_equalTo(0);
            
            make.right.mas_equalTo(-contentViewR);
            
            make.width.mas_equalTo(50);
            
        
        }];
    }
    
    
    if (!_name) {
        
        _name = [[UIButton alloc]init];
        
        _name.backgroundColor = [UIColor color:StringFromAmazingData(&kDateEticValue)];
        
        [_name setTitle:StringFromAmazingData(&k_unemploymentOftenTitle) forState:UIControlStateNormal];
        
        [_name setTitleColor:ShowColor.send forState:UIControlStateNormal];
        
        _name.titleLabel.font = [UIFont regularShared:14];
        
        [_name addTarget:self action:@selector(referTarget) forControlEvents:UIControlEventTouchUpInside];
        
        _name.layer.cornerRadius = 14;
        
        _name.layer.borderColor = [UIColor color:StringFromAmazingData(&k_listWeekValue)].CGColor;
        
        _name.layer.borderWidth = 1;
        
        _name.layer.masksToBounds = YES;
        
        _name.focus = 1;
        
        
        _name.hidden = ![PlayColorBbbb size].familyDescriptionAddtion.showSendGreet || self.commonList == GJInputViewTypeGroupChat;
    }
    
    
    if (!_blockViewBbbb) {
        
        
        _blockViewBbbb = [[TaskView alloc] init];
        
        
        @weakify(self);
        
        _blockViewBbbb.societal = ^(ThemeJsonModel * _Nonnull model) {
            
            @strongify(self);
            
            
            if ([self.messageDelegateBbbb respondsToSelector:@selector(passePartout:message:)]) {
                
                [self.messageDelegateBbbb passePartout:self message:model];
            }
            
            
            if (self.commonList == GJInputViewTypeGroupChat) {
                
                self.time.attributedText = nil;
                
                self.systemAttributedText = nil;
                
                
                self.time.font = self.angelDrop[NSFontAttributeName];
                
                self.time.textColor = self.angelDrop[NSForegroundColorAttributeName];
                
                [self related];
            
            }else if (self.commonList == GJInputViewTypePrivateChat){
                
                self.time.text = nil;
                
                self.city = nil;
            }
        
        };
    }
    
    
    if (!_agenda) {
        
        _agenda = [[ChartView alloc] initWithFrame:CGRectMake(0, 0, screenWidth(), 46)];
        
        _agenda.backgroundColor = UIColor.whiteColor;
        
        [self addSubview:_agenda];
        
        
        if (_agenda.superview) {
            
            [_agenda mas_makeConstraints:^(MASConstraintMaker *make) {
                
                make.centerX.equalTo(self);
                
                make.top.equalTo(self.mas_bottom);
                
                make.width.mas_equalTo(screenWidth());
                
                make.height.mas_equalTo(46);
            
            }];
            
            
            UIView *view = [[UIView alloc] init];
            
            view.backgroundColor = UIColor.whiteColor;
            
            [self addSubview:view];
            
            
            [view mas_makeConstraints:^(MASConstraintMaker *make) {
                
                make.centerX.equalTo(self);
                
                make.top.equalTo(_agenda.mas_bottom);
                
                make.width.mas_equalTo(screenWidth());
                
                make.height.mas_equalTo(safeAreaBottomHeight());
            
            }];
        }
        
        
        @weakify(self);
        
        _agenda.level = ^{
            
            @strongify(self);
            
            [self list];
        
        };

        
        _agenda.social = ^{
            
            @strongify(self);
            
            [self directionStatus];
        
        };
        
        
        _agenda.start = ^{
            
            @strongify(self);
            
            [self flout];
        
        };
        
        
        _agenda.cardBbbb = ^{
            
            @strongify(self);
            
            [self runLow];
        
        };
        
        
        _agenda.appCell = ^(BOOL selected) {
            
            @strongify(self);
            
            [self centerRangeWealth:selected];
        
        };
        
        
        
        _agenda.to = ^(BOOL selected) {
            
            @strongify(self);

            
            [self titleInBbbb:selected];
            
        
        };
        
        
        
        _agenda.title = ^{
            
            @strongify(self);
            
            if (self.file) {
                
                self.file();
            }
        
        };
        
        
        _agenda.conversation = ^{
            
            @strongify(self);
            
            if (self.component) {
                
                self.component();
            }
        
        };
        
        _agenda.modelDisplay = ^{
            
            @strongify(self);
            
            [self modelGroup:nil];
        
        };
        
        _agenda.infoBeanBbbb = ^(NSString * _Nonnull type) {
            
            @strongify(self);
            
            if (self.price) {
                
                self.price(type);
            }
        
        };
        
        _agenda.along = ^(UIButton * _Nonnull sender) {
            
            @strongify(self);
            
            [self mies:sender];
        
        };
     }
    
    
    if (self.coatButtonView && !_button) {
        
        
        _button = [[UIButton alloc] init];
        
        _button.imageEdgeInsets = UIEdgeInsetsMake(5, 5, 5, 5);
        
        
        [_button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kIndicatorName)]
                    
                    forState:UIControlStateNormal];
        
        [_button setImage:[UserTextImage imageNamed:StringFromAmazingData(&kBlackData)]
                    
                    forState:UIControlStateHighlighted];
        
        
        [_button addTarget:self
                       
                       action:@selector(echogramBbbb:)
             
             forControlEvents:UIControlEventTouchUpInside];
        
        
        [self addSubview:_button];
        
        
        CGFloat leftOffset = 10 - 5;
        
        
        [_button mas_makeConstraints:^(MASConstraintMaker *make) {
            
            make.left.equalTo(self).offset(leftOffset);
            
            make.centerY.equalTo(self).offset(0.5 * 10);
            
            make.width.mas_equalTo(26+10);
            
            make.height.mas_equalTo(26+10);
        
        }];
    }
    
    
    if (self.turnNeed && !_state) {
        
        _state = [[UIButton alloc] init];
        
        [_state setImage:[UserTextImage imageNamed:StringFromAmazingData(&k_removeData)]
                    
                    forState:UIControlStateNormal];
        
        [_state setImage:[UserTextImage imageNamed:StringFromAmazingData(&k_highwayFibData)]
                    
                    forState:UIControlStateSelected];
        
        
        [_state addTarget:self
                       
                       action:@selector(smartTip:)
             
             forControlEvents:UIControlEventTouchUpInside];
        
        
        [self addSubview:_state];
        
        
        CGFloat leftOffset = 10;
        
        [_state mas_makeConstraints:^(MASConstraintMaker *make) {
            
            make.left.equalTo(self).offset(leftOffset);
            
            make.centerY.equalTo(self).offset(0.5 * 10);
            
            make.width.mas_equalTo(47);
            
            make.height.mas_equalTo(26);
        
        }];
    }
    
    
    
    if (self.sprechstimme) {
        
        if (!_model) {
            
            _model = [[UIButton alloc] init];
            
            [_model setImage:[UserTextImage imageNamed:StringFromAmazingData(&kRakeName)] forState:UIControlStateNormal];
            
            [_model setImage:[UserTextImage imageNamed:StringFromAmazingData(&k_matedLabelTitle)] forState:UIControlStateHighlighted];
            
            [_model addTarget:self action:@selector(quantityoed:) forControlEvents:UIControlEventTouchUpInside];
            
            [self addSubview:_model];
        }
        
        
        if (!_inputColorButton) {
            
            _inputColorButton = [[UIButton alloc] init];
            
            [_inputColorButton setImage:[UserTextImage imageNamed:StringFromAmazingData(&kAmazingBackName)] forState:UIControlStateNormal];
            
            [_inputColorButton setImage:[UserTextImage imageNamed:StringFromAmazingData(&k_bureauData)] forState:UIControlStateHighlighted];
            
            [_inputColorButton addTarget:self action:@selector(sizeTo:) forControlEvents:UIControlEventTouchUpInside];
            
            [self addSubview:_inputColorButton];
            
            _inputColorButton.hidden = YES;
        }
        
        
        CGFloat leftOffset = 10 - 5;
        
        leftOffset = self.coatButtonView ? (10+26+10-5) : leftOffset;
        
        [_model mas_makeConstraints:^(MASConstraintMaker *make) {
            
            make.left.equalTo(self).offset(leftOffset);
            
            make.centerY.equalTo(self).offset(0.5 * 10);
            
            make.width.mas_equalTo(26+10);
            
            make.height.mas_equalTo(26+10);
        
        }];
        
        
        [_inputColorButton mas_makeConstraints:^(MASConstraintMaker *make) {
            
            make.left.equalTo(self).offset(leftOffset);
            
            make.centerY.equalTo(self).offset(0.5 * 10);
            
            make.width.mas_equalTo(26+10);
            
            make.height.mas_equalTo(26+10);
        
        }];
    }
    
    
    
    if (self.commonList == GJInputViewTypePrivateChat) {
        
        if (!_allBbbb) {
            
            _allBbbb = [[UIButton alloc] init];
            
            _allBbbb.imageEdgeInsets = UIEdgeInsetsMake(5, 5, 5, 5);
            
            [_allBbbb setImage:[UserTextImage imageNamed:StringFromAmazingData(&kEticData)]
                        
                        forState:UIControlStateNormal];
            
            [_allBbbb setImage:[UserTextImage imageNamed:StringFromAmazingData(&k_attitudeTitle)]
                        
                        forState:UIControlStateHighlighted];
            
            [_allBbbb addTarget:self
                           
                           action:@selector(modelGroup:)
                 
                 forControlEvents:UIControlEventTouchUpInside];

            
            [self addSubview:_allBbbb];
            
            
            [_allBbbb mas_makeConstraints:^(MASConstraintMaker *make) {
                
                make.right.equalTo(self).offset(-5);
                
                make.centerY.equalTo(self).offset(0.5 * 10);
                
                make.width.mas_equalTo(26+10);
                
                make.height.mas_equalTo(26+10);
            
            }];
        }
    
    }else{
        
        if (self.hide && !_item) {
            
            _item = [[UIButton alloc] init];
            
            _item.imageEdgeInsets = UIEdgeInsetsMake(5, 5, 5, 5);
            
            
            [_item setImage:[UserTextImage imageNamed:StringFromAmazingData(&kOpenData)]
                        
                        forState:UIControlStateNormal];
            
            [_item setImage:[UserTextImage imageNamed:StringFromAmazingData(&kAmazingBackName)]
                        
                        forState:UIControlStateSelected];
            
    
            
            
            [_item addTarget:self
                           
                           action:@selector(mies:)
                 
                 forControlEvents:UIControlEventTouchUpInside];
            
            
            [self addSubview:_item];
                
            
            [_item mas_makeConstraints:^(MASConstraintMaker *make) {
                
                make.right.equalTo(self).offset(-5);
                
                make.centerY.equalTo(self).offset(0.5 * 10);
                
                make.width.mas_equalTo(26+10);
                
                make.height.mas_equalTo(26+10);
            
            }];
        }
    }
    

    
    
    if (!_panoramicView) {
        
        
        _panoramicView = [[DeviceView alloc] initWithFrame:CGRectMake(0, 0, screenWidth(), 216 + safeAreaBottomHeight())];
        
        
        @weakify(self);
        
        _panoramicView.viewImage = ^{
            
            @strongify(self);
            
            [self picSex];
        
        };
        
        _panoramicView.dot = ^(NSString * _Nonnull emojiStr) {
            
            @strongify(self);
            
            [self.rank addObject:emojiStr];
            
            if (self.commonList == GJInputViewTypeGroupChat) {
                
                BOOL canInsert = [self textView:self.time shouldChangeTextInRange:self.time.selectedRange replacementText:emojiStr];
                
                if (canInsert) {
        //            NSMutableAttributedString* str = [[NSMutableAttributedString alloc] initWithAttributedString:self.inputTextView.attributedText];
        
        
        
        
                    
                    [self.time insertText:emojiStr];
                }
            
            }else{
                
                [self.time insertText:emojiStr];
            }
        
        };
        
        _panoramicView.briquette = ^{
            
            @strongify(self);
            
            [self.time deleteBackward];
        
        };
        
        [_panoramicView setTop:screenHeight()];
    }
    
    
    if (!_block) {
        
        _block = [[RankDisplayView alloc] initWithFrame:CGRectMake(0, 0, screenWidth(), 308)];
        
        
        @weakify(self);
        
        [_block setNeed:^{
           
           @strongify(self);
            
            [self clickBbbb];
        
        }];
        
        
        [_block setDot:^(NSString * _Nonnull reply) {
            
            @strongify(self);
            
            [self guide:reply];
        
        }];
        
        
        [_block setTop:screenHeight()];
    }
    
    
    if (_time) {
        
        [RACObserve(self.time, contentSize) subscribeNext:^(NSValue *contentSize) {
            
            [weakSelf overShow:NO];
        
        }];
    }
    
    
    if (self.directButtonBbbb && !_path) {
        
        
        _path = [[UIButton alloc] init];
        
        [_path setTitle:NSLocalizedString(StringFromAmazingData(&k_rareName), @"")
                     
                     forState:UIControlStateNormal];
        
        
        _path.titleLabel.font     = [UIFont regularShared:17];
        
        _path.backgroundColor     = [ShowColor send];
        
        _path.layer.cornerRadius  = 5;
        
        _path.clipsToBounds       = YES;
        
        [_path setTitleColor:UIColor.whiteColor forState:UIControlStateNormal];
        
        [_path setTitleColor:UIColor.whiteColor forState:UIControlStateHighlighted];
        
        [_path addTarget:self
                        
                        action:@selector(picSex)
              
              forControlEvents:UIControlEventTouchUpInside];
        
        [self addSubview:_path];
        
        
        [_path mas_makeConstraints:^(MASConstraintMaker *make) {
            
            make.right.equalTo(self).offset(0-10);
            
            make.centerY.equalTo(self).offset(0.5 * 10);
            
            make.width.mas_equalTo(70);
            
            make.height.mas_equalTo(38);
        
        }];
    }
    
    
    [self textViewDidChange:_time];
}



- (void)setPushFemale:(UIViewController *)currentVC{
    
    _pushFemale = currentVC;
    
    [_pushFemale.view addSubview:_record];
    
    [RACObserve(_pushFemale.view,frame) subscribeNext:^(NSValue *contentSize) {
        
        CGFloat superHeight = CGRectGetHeight(contentSize.CGRectValue);
        
        CGFloat inputHeight =  48 + 46 + safeAreaBottomHeight();
        
        CGRect rect = self.record.frame;
        
        rect.origin.y = superHeight - inputHeight + 10;
        
        self.record.frame = rect;
    
    }];
}


- (void)overShow:(BOOL)becauseOfMedia{
    
    
    CGSize textSize  = _time.contentSize;
    
    CGSize mediaSize = CGSizeZero;
    
    
    if (!becauseOfMedia) {
        
        if (ABS(CGRectGetHeight(_time.frame) - textSize.height) > 0) {
            
            [_time setHeight:textSize.height];
        }
    }
    
    
    CGSize contentSize = CGSizeMake(textSize.width, textSize.height + mediaSize.height);
    
    CGFloat selfHeight = MAX(48,
                             
                             contentSize.height + 10);
    
    
    CGFloat maxSelfHeight = 140;
    
    selfHeight = MIN(maxSelfHeight, selfHeight);
    
    CGFloat diffHeight = selfHeight - _beam;
    
    
    if (ABS(diffHeight) > 0.5) {
        
        
        CGRect selfFrame = self.frame;
        
        
        selfFrame.size.height += diffHeight;
        
        selfFrame.origin.y -= diffHeight;
        
        [self setFrame:selfFrame];
        
        
        self.beam = selfHeight;
    }
    
    
    CGFloat bottomY = becauseOfMedia ? contentSize.height : textSize.height;
    
    CGFloat offsetY = MAX(0, bottomY - (CGRectGetHeight(self.frame) - 10));
    
    
    [self.infoView setContentOffset:CGPointMake(0, offsetY)];
    
    [self.infoView setContentSize:contentSize];
    
}


- (void)filter{
    
    
    if (!_nameAt && [self agree]) {
        
        
        _nameAt = [[InstanceView alloc]init];
        
        @weakify(self);
        
        _nameAt.resume = ^(NSString * _Nonnull text) {
            
            @strongify(self);
            
            if (self.collection) {
                
                self.collection(text);
            }
        
        };
        
    }
    
}


- (BOOL)agree{
    
    
    NSString *key = [NSString stringWithFormat:@"%@_%@_%ld",[AuthorShadow attention],self.mode,[PlayColorBbbb size].file.id];
    
    
    BOOL isFirst = [[NSUserDefaults standardUserDefaults] boolForKey:key];
    
    
    NSArray *texts = [PlayColorBbbb size].familyDescriptionAddtion.quickReplyText;
    
    
    BOOL show = !isFirst && texts.count > 0 && [PlayColorBbbb size].file.sex == Gender_Male;
    
    
    
    return show;
}



- (void)appSize{
    
    if (self.nameAt) {
        
        [self.nameAt removeFromSuperview];
        
        self.nameAt = nil;
    }
}


#pragma mark - Action


- (void)bbbb {
    
    _model.hidden = NO;
    
    _inputColorButton.hidden = YES;
    
    _record.hidden = YES;
    
    _time.hidden = NO;
}



- (void)mies:(UIButton *)sender{
    
    
    if ([WritingGrantBbbb shirtButtonNotice]) return;
    
    
    sender.selected = !sender.selected;
    
    [self bbbb];
    
    
    [self kick];
    
    
    CGFloat endY = screenHeight();
    
    
    if (sender.selected) {
        
        [_time resignFirstResponder];
        
        self.bar = LFCSocialChatInputViewStateEmotion;
        
        [self.panoramicView.superview bringSubviewToFront:self.panoramicView];
        
        
        endY = screenHeight() - 216-safeAreaBottomHeight();
        
        if (self.valueContent) {
            
            self.valueContent(self.panoramicView,YES);
        }
    
    }else{
        
        self.bar = LFCSocialChatInputViewStateSystem;
        
        dispatch_async(dispatch_get_main_queue(), ^{
            
            [_time becomeFirstResponder];
        
        });
    }
    
//    if (self.inputState == LFCSocialChatInputViewStateEmotion) {
//        self.inputState = LFCSocialChatInputViewStateSystem;











    
    
    [UIView animateWithDuration:0.25 delay:0.0f options:0 animations:^{
        
        [_panoramicView setTop:endY];
        
        if (ABS(screenHeight() - endY) > 0.1) {
            
            [self setTop:endY- CGRectGetHeight(self.frame)];
            
            
            [self lightKey];
        }
    
    } completion:^(BOOL finished) {
    
    }];
}



- (void)echogramBbbb:(id)sender{
   
    
    [AppBbbb userBbbb:[ClickUser cut]];
   
    
    if ([WritingGrantBbbb shirtButtonNotice]) {
        
        return;
    }
    
    
    CGFloat endY = screenHeight();
    
    if (self.bar == LFCSocialChatInputViewStateAdd) {
        
        self.bar = LFCSocialChatInputViewStateSystem;
        
        dispatch_async(dispatch_get_main_queue(), ^{
            
            [_time becomeFirstResponder];
        
        });
        
    
    }else{
        
        self.bar = LFCSocialChatInputViewStateAdd;
        
        [_time resignFirstResponder];
        
        [self.panoramicView setTop:endY];
        
        endY = screenHeight() - 258;
    }
    
    
    [UIView animateWithDuration:0.25 delay:0.0f options:0 animations:^{
        
        if (ABS(screenHeight() - endY) > 0.1) {
            
            [self setTop:endY- CGRectGetHeight(self.frame)];
        }
    
    } completion:^(BOOL finished) {
    
    }];
    
}



- (void)quantityoed:(UIButton *)sender {
    
    
    [self aaaa:StringFromAmazingData(&kBiologicValue) customBbbb:YES pair:^{
        
        CGFloat offset = [_time isFirstResponder] ? -80 : 80;

        
        if (_tointimacy < 60 && [PlayColorBbbb size].file.sex == Gender_Male) {
            
            [self push:StringFromAmazingData(&k_residencyName)];
            
            return;
        }
        
        if ([PlayColorBbbb size].file.sex == Gender_Female )
        {
            
            if ([PlayColorBbbb size].familyDescriptionAddtion.doorType == 1 && ![[PlayColorBbbb size].file.isTPAuth isEqualToString:@"2"]) {
                
                [[ByPush instance] masterKey];
                
                return;
            }
        }
        
        if ([ManagingDirectorBbbb sleepingDraught].admin) {
            
            [self push:StringFromAmazingData(&k_sprinkleContent)];
            
            return;
        }
        
        if (self.commonList == GJInputViewTypeGroupChat) {
            
            [self push:StringFromAmazingData(&kPlaintQuantityValue)];
            
            return;
        }
        
        [_pushFemale.view bringSubviewToFront:_record];
        
        _record.hidden = NO;
        
        _time.hidden = YES;
        
        _model.hidden = YES;
        
        _inputColorButton.hidden = NO;
        
        [self drunk];
    
    }];
}



- (void)sizeTo:(UIButton *)sender {
    
    [self bbbb];
    
    dispatch_async(dispatch_get_main_queue(), ^{
        
        [_time becomeFirstResponder];
    
    });
}


- (void)referTarget{
    
    if (self.modelBbbb) {
        
        self.modelBbbb();
    }
}


#pragma mark - 录音


- (void)isRecordBbbb:(UIButton *)sender {
    
    
    [[ChartTimeIdentity textHandle] sizeBy];
        
    
    if ([ManagingDirectorBbbb sleepingDraught].admin) {
        
        [self push:StringFromAmazingData(&k_sprinkleContent)];

        
        return;
    }
    
    
    if (!_with) {
        
        _with = [[ClickView alloc] init];
        
        _with.frame = [UIScreen mainScreen].bounds;
    }
    
    [self.window addSubview:_with];
    
    [_with square];
        
    
    _play = [NSDate date];
    
    [_with setPriceBbbb:RecordStatus_recording];

    
    [self doError];
    
    
    
    if (self.messageDelegateBbbb && [self.messageDelegateBbbb respondsToSelector:@selector(message:pathEditing:)]) {
        
        [self.messageDelegateBbbb message:self pathEditing:self.time];
    }
}



- (void)upwardsing:(UIButton *)sender {
    
    if (AVAudioSession.sharedInstance.recordPermission == AVAudioSessionRecordPermissionDenied) {
        
        return;
    }

    
    NSTimeInterval interval = [[NSDate date] timeIntervalSinceDate:_play];
    
    if(interval < 1 || interval > 30) {
        
        if(interval < 1) {
            
            [_with setPriceBbbb:RecordStatus_tooShoot];
        
        }else {
            
            [_with setPriceBbbb:RecordStatus_tooLong];
        }
        
        
        [self keyRecord:interval > 30];
        
        [_with substance];
    
    }else {
        
        [_with substance];
        
        NSString *path = [self isWeek];
        
        if(path && _messageDelegateBbbb && [_messageDelegateBbbb respondsToSelector:@selector(mount:sharedStart:target:)]){
            
            [_messageDelegateBbbb mount:self sharedStart:path target:interval];
        }
    }
}


- (void)outsideMain:(UIButton *)sender {
    
    [_with substance];
    
    [self keyRecord:NO];
}


- (void)socials:(UIButton *)sender {
    
    [_with setPriceBbbb:RecordStatus_cancel];
}


- (void)accessTime:(UIButton *)sender {
    
    [_with setPriceBbbb:RecordStatus_recording];
}


- (void)doError {
    
    AVAudioSession *session = [AVAudioSession sharedInstance];
    
    NSError *error = nil;
    
    [session setCategory:AVAudioSessionCategoryPlayAndRecord error:&error];
    
    [session setActive:YES error:&error];

    
    
    NSDictionary *recordSetting = @{
                                    
                                    AVFormatIDKey:@(kAudioFormatLinearPCM),
                                    
                                    
                                    AVSampleRateKey:@(8000.00f),
                                    
                                    
                                    AVNumberOfChannelsKey:@(1),
                                    
                                    
                                    AVLinearPCMBitDepthKey:@(16),
                                    
                                    
                                    AVEncoderAudioQualityKey:@(AVAudioQualityHigh)
                                    
                                    };
    
    NSString *path = [PicJsonModel showBbbb:StringFromAmazingData(&k_askViewContent)];
    
    NSURL *url = [NSURL fileURLWithPath:path];
    
    _change = [[AVAudioRecorder alloc] initWithURL:url settings:recordSetting error:nil];
    
    _change.meteringEnabled = YES;
    
    [_change prepareToRecord];
    
    [_change record];
    
    [_change updateMeters];
    
    _family = 0;

    
    _writtenAccountPub = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(tickSend:) userInfo:nil repeats:YES];
}


- (void)tickSend:(NSTimer *)timer {
    
    [_change updateMeters];
    
    
    NSTimeInterval interval = _change.currentTime;
    
    
    _family += 1;
    
    
    _with.showView.text = [NSString stringWithFormat:@"%ld″",_family];
    
    
    
    
    if(interval >= 30){
        
        NSString *path = [self isWeek];
        
        [_with setPriceBbbb:RecordStatus_tooLong];
        
        __weak typeof(self) ws = self;
        
        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
            
            [ws.with substance];
        
        });
        
        if (path) {
            
            if(_messageDelegateBbbb && [_messageDelegateBbbb respondsToSelector:@selector(mount:sharedStart:target:)]){
                
                [_messageDelegateBbbb mount:self sharedStart:path target:30.f];
            }
        }
    }
}


- (NSString *)isWeek {
    
    if(_writtenAccountPub){
        
        [_writtenAccountPub invalidate];
        
        _writtenAccountPub = nil;
    }
    
    if([_change isRecording]){
        
        [_change stop];
    }
    
    return _change.url.path;
}


- (void)keyRecord:(BOOL)isTooLong {
    
    if(_writtenAccountPub){
        
        [_writtenAccountPub invalidate];
        
        _writtenAccountPub = nil;
    }
    
    if([_change isRecording]){
        
        [_change stop];
    }
    
    if (isTooLong) {
        
        
        return;
    }
    
    
    NSString *path = _change.url.path;
    
    if([[NSFileManager defaultManager] fileExistsAtPath:path]){
        
        [[NSFileManager defaultManager] removeItemAtPath:path error:nil];
    }
}


- (void)clickPush{
    
    if (self.accountStage) {
        
        self.accountStage();
    }
}


#pragma mark ------分割



- (void)modelGroup:(id)sender{
    
    if ([WritingGrantBbbb shirtButtonNotice]) return;

    
    CGFloat endY = screenHeight();
    
    if (self.bar == LFCSocialChatInputViewStateReply) {
        
        self.bar = LFCSocialChatInputViewStateSystem;
        
        [_time becomeFirstResponder];
    
    }else{
        
        [self kick];
        
        [self.block.superview bringSubviewToFront:self.block];
        
        [_time resignFirstResponder];
        
        [self.panoramicView setTop:endY];
        
        [self.block communication];
        
        self.bar = LFCSocialChatInputViewStateReply;
        
        endY = screenHeight() - 308;
        
        if (self.address) {
            
            self.address(self.block,YES);
        }
    }
    
    [UIView animateWithDuration:0.25 delay:0.0f options:0 animations:^{

        
        [_block setTop:endY - (self.accountTogetherBbbb?30:0)];

        
        CGFloat inputHeight =  48+46+safeAreaBottomHeight();

        
        
        if (ABS(screenHeight() - endY) > 0.1 &&
            
            ABS(screenHeight() - self.frame.origin.y) + 0.1 > inputHeight) {
            
            [self setTop:endY- CGRectGetHeight(self.frame) + inputHeight];
            
            [self lightKey];
        }
    
    } completion:^(BOOL finished) {
    
    }];
}



- (void)smartTip:(id)sender{
    
    self.state.selected = !self.state.selected;
    
    [self opticalLight];
}



- (void)setSuccessful:(BOOL)canEdit {
    
    
    if (canEdit) {
        
        _time.cheatDismiss = NO;
        
    
    } else {
        
        [_time resignFirstResponder];
        
        _time.cheatDismiss = YES;
    }
}


- (BOOL)feed{
    
    return self.state.selected;
}



- (void)runLow{
    
    
    if ([WritingGrantBbbb shirtButtonNotice]) return;
    
    
    [self bbbb];
    
    
    if (self.picPicture) {
        
        self.picPicture();
    }
}


- (void)edge{
    
    
    if ([WritingGrantBbbb shirtButtonNotice]) return;
    
    
    if (self.guess) {
        
        self.guess();
    }
}


- (void)list{
    
    
    if ([WritingGrantBbbb shirtButtonNotice]) return;
    
    
    if (self.view) {
        
        self.view();
    }
}


- (void)directionStatus{
    
    
    if ([WritingGrantBbbb shirtButtonNotice]) return;
    
    if (self.modelApp) {
        
        self.modelApp();
    }
}


- (void)flout{
    
    if ([WritingGrantBbbb shirtButtonNotice]) return;
    




    
    
    
    [self bbbb];
    
    
    if (self.action) {
        
        self.action();
    }
}



- (void)centerRangeWealth:(BOOL)select{
    
    
    
    [self.time becomeFirstResponder];
    
    
    [self bbbb];
    
    
    self.info = select;
    
    
    self.add.hidden = !select;
    
    
    if (select) {
        
        if (self.commonList == GJInputViewTypeGroupChat) {
            
            self.systemAttributedText = self.time.attributedText;
            
            self.time.attributedText = nil;
            
            
            self.time.font = self.angelDrop[NSFontAttributeName];
            
            self.time.textColor = self.angelDrop[NSForegroundColorAttributeName];
            
            [self related];
        
        }else{
            
            self.city = self.time.text;
            
            self.time.text = @"";
        }
        
        [self opticalLight];
        
        self.bar = LFCSocialChatInputViewStateGif;
    
    }else{
        
        if (self.commonList == GJInputViewTypeGroupChat) {
            
            self.time.attributedText = self.systemAttributedText;
            
            [self related];
        
        }else{
            
            self.time.text = self.city;
        }
        
        [self opticalLight];
        
        self.bar = LFCSocialChatInputViewStateSystem;
    }
    
    
    [self imageWith];
}


- (void)scrubSign{
    
    
    self.agenda.max = NO;
    
    [self centerRangeWealth:NO];
}




- (void)titleInBbbb:(BOOL)selected{
    
    
    [self bbbb];
    
    
    [_time resignFirstResponder];
    
    
    CGFloat endY = screenHeight() - CGRectGetHeight(self.frame) - safeAreaBottomHeight() + 46;
    
    
    CGFloat toolViewH = 46;
    
    
    if (selected) {
        
        
        endY = endY - 114;
        
        
        toolViewH = toolViewH + 114;
        
        
        self.bar = LFCSocialChatInputViewStateAdd;
        
        
        [_panoramicView setTop:screenHeight()];
        
    
    }else{
        
        self.bar = LFCSocialChatInputViewStateSystem;
    }
    
    
    [self.agenda mas_updateConstraints:^(MASConstraintMaker *make) {
        
        make.height.mas_equalTo(toolViewH);
    
    }];
    
    
    [UIView animateWithDuration:0.25 delay:0.0f options:0 animations:^{
        
        if (ABS(screenHeight() - endY) > 0.1) {
            
            [self setTop:endY- CGRectGetHeight(self.frame)];
        }
    
    } completion:^(BOOL finished) {
    
    }];
    
}


- (void)title:(NSDictionary*)info{
    
    if ([self pastLength] >= 10) {
        
        return;
    }
    
    NSRange atRange;
    
    NSValue* rangeValue = info[StringFromAmazingData(&kPunchTitle)];
    
    if (rangeValue != nil) {
        
        atRange = [info[StringFromAmazingData(&kPunchTitle)] rangeValue];

        
        if (atRange.length + atRange.location > self.time.text.length) {
            
            atRange.location -= 1;
        }
    
    }else{
        
        atRange = NSMakeRange(self.time.attributedText.length, 0);
    }
    
    
    NSString* atStr = [NSString stringWithFormat:@"@%@",info[StringFromAmazingData(&kWalkingValue)]];
    
    
    UILabel* label = [[UILabel alloc] init];
    
    label.textColor = RGBA(0, 132, 255, 1.0f);
    
    label.font = [UIFont systemFontOfSize:16];
    
    label.text = atStr;
    
    label.textAlignment = NSTextAlignmentCenter;
    
    [label sizeToFit];
    
    
    UIGraphicsBeginImageContextWithOptions(label.bounds.size, NO, 0);
    
    
    [label.layer renderInContext:UIGraphicsGetCurrentContext()];
    
    
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
    
    UIGraphicsEndImageContext();
    
        
    
    AttentionTitleAttachment* textAtta = [[AttentionTitleAttachment alloc] init];
    
    textAtta.bounds = CGRectMake(0, label.font.descender, image.size.width, image.size.height);
    
    textAtta.image = image;
    
    if (info) {
        
        NSMutableDictionary* dict = [NSMutableDictionary dictionaryWithDictionary:info];
        
        [dict setObject:@(atStr.length) forKey:StringFromAmazingData(&k_currentWeekCountData)];
        
        textAtta.view = dict.copy;
    }
    
    NSAttributedString* attaImage = [NSAttributedString attributedStringWithAttachment:textAtta];
    
    
    NSMutableAttributedString* attrText = [[NSMutableAttributedString alloc] initWithAttributedString:self.time.attributedText];
    
    
    [attrText replaceCharactersInRange:atRange withAttributedString:attaImage];
    
    self.time.attributedText = attrText.copy;
    
    
    self.systemAttributedText = self.time.attributedText;
    
    
    [self related];
}


- (void)related{
    
    if ([self.time respondsToSelector:@selector(refreshPlaceholderView)]) {
        
        [self.time performSelector:@selector(refreshPlaceholderView)];
    }
}


- (BOOL)withPage{
    
    NSInteger limit = 50;
    
    NSAttributedString* attrText = [self.time.attributedText mutableCopy];
    
    if (attrText.length && [attrText containsAttachmentsInRange:NSMakeRange(attrText.length - 1, 1)]) {
        
        limit += 10;
    }

    
    NSInteger length = [self victorious];
    
    
    BOOL ret = length > limit;
    
    return ret;
}


- (NSInteger)victorious{
    
    NSAttributedString* attrText = [self.time.attributedText mutableCopy];
    
    __block NSInteger length = attrText.length;
    
    [attrText enumerateAttributesInRange:NSMakeRange(0, length) options:(0) usingBlock:^(NSDictionary<NSAttributedStringKey,id> * _Nonnull attrs, NSRange range, BOOL * _Nonnull stop) {
        
        if ([attrs.allKeys containsObject:NSAttachmentAttributeName]) {
            
            AttentionTitleAttachment* atta = [attrs objectForKey:NSAttachmentAttributeName];
            
            NSDictionary* info = atta.view;
            
            length += [info[StringFromAmazingData(&k_currentWeekCountData)] integerValue] - 1;
        }
    
    }];
    
    return length;
}


- (NSInteger)pastLength{
    
    NSAttributedString* attrText = [self.time.attributedText mutableCopy];
    
    NSInteger length = attrText.length;
    
    __block NSInteger count = 0;
    
    [attrText enumerateAttributesInRange:NSMakeRange(0, length) options:(0) usingBlock:^(NSDictionary<NSAttributedStringKey,id> * _Nonnull attrs, NSRange range, BOOL * _Nonnull stop) {
        
        if ([attrs.allKeys containsObject:NSAttachmentAttributeName]) {
            
            count += 1;
        }
    
    }];
    
    if (count >= 10) {
        
        [self push:StringFromAmazingData(&k_requestRateSuspendContent)];
    }
    
    return count;
}


- (void)setCoatButtonView:(BOOL)hasAddButton{
    
    
    _coatButtonView           = hasAddButton;
    
    self.button.hidden   =! hasAddButton;
    
    
    CGFloat contentViewHeight   = 48 - 10;
    
    CGFloat contentViewR        = 10;
    
    
    if (self.directButtonBbbb) {
        
        contentViewR += 70;
        
        contentViewR += 10;
    }
    
    
    CGFloat contentViewL = 10 + 26 + 10;
    
    
    if (hasAddButton) {
        
        contentViewL += 26 + 10;
    }
    
    
    [self.infoView mas_updateConstraints:^(MASConstraintMaker *make) {
        
        make.edges.equalTo(self).insets(UIEdgeInsetsMake(10, contentViewL, 0, contentViewR));
    
    }];
    
    
    CGFloat w = screenWidth() - contentViewL - contentViewR;
    
    self.time.frame = CGRectMake(0, 0, w, contentViewHeight);
}


- (void)setDirectButtonBbbb:(BOOL)hasSendButton{
    
    _directButtonBbbb=hasSendButton;
    
    self.path.hidden=!hasSendButton;
}


- (NSMutableString*)fromText:(NSAttributedString*)text{
    
    
    NSMutableAttributedString *mText;
    
    if (!text) {
        
        mText = [[NSMutableAttributedString alloc] initWithString:@""];
    
    }else {
        
        mText = [[NSMutableAttributedString alloc] initWithAttributedString:text];
    }
    
    
    NSMutableString *mutableString = [NSMutableString string];
    
    if (self.commonList == GJInputViewTypeGroupChat) {
        
        
        [self.filtrate removeAllObjects];
        
        
        [mText enumerateAttributesInRange:NSMakeRange(0, mText.length) options:0 usingBlock:^(NSDictionary<NSAttributedStringKey,id> * _Nonnull attrs, NSRange range, BOOL * _Nonnull stop) {
            //: NSLog(@"attrs = %@,range = %@",attrs,NSStringFromRange(range));
            
            
            AttentionTitleAttachment* atta = [attrs objectForKey:NSAttachmentAttributeName];
            
            if (atta && range.length == 1) {
                
                NSString* str = [NSString stringWithFormat:StringFromAmazingData(&k_seniorStrokeMagicName),atta.view[StringFromAmazingData(&kWalkingValue)]];
                
                [mutableString appendString:str];
                
                [self.filtrate addObject:atta.view[StringFromAmazingData(&k_mootName)]];
            
            }else{
                
                NSString* str = [mText attributedSubstringFromRange:range].string;
                
                [mutableString appendString:str];
            }
        
        }];
    
    }else{
        
        mutableString = [NSMutableString stringWithString:mText.string];
    }
    
    
    
    NSMutableDictionary *usedEmojiDict = [NSMutableDictionary new];
    
    NSDictionary *reversalEmojiDic = [PlayColorBbbb size].timeMove;
    
    
    [self.rank enumerateObjectsUsingBlock:^(NSString*  _Nonnull emojiStr, BOOL * _Nonnull stop) {
        
        if ([reversalEmojiDic.allKeys containsObject:emojiStr]) {
            
            [usedEmojiDict setObject:reversalEmojiDic[emojiStr] forKey:emojiStr];
        }
    
    }];
    
    
    [usedEmojiDict enumerateKeysAndObjectsUsingBlock:^(NSString* emojiStr, NSString* obj, BOOL * _Nonnull stop) {
        
        [mutableString replaceOccurrencesOfString:emojiStr
                                       
                                       withString:[NSString stringWithFormat:@"[%@]",obj]
                                          
                                          options:NSLiteralSearch
                                            
                                            range:NSMakeRange(0, mutableString.length)];
    
    }];
    
    
    return mutableString;
}




- (void)top:(UserIMBizType)bizType pill:(BOOL)groupChat {

    
    _app = bizType;
    
    self.agenda.rank = self.clickVariety;
    
    [self.agenda userCancel:bizType representationPic:groupChat];
}


- (void)lightKey {
    
    
    self.agenda.max = NO;
}


- (void)kick {
    
    self.agenda.model = NO;
    
    [self.agenda mas_updateConstraints:^(MASConstraintMaker *make) {
        
        make.height.mas_equalTo(46);
    
    }];
}



- (void)mic{
    
    
    if (self.barNext) {
        
        [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(imageWith) object:nil];
    }
    
    self.barNext = YES;
    
    [self performSelector:@selector(imageWith) withObject:nil afterDelay:1.0];
}


- (void)imageWith{
    
    
    self.barNext = NO;
    
    
    [self.blockViewBbbb aside:[self itemClose]
                                       
                                       key:self.info];
}


- (NSString*)itemClose{
    
    if (self.commonList == GJInputViewTypePrivateChat) {
        
        return self.time.text;
    
    }else{
        
        if (self.time.attributedText) {
            
            if ([self.time.attributedText containsAttachmentsInRange:NSMakeRange(0, self.time.attributedText.length)]) {
                
                return @"@";
            
            }else{
                
                return self.time.attributedText.string;
            }
        
        }else{
            
            return self.time.text;;
        }
    }
}


- (void)userBbbb{
    
    
    
    self.info = NO;
    
    
    self.blockViewBbbb.hidden = YES;
    
    self.blockViewBbbb.tab = YES;
    
    
    if (self.commonList == GJInputViewTypeGroupChat) {
        
        self.time.attributedText = self.systemAttributedText;
        
        [self related];
    
    }else{
        
        self.time.text = self.city;

    }
    
    [self opticalLight];

    
    self.add.hidden = YES;
    
    
    if (self.barNext) {
        
        [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(imageWith) object:nil];
    }
    
}


- (void)dropNeed:(LFCSocialChatInputViewState )state{
    
    self.bar = state;
}
 

#pragma mark UITextViewDelegate

- (void)setReport:(NSInteger)tCoin{
    
    _report = tCoin;
    
    [self opticalLight];
}


- (void)opticalLight{
    
    
    NSString *defaultTxt = self.commonList == GJInputViewTypeGroupChat ? @"" : [PlayColorBbbb size].familyDescriptionAddtion.defaultTxt;
    
    if (FZUtils.isEmptyString(defaultTxt)) {
        
        defaultTxt = (StringFromAmazingData(&kDustTitle));
    }
    
    
    if (self.commonList == GJInputViewTypeGroupChat) {
        
        NSString* str;
        
        
        if (self.feed && _report > 0) {
            
            str = [NSString stringWithFormat:StringFromAmazingData(&k_boringAttributeTitle),_report];
        
        }else{
            
            str = defaultTxt;
        }
        
        self.time.content = self.info ? (StringFromAmazingData(&kDateTitle)) : str;
    
    }else{
        
        self.time.content = self.info ? (StringFromAmazingData(&kDateTitle)) : defaultTxt;
    }
}


- (void)setFinishBbbb:(NSString*)string {
    
    if (FZUtils.isEmptyString(string)) {
        
        return;
    }
    
    if (self.commonList == GJInputViewTypeGroupChat) {
        
        NSAttributedString* attr = [[NSAttributedString alloc] initWithString:string attributes:self.angelDrop];
        
        self.time.attributedText = attr;
        
        self.systemAttributedText = self.time.attributedText;
        
        [self related];
    
    }else{
        
        self.time.text = string;
        
        self.city = string;
    }
}


- (NSString*)user{
    
    NSString* ret;
    
    if (self.info) {
        
        
        if (self.commonList == GJInputViewTypeGroupChat) {
            
            ret = [self statusEnter:self.systemAttributedText];
        
        }else{
            
            ret = self.city;
        }
        
        return ret;
    
    }else{
        
        if (self.commonList == GJInputViewTypeGroupChat) {
            
            ret = [self statusEnter:self.time.attributedText];
            
            return ret;
        
        }else{
            
            return self.time.attributedText.string;
        }
    }
    
}


- (NSString*)statusEnter:(NSAttributedString*)attrText{
    
    
    if (attrText.length) {
        
        NSMutableString* pureStr = [NSMutableString string];
        
        @weakify(attrText);
        
        [attrText enumerateAttributesInRange:NSMakeRange(0, attrText.length) options:0 usingBlock:^(NSDictionary<NSAttributedStringKey,id> * _Nonnull attrs, NSRange range, BOOL * _Nonnull stop) {
            
            @strongify(attrText);
            
            if ([attrText containsAttachmentsInRange:range]) {
                
            
            }else{
                
                NSAttributedString* sub = [attrText attributedSubstringFromRange:range];
                
                [pureStr appendString:sub.string];
            }
        
        }];
        
        return pureStr.copy;
    }
    
    return nil;
}


- (void)picSex{
    
    
    if ([WritingGrantBbbb shirtButtonNotice]) {
        
        return;
    }
    
    
    if (self.commonList == GJInputViewTypeGroupChat && self.feed) {
        
        if ([self withPage]) {
            
            [self push:StringFromAmazingData(&kShelfValue)];
            
            return;
        }
    }
    
    [self scene];
    
    NSString *sendStr = [self fromText:self.time.attributedText];
    
    if (_messageDelegateBbbb && [_messageDelegateBbbb respondsToSelector:@selector(view:chat:)]) {
        
        if (sendStr && !FZUtils.isEmptyString(sendStr)) {
            
            [self.messageDelegateBbbb view:self chat:sendStr];
        
        }else{
            
            [self.messageDelegateBbbb view:self chat:nil];
        }
    }
    
    
    if (self.commonList == GJInputViewTypeGroupChat) {
        
        self.systemAttributedText = nil;
        
        [_time setAttributedText:nil];
        
        [_time setText:nil];
        
        _time.font = self.angelDrop[NSFontAttributeName];
        
        _time.textColor = self.angelDrop[NSForegroundColorAttributeName];
    
    }else{
        
        self.city = nil;
        
        [_time setText:nil];
    }
    
    
    CGFloat width = _time.width;
    
    [_time sizeToFit];
    
    _time.width = width;
    
}


- (BOOL)textView:(ColorView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text{
    
    NSRange selectedRange = textView.selectedRange;
    

    
    if ([text isEqualToString:@"\n"]) {
        
        
        if (self.info) return NO;
        
        
        [self picSex];
        
        return  NO;
    }
    
    
    BOOL userHandel=YES;
    
    
    if (self.commonList == GJInputViewTypeGroupChat && self.feed) {
        
        NSString* tmpStr = [textView.text stringByReplacingCharactersInRange:range withString:text];
        
        if (tmpStr.length > 50) {
            
            userHandel = NO;
        }
    }
    
    
    if (self.messageDelegateBbbb
        
        && [self.messageDelegateBbbb respondsToSelector:@selector(stage:video:match:playRank:)]) {
        
        userHandel = [self.messageDelegateBbbb stage:self
                                         
                                         video:self.time
                          
                          match:range
                                  
                                  playRank:text];
    }
    
    
    if (self.commonList == GJInputViewTypeGroupChat && userHandel) {
        
        if (!self.info && [text isEqualToString:@"@"] && [self pastLength] < 10) {
            
            if (self.matchStatus) {
                
                self.matchStatus(NSMakeRange(range.location, text.length));
            }
        }
    }
    
    //: NSLog(@"typingAttributes = %@",self.inputTextView.typingAttributes);
    
    self.time.typingAttributes = self.angelDrop;
    
    
    return userHandel || YES;
}


- (BOOL)textViewShouldBeginEditing:(ColorView *)textView{
    
    
    if ([WritingGrantBbbb shirtButtonNotice]) {
        
        return NO;
    }
    
    
    if (self.bar != LFCSocialChatInputViewStateSystem) {
        
        if (self.bar == LFCSocialChatInputViewStateAdd){
            
            [self kick];
        }
        
        self.bar = LFCSocialChatInputViewStateSystem;
        
        [UIView animateWithDuration:0.25 delay:0.0f options:0 animations:^{
            
            [_panoramicView setTop:screenHeight()];
            
            [_block setTop:screenHeight()];
        
        } completion:^(BOOL finished) {
//            self.inputState = LFCSocialChatInputViewStateSystem;
        
        }];
    }
    
    
    return YES;
}


- (BOOL)textViewShouldEndEditing:(ColorView *)textView{
    
    
    self.bar = LFCSocialChatInputViewStateSystem;
    
    if (self.bar == LFCSocialChatInputViewStateSystem) {
        
        [UIView animateWithDuration:0.25 delay:0.0f options:0 animations:^{
            
            if (_everHeadBbbb) {
                
                [self setTop:screenHeight()- CGRectGetHeight(self.frame) - safeAreaBottomHeight()];
                
                [self lightKey];
            
            }else{
                
                [self setTop:screenHeight()-safeAreaBottomHeight()];
            }
            
        
        } completion:^(BOOL finished) {
        
        }];
    }
    
    
    return YES;
}


- (void)textViewDidBeginEditing:(ColorView *)textView{
    
    
    if (self.messageDelegateBbbb && [self.messageDelegateBbbb respondsToSelector:@selector(message:pathEditing:)]) {
        
        [self.messageDelegateBbbb message:self pathEditing:self.time];
    }
    
}


- (void)textViewDidEndEditing:(ColorView *)textView{
    
    if (self.messageDelegateBbbb && [self.messageDelegateBbbb respondsToSelector:@selector(limit:startEnd:)]) {
        
        [self.messageDelegateBbbb limit:self startEnd:self.time];
    }
    
    
    [self userBbbb];
}


- (void)textViewDidChange:(ColorView *)textView{
    
    
    if (self.messageDelegateBbbb && [self.messageDelegateBbbb respondsToSelector:@selector(cancel:enough:)]) {
        
        [self.messageDelegateBbbb cancel:self enough:self.time];
    }
    
    
    if (self.commonList == GJInputViewTypeGroupChat) {
        
        if (textView.attributedText.length == 0){
            
            self.time.font = self.angelDrop[NSFontAttributeName];
            
            self.time.textColor = self.angelDrop[NSForegroundColorAttributeName];
            
            [self related];
        }
    }
    
    
    if (self.info == NO) {
        
        if (textView.text.length > 255) {
            
            textView.text = [textView.text substringToIndex:255];
            
            [textView scrollRangeToVisible:NSMakeRange(0, 255)];
        }
        
        if (self.commonList == GJInputViewTypeGroupChat) {
            
            self.systemAttributedText = textView.attributedText;
        
        }else{
            
            self.city = textView.text;
        }

    
    }else{
        
        if (textView.text.length > 10) {
            
            textView.text = [textView.text substringToIndex:10];
            
            [textView scrollRangeToVisible:NSMakeRange(0, 10)];
        }
    }
    
    
    [self mic];
}

  

#pragma mark - KeyBoard Notification Handlers

- (void)momented:(NSNotification*)aNotification{
    
    
    if ([aNotification name] == UIKeyboardWillChangeFrameNotification) {
      
        
        
        if ((self.bar == LFCSocialChatInputViewStateSystem || self.bar == LFCSocialChatInputViewStateGif)
            
            && [self.time isFirstResponder]) {
           
            
            NSDictionary* userInfo  = [aNotification userInfo];
            
            CGRect keyboardEndFrame = [[userInfo objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue];
            
            
            CGFloat keyboardY   = keyboardEndFrame.origin.y;
            
            CGFloat selfOriginY = (keyboardY == screenHeight()
                                   
                                   ? (self.everHeadBbbb
                                      
                                      ? screenHeight() - CGRectGetHeight(self.frame) - safeAreaBottomHeight()
                                      
                                      : screenHeight())
                                   
                                   : keyboardY - CGRectGetHeight(self.frame));
            
            
            if (selfOriginY == self.frame.origin.y) {
                
                return;
            }
            
            
            __weak typeof(self) weakSelf = self;
            
            void (^endFrameBlock)(void)  = ^(void){
                
                
                [weakSelf setTop:selfOriginY];
            
            };
            
            
            self.item.selected = NO;

            
            
            NSTimeInterval animationDuration = [[userInfo objectForKey:UIKeyboardAnimationDurationUserInfoKey] doubleValue];
            
            UIViewAnimationCurve animationCurve = [[userInfo objectForKey:UIKeyboardAnimationCurveUserInfoKey] intValue];
           
            
            [UIView animateWithDuration:animationDuration delay:0.0f options:[UIView window:animationCurve] animations:^{
                
                endFrameBlock();
            
            } completion:nil];
        }
        
    }
}


#pragma mark - Fast Reply Method

- (void)guide:(NSString*)replyMessage{
    
    if (_messageDelegateBbbb && [_messageDelegateBbbb respondsToSelector:@selector(view:chat:)]) {
        
        if (replyMessage && !FZUtils.isEmptyString(replyMessage)) {
            
            [self.messageDelegateBbbb view:self chat:replyMessage];
        
        }else{
            
            [self.messageDelegateBbbb view:self chat:nil];
        }
    }
    
    [self clickBbbb];
}


- (void)clickBbbb{
    
    if (self.bar == LFCSocialChatInputViewStateReply) {
        
        [_block setTop:screenHeight()];
        
        if (self.everHeadBbbb) {
            
            [self setTop:screenHeight()- CGRectGetHeight(self.frame)-safeAreaBottomHeight()];
        
        }else{
            
            [self setTop:screenHeight()];
        }
        
        
        self.bar = LFCSocialChatInputViewStateSystem;
        
        
        if (self.address) {
            
            self.address(self.block, NO);
        }
    }
}


#pragma mark - lazy init

- (NSMutableSet*)rank{
    
    
    if (!_rank) {
        
        _rank=[[NSMutableSet alloc] init];
    }
    
    return _rank;
}


- (NSMutableArray *)filtrate{
    
    if (!_filtrate) {
        
        _filtrate = [NSMutableArray array];
    }
    
    return _filtrate;
}


- (ThemeControl *)clear {
    
    if (!_clear) {
        
        _clear = [[ThemeControl alloc] initWithFrame:CGRectMake(0, 0, 0, 35)];
        
        _clear.hidden = YES;
        
        [_clear addTarget:self action:@selector(clickPush) forControlEvents:UIControlEventTouchUpInside];
    }
    
    return _clear;
}




- (void)setGlobal:(BOOL)showNextChatBtn{
    
    _global = showNextChatBtn;
    
    
    NSString *cacheKey = [NSString stringWithFormat:StringFromAmazingData(&k_fromForeignContent),[ExamineColorBbbb infoBbbb]];
    
    BOOL isFirstLoad = ![[NSUserDefaults standardUserDefaults] boolForKey:cacheKey];
    
    
    CGFloat jumpWidth = isFirstLoad ? 120 : 35;
    
    [self.clear mas_updateConstraints:^(MASConstraintMaker *make) {
        
        make.width.mas_equalTo(jumpWidth);
    
    }];
    
    self.clear.guide = isFirstLoad;
    
    
    self.clear.hidden = !showNextChatBtn;
}



@end


Byte *AmazingDataToByte(AstonishingFinish *data) {
    if (data->sourcePhenomSpar) return data->labelHut;
    for (int i = 0; i < data->sandwichWalking; i++) {
        data->labelHut[i] ^= data->pathTableSucceed;
    }
    data->labelHut[data->sandwichWalking] = 0;
    data->sourcePhenomSpar = true;
	if (data->sandwichWalking >= 1) {
		data->perceivedSucceed = data->labelHut[0];
	}
    return data->labelHut;
}

NSString *StringFromAmazingData(AstonishingFinish *data) {
    return [NSString stringWithUTF8String:(char *)AmazingDataToByte(data)];
}
