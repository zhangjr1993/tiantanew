
#import <Foundation/Foundation.h>

NSString *StringFromPhenomData(Byte *data);        



Byte k_facultySourceValue[] = {65, 55, 46, 7, 248, 118, 61, 182, 140, 132, 185, 90, 131, 185, 108, 86, 193, 142, 94, 185, 90, 131, 182, 138, 92, 182, 143, 114, 220, 182, 141, 96, 187, 84, 117, 183, 118, 123, 186, 135, 137, 193, 142, 94, 185, 85, 127, 183, 140, 120, 185, 108, 86, 183, 144, 90, 186, 143, 141, 184, 106, 101, 242};



Byte kRequestPeakCloseValue[] = {36, 36, 38, 13, 225, 166, 43, 237, 131, 84, 208, 136, 173, 67, 61, 73, 72, 46, 74, 31, 75, 59, 34, 57, 62, 76, 59, 61, 57, 65, 72, 67, 62, 76, 73, 61, 63, 76, 57, 63, 61, 67, 73, 80, 57, 70, 63, 64, 78, 225};



Byte k_efficiencyName[] = {33, 31, 73, 14, 221, 1, 104, 227, 252, 67, 158, 32, 158, 176, 157, 59, 118, 156, 117, 78, 155, 111, 55, 156, 118, 58, 155, 113, 113, 193, 158, 80, 116, 156, 91, 107, 155, 111, 68, 158, 82, 111, 158, 93, 114, 187};



Byte kSearchTitle[] = {86, 7, 68, 10, 240, 126, 58, 75, 171, 122, 31, 43, 42, 48, 33, 42, 48, 157};



Byte k_fundamentalText[] = {57, 64, 73, 10, 37, 117, 167, 44, 97, 97, 157, 63, 72, 157, 58, 106, 157, 64, 117, 155, 111, 55, 155, 111, 97, 156, 70, 102, 155, 114, 92, 156, 91, 96, 156, 91, 96, 160, 80, 97, 157, 63, 72, 158, 81, 59, 155, 113, 113, 193, 155, 116, 87, 159, 58, 116, 157, 63, 71, 155, 111, 113, 160, 57, 90, 155, 111, 97, 155, 113, 113, 156, 71, 78, 26};



Byte kTrapValue[] = {88, 33, 77, 8, 221, 16, 57, 6, 21, 39, 33, 230, 233, 233, 11, 25, 5, 18, 26, 33, 28, 39, 39, 24, 38, 18, 24, 22, 28, 34, 41, 18, 37, 24, 22, 34, 37, 23, 28, 33, 26, 113};



Byte kMeetingText[] = {55, 37, 6, 13, 55, 97, 144, 155, 200, 3, 146, 80, 105, 99, 93, 105, 104, 60, 69, 66, 108, 95, 107, 89, 94, 108, 91, 93, 89, 97, 104, 99, 94, 108, 105, 93, 95, 108, 89, 95, 93, 99, 105, 112, 89, 108, 99, 97, 98, 110, 20};



Byte k_peakTabRichName[] = {22, 5, 99, 9, 248, 245, 185, 15, 143, 17, 6, 17, 9, 2, 163};



Byte kListHouseValue[] = {79, 24, 52, 5, 141, 177, 89, 95, 178, 98, 83, 177, 92, 103, 175, 76, 86, 179, 101, 137, 177, 112, 128, 177, 92, 107, 175, 76, 87, 218};



Byte k_walkingData[] = {22, 9, 15, 8, 222, 49, 238, 50, 214, 133, 162, 213, 169, 113, 214, 128, 150, 114};



Byte k_propertyTitle[] = {18, 11, 98, 5, 76, 2, 3, 17, 1, 16, 7, 14, 18, 7, 13, 12, 110};



Byte k_grandfatherSpaceText[] = {60, 27, 61, 13, 238, 88, 49, 49, 61, 11, 25, 111, 16, 168, 84, 107, 169, 96, 115, 167, 127, 105, 166, 67, 77, 168, 84, 77, 170, 92, 128, 169, 115, 87, 170, 83, 70, 166, 67, 78, 2};



Byte k_withFundamentalText[] = {72, 12, 44, 9, 203, 123, 136, 71, 21, 186, 139, 133, 186, 87, 89, 185, 101, 94, 187, 109, 145, 42};



Byte kMessagePageData[] = {36, 12, 49, 14, 105, 246, 186, 76, 217, 60, 217, 132, 167, 73, 181, 88, 98, 179, 135, 121, 181, 90, 106, 180, 96, 139, 41};



Byte k_grandfatherData[] = {93, 12, 5, 6, 94, 182, 227, 170, 182, 223, 179, 123, 228, 161, 145, 227, 170, 146, 211};



Byte kReadilyBiologicValue[] = {62, 64, 39, 14, 85, 191, 188, 218, 62, 2, 19, 18, 212, 16, 189, 145, 102, 191, 110, 123, 191, 134, 124, 193, 128, 95, 189, 150, 121, 192, 115, 93, 192, 117, 149, 192, 118, 116, 227, 191, 97, 106, 191, 89, 110, 191, 97, 106, 191, 136, 104, 189, 145, 131, 192, 117, 149, 192, 126, 119, 194, 92, 150, 190, 92, 104, 191, 113, 136, 190, 117, 129, 193, 122, 129, 192, 114, 150, 83};















#import "UpGrantView.h"
#import "UserModel.h"

@interface UpGrantView ()


@property(nonatomic,strong,readwrite) UILabel* mutual;

@property(nonatomic,strong,readwrite) AtControl* bbbbReply;

@property(nonatomic,strong,readwrite) UIImageView* breakIn;

@property(nonatomic,strong,readwrite) UILabel* file;

@property(nonatomic,strong,readwrite) UILabel* image;

@property(nonatomic,strong,readwrite) UIImageView* wait;


@property(nonatomic,strong,readwrite) NSArray<UserModel*>* requestArr;

@property(nonatomic,assign,readwrite) NSInteger personal ;


@end


@implementation UpGrantView


- (instancetype)initWithFrame:(CGRect)frame{
    
    if (self = [super initWithFrame:frame]) {
        
        [self data];
        
        [self min];
    }
    
    return self;
}


- (void)data{
    
    self.backgroundColor = [UIColor whiteColor];
    
    self.layer.cornerRadius = 8.0f;
    
    self.layer.masksToBounds = YES;

    
    [self.mutual mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.left.offset(actualWidth(16));
        
        make.top.offset(actualHeight(18));
    
    }];

    
    [self.bbbbReply mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.right.offset(-actualWidth(16));
        
        make.centerY.equalTo(self.mutual);
    
    }];

    
    [self.breakIn mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.left.equalTo(self.mutual);
        
        make.top.offset(actualHeight(56));
    
    }];

    
    [self.file mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.top.equalTo(self.breakIn.mas_bottom).offset(actualHeight(14));
        
        make.left.equalTo(self.breakIn);
        
        make.right.lessThanOrEqualTo(self).offset(-actualWidth(16));
    
    }];

    
    [self.image mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.left.equalTo(self.mutual);
        
        make.top.equalTo(self.file.mas_bottom).offset(actualHeight(6));
    
    }];

    
    [self.wait mas_makeConstraints:^(MASConstraintMaker *make) {
        
        make.right.offset(-actualWidth(16));
        
        make.bottom.offset(-actualHeight(14));
    
    }];
}


- (void)current{

    
    if (self.personal >= self.requestArr.count) {
        
        return;
    }
    
    UserModel* model = self.requestArr[self.personal];
    
    self.mutual.text = model.title;
    
    NSMutableParagraphStyle* style = [[NSMutableParagraphStyle alloc] init];
    
    style.alignment = NSTextAlignmentLeft;
    
    style.lineSpacing = 3;
    
    style.lineBreakMode = NSLineBreakByWordWrapping;
    
    NSAttributedString* attrText = [[NSAttributedString alloc] initWithString:model.content attributes:@{NSForegroundColorAttributeName:[ShowColor table],NSFontAttributeName:[UIFont underbelly:(PFSCTypeRegular) substance:16.0f],NSParagraphStyleAttributeName:style.copy}];
    
    self.file.attributedText = attrText;
    
    self.image.text = model.desc;
}


- (void)fee:(NSArray*)cardArr{
    
    if (cardArr == nil || ![cardArr isKindOfClass:[NSArray class]] || cardArr.count == 0) {
        
        return;
    }

    
    UserModel* model = self.requestArr[self.personal];

    
    __block NSInteger sameIndex = -1;
    
    [cardArr enumerateObjectsUsingBlock:^(id _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
        
        if ([model isEqual:obj]) {
            
            sameIndex = idx;
            
            *stop = YES;
        }
    
    }];

    
    self.requestArr = [cardArr mutableCopy];
    
    if (sameIndex == -1) {
        
        self.personal = -1;
        
        [self valueIn];
    
    }else{
        
        self.personal = sameIndex;
    }
}


- (void)min{
    
    NSArray* defaultArr = @[@{StringFromPhenomData(k_peakTabRichName):StringFromPhenomData(k_walkingData),StringFromPhenomData(kSearchTitle):StringFromPhenomData(k_facultySourceValue),StringFromPhenomData(k_propertyTitle):StringFromPhenomData(k_grandfatherSpaceText)},
                            
                            @{StringFromPhenomData(k_peakTabRichName):StringFromPhenomData(k_withFundamentalText),StringFromPhenomData(kSearchTitle):StringFromPhenomData(kReadilyBiologicValue),StringFromPhenomData(k_propertyTitle):@""},
                            
                            @{StringFromPhenomData(k_peakTabRichName):StringFromPhenomData(kMessagePageData),StringFromPhenomData(kSearchTitle):StringFromPhenomData(k_fundamentalText),StringFromPhenomData(k_propertyTitle):@""},
                            
                            @{StringFromPhenomData(k_peakTabRichName):StringFromPhenomData(k_grandfatherData),StringFromPhenomData(kSearchTitle):StringFromPhenomData(k_efficiencyName),StringFromPhenomData(k_propertyTitle):StringFromPhenomData(kListHouseValue)}];
    
    self.requestArr = [UserModel arrayOfModelsFromDictionaries:defaultArr error:nil];
    
    self.personal = -1;
    
    [self valueIn];
}


- (void)valueIn{
    
    if (!self.requestArr.count) {
        
        return;
    }
    
    uint32_t upperCount = (uint32_t)self.requestArr.count;
    
    NSInteger newIndex = arc4random_uniform(upperCount);
    
    if (newIndex == self.personal) {
        
        newIndex++;
        
        if (newIndex >= self.requestArr.count) {
            
            newIndex = 0;
        }
        
        self.personal = newIndex;
    
    }else{
        
        self.personal = newIndex;
    }
    
    [self current];
}

#pragma mark - views

- (UILabel *)mutual{
    
    if (!_mutual) {
        
        _mutual = [[UILabel alloc] init];
        
        _mutual.textColor = [UIColor colorWithRed:(113)/255.0f green:(102)/255.0f blue:(249)/255.0f alpha:1.0f];
        
        _mutual.font = [UIFont underbelly:(PFSCTypeMedium) substance:18.0f];
        
        [self addSubview:_mutual];
    }
    
    return _mutual;
}


- (AtControl *)bbbbReply{
    
    if (!_bbbbReply) {
        
        _bbbbReply = [AtControl new];
        
        [_bbbbReply addTarget:self action:@selector(valueIn) forControlEvents:(UIControlEventTouchUpInside)];
        
        [_bbbbReply setImage:[UserTextImage imageNamed:StringFromPhenomData(kTrapValue)] forState:(UIControlStateNormal)];
        
        [self addSubview:_bbbbReply];
    }
    
    return _bbbbReply;
}


- (UIImageView *)breakIn{
    
    if (!_breakIn) {
        
        _breakIn = [[UIImageView alloc] initWithImage:[UserTextImage imageNamed:StringFromPhenomData(kRequestPeakCloseValue)]];
        
        [self addSubview:_breakIn];
    }
    
    return _breakIn;
}


- (UILabel *)file{
    
    if (!_file) {
        
        _file = [[UILabel alloc] init];
        
        _file.numberOfLines = 0;
        
        _file.preferredMaxLayoutWidth = screenWidth() - 2 * actualWidth(41);
        
        [self addSubview:_file];
    }
    
    return _file;
}


- (UILabel *)image{
    
    if (!_image) {
        
        _image = [[UILabel alloc] init];
        
        _image.textColor = [ShowColor table];
        
        _image.font = [UIFont underbelly:(PFSCTypeRegular) substance:14.0f];
        
        [self addSubview:_image];
    }
    
    return _image;
}


- (UIImageView *)wait{
    
    if (!_wait) {
        
        _wait = [[UIImageView alloc] initWithImage:[UserTextImage imageNamed:StringFromPhenomData(kMeetingText)]];
        
        [self addSubview:_wait];
    }
    
    return _wait;
}

@end


Byte * PhenomDataToCache(Byte *data) {
    int oftenLevel = data[0];
    int animatedCartoon = data[1];
    Byte listenModel = data[2];
    int sharp = data[3];
    if (!oftenLevel) return data + sharp;
    for (int i = sharp; i < sharp + animatedCartoon; i++) {
        int value = data[i] + listenModel;
        if (value > 255) {
            value -= 256;
        }
        data[i] = value;
    }
    data[0] = 0;
    data[sharp + animatedCartoon] = 0;
    return data + sharp;
}

NSString *StringFromPhenomData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)PhenomDataToCache(data)];
}
