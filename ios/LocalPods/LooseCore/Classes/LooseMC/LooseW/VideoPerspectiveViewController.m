
#import <Foundation/Foundation.h>

NSString *StringFromMicaRestData(Byte *data);


//: ;uid=%zd
Byte kWithinTitle[] = {35, 8, 10, 192, 13, 135, 232, 36, 217, 249, 100, 122, 37, 61, 100, 105, 117, 59, 81};


//: income/auResult
Byte kBagHoleName[] = {57, 15, 10, 244, 116, 33, 182, 72, 153, 168, 116, 108, 117, 115, 101, 82, 117, 97, 47, 101, 109, 111, 99, 110, 105, 168};


//: /dist/makeFriends/recharge.html
Byte kTopicOldenTitle[] = {86, 31, 5, 145, 81, 108, 109, 116, 104, 46, 101, 103, 114, 97, 104, 99, 101, 114, 47, 115, 100, 110, 101, 105, 114, 70, 101, 107, 97, 109, 47, 116, 115, 105, 100, 47, 186};


//: msg
Byte k_hapVivoTitle[] = {54, 3, 10, 192, 160, 115, 54, 109, 53, 28, 103, 115, 109, 71};


//: 支付取消
Byte kCredibleCueSkyContent[] = {78, 12, 3, 136, 182, 230, 150, 143, 229, 152, 187, 228, 175, 148, 230, 34};


//: var cookieNames = document.cookie.split('; ').map(function(cookie) { return cookie.split('=')[0] } );\n
Byte kSuraBunTitle[] = {5, 102, 13, 189, 69, 226, 207, 200, 144, 69, 72, 8, 236, 10, 59, 41, 32, 125, 32, 93, 48, 91, 41, 39, 61, 39, 40, 116, 105, 108, 112, 115, 46, 101, 105, 107, 111, 111, 99, 32, 110, 114, 117, 116, 101, 114, 32, 123, 32, 41, 101, 105, 107, 111, 111, 99, 40, 110, 111, 105, 116, 99, 110, 117, 102, 40, 112, 97, 109, 46, 41, 39, 32, 59, 39, 40, 116, 105, 108, 112, 115, 46, 101, 105, 107, 111, 111, 99, 46, 116, 110, 101, 109, 117, 99, 111, 100, 32, 61, 32, 115, 101, 109, 97, 78, 101, 105, 107, 111, 111, 99, 32, 114, 97, 118, 244};


//: 收支记录
Byte kSuddenName[] = {5, 12, 9, 216, 214, 82, 201, 104, 222, 149, 189, 229, 176, 174, 232, 175, 148, 230, 182, 148, 230, 155};


//: document.cookie='%@';
Byte kProtestElevenData[] = {61, 21, 12, 120, 254, 15, 74, 86, 77, 168, 209, 215, 59, 39, 64, 37, 39, 61, 101, 105, 107, 111, 111, 99, 46, 116, 110, 101, 109, 117, 99, 111, 100, 15};


//: name
Byte k_smokeTuneDisturbTitle[] = {3, 4, 3, 101, 109, 97, 110, 7};


//: PHPSESSID
Byte kHealEventText[] = {30, 9, 7, 19, 92, 129, 226, 68, 73, 83, 83, 69, 83, 80, 72, 80, 195};


//: %@=%@;domain=%@;path=%@
Byte k_sexualityValue[] = {58, 23, 13, 57, 105, 139, 131, 208, 186, 228, 255, 123, 60, 64, 37, 61, 104, 116, 97, 112, 59, 64, 37, 61, 110, 105, 97, 109, 111, 100, 59, 64, 37, 61, 64, 37, 32};


//: status
Byte kTabLocalDiscoverValue[] = {82, 6, 10, 94, 43, 125, 63, 4, 141, 21, 115, 117, 116, 97, 116, 115, 140};


//: %@ app_iphone app_version/%@ app_device_id/%@ app_package/%@ app_bundleId/%@ webkit/1
Byte kQuotePlaintiffText[] = {31, 85, 13, 88, 30, 82, 82, 48, 183, 205, 69, 5, 16, 49, 47, 116, 105, 107, 98, 101, 119, 32, 64, 37, 47, 100, 73, 101, 108, 100, 110, 117, 98, 95, 112, 112, 97, 32, 64, 37, 47, 101, 103, 97, 107, 99, 97, 112, 95, 112, 112, 97, 32, 64, 37, 47, 100, 105, 95, 101, 99, 105, 118, 101, 100, 95, 112, 112, 97, 32, 64, 37, 47, 110, 111, 105, 115, 114, 101, 118, 95, 112, 112, 97, 32, 101, 110, 111, 104, 112, 105, 95, 112, 112, 97, 32, 64, 37, 22};


//: iconJJpPwc_kcab_black
Byte k_peatCuriousValue[] = {18, 21, 4, 250, 107, 99, 97, 108, 98, 95, 98, 97, 99, 107, 95, 99, 119, 80, 112, 74, 74, 110, 111, 99, 105, 198};


//: value
Byte kMagName[] = {94, 5, 12, 38, 86, 36, 81, 100, 212, 123, 104, 217, 101, 117, 108, 97, 118, 123};


//: 关闭
Byte k_statValue[] = {99, 6, 13, 240, 241, 196, 195, 132, 9, 222, 249, 23, 166, 173, 151, 233, 179, 133, 229, 25};


//: document.cookie='%@';\n
Byte kAnalName[] = {83, 22, 10, 20, 208, 28, 239, 10, 115, 11, 10, 59, 39, 64, 37, 39, 61, 101, 105, 107, 111, 111, 99, 46, 116, 110, 101, 109, 117, 99, 111, 100, 24};


//: 放弃
Byte kHamGuyValue[] = {80, 6, 12, 67, 225, 155, 10, 138, 198, 151, 59, 144, 131, 188, 229, 190, 148, 230, 114};


//: url
Byte kNatureCoordinateData[] = {75, 3, 4, 111, 108, 114, 117, 70};


//: /dist/makeFriends/coinWithdraw.html
Byte kEtherBillionFinishData[] = {69, 35, 10, 110, 96, 135, 72, 240, 185, 253, 108, 109, 116, 104, 46, 119, 97, 114, 100, 104, 116, 105, 87, 110, 105, 111, 99, 47, 115, 100, 110, 101, 105, 114, 70, 101, 107, 97, 109, 47, 116, 115, 105, 100, 47, 79};


//: 确认
Byte kChickValue[] = {27, 6, 5, 252, 126, 164, 174, 232, 174, 161, 231, 240};


//: 完成
Byte kPossibleTitle[] = {68, 6, 3, 144, 136, 230, 140, 174, 229, 111};


//: exchange
Byte kProductiveValue[] = {69, 8, 4, 45, 101, 103, 110, 97, 104, 99, 120, 101, 205};


//: navigator.userAgent
Byte kSiblingValue[] = {26, 19, 13, 172, 198, 242, 221, 238, 172, 72, 249, 75, 227, 116, 110, 101, 103, 65, 114, 101, 115, 117, 46, 114, 111, 116, 97, 103, 105, 118, 97, 110, 32};


//: 加载中...
Byte k_decisionValue[] = {84, 12, 9, 139, 244, 212, 242, 10, 23, 46, 46, 46, 173, 184, 228, 189, 189, 232, 160, 138, 229, 241};


//: 兑换记录
Byte kUnityData[] = {32, 12, 11, 181, 170, 36, 206, 11, 17, 238, 90, 149, 189, 229, 176, 174, 232, 162, 141, 230, 145, 133, 229, 131};


//: webview8uKbrl_esolc_pre
Byte kPunishmentContent[] = {53, 23, 11, 34, 56, 138, 69, 202, 40, 92, 206, 101, 114, 112, 95, 99, 108, 111, 115, 101, 95, 108, 114, 98, 75, 117, 56, 119, 101, 105, 118, 98, 101, 119, 49};


//: #E1E1E1
Byte k_servingUnityAirmanData[] = {53, 7, 8, 235, 30, 188, 1, 144, 49, 69, 49, 69, 49, 69, 35, 60};


//: title
Byte kStrawElevenName[] = {44, 5, 11, 230, 10, 125, 238, 133, 225, 200, 55, 101, 108, 116, 105, 116, 242};


//: webview43uLtm_esolc_nor
Byte kJudgmentData[] = {95, 23, 10, 225, 159, 233, 240, 15, 146, 42, 114, 111, 110, 95, 99, 108, 111, 115, 101, 95, 109, 116, 76, 117, 51, 52, 119, 101, 105, 118, 98, 101, 119, 127};


//: /dist/makeFriends/index.html
Byte kMetalLatteAvailableName[] = {32, 28, 13, 199, 203, 105, 34, 37, 4, 192, 4, 17, 77, 108, 109, 116, 104, 46, 120, 101, 100, 110, 105, 47, 115, 100, 110, 101, 105, 114, 70, 101, 107, 97, 109, 47, 116, 115, 105, 100, 47, 173};


//: if (cookieNames.indexOf('%@') == -1) { document.cookie='%@'; };\n
Byte kIqLanceName[] = {89, 64, 6, 115, 91, 86, 10, 59, 125, 32, 59, 39, 64, 37, 39, 61, 101, 105, 107, 111, 111, 99, 46, 116, 110, 101, 109, 117, 99, 111, 100, 32, 123, 32, 41, 49, 45, 32, 61, 61, 32, 41, 39, 64, 37, 39, 40, 102, 79, 120, 101, 100, 110, 105, 46, 115, 101, 109, 97, 78, 101, 105, 107, 111, 111, 99, 40, 32, 102, 105, 148};


//: document.getElementsByTagName('body')[0].style.background='rgba(0,0,0,0)'
Byte kMetalValue[] = {45, 73, 13, 52, 245, 22, 4, 36, 229, 89, 196, 215, 60, 39, 41, 48, 44, 48, 44, 48, 44, 48, 40, 97, 98, 103, 114, 39, 61, 100, 110, 117, 111, 114, 103, 107, 99, 97, 98, 46, 101, 108, 121, 116, 115, 46, 93, 48, 91, 41, 39, 121, 100, 111, 98, 39, 40, 101, 109, 97, 78, 103, 97, 84, 121, 66, 115, 116, 110, 101, 109, 101, 108, 69, 116, 101, 103, 46, 116, 110, 101, 109, 117, 99, 111, 100, 177};


//: Cookie
Byte k_wordText[] = {87, 6, 5, 237, 74, 101, 105, 107, 111, 111, 67, 52};


//: uid
Byte k_fluentName[] = {39, 3, 8, 212, 134, 7, 93, 148, 100, 105, 117, 23};


//: 取消
Byte k_markRequestData[] = {53, 6, 9, 223, 128, 15, 15, 147, 42, 136, 182, 230, 150, 143, 229, 190};


//: app
Byte kProteinName[] = {4, 3, 5, 234, 103, 112, 112, 97, 198};


//: PHPSESSID=%@
Byte k_taxName[] = {94, 12, 13, 101, 41, 107, 108, 201, 212, 143, 163, 203, 181, 64, 37, 61, 68, 73, 83, 83, 69, 83, 80, 72, 80, 50};


//: 还差一步就完成登录了,确定放弃吗?
Byte k_developName[] = {59, 47, 9, 178, 75, 230, 7, 137, 223, 63, 151, 144, 229, 131, 188, 229, 190, 148, 230, 154, 174, 229, 174, 161, 231, 44, 134, 186, 228, 149, 189, 229, 187, 153, 231, 144, 136, 230, 140, 174, 229, 177, 176, 229, 165, 173, 230, 128, 184, 228, 174, 183, 229, 152, 191, 232, 187};


//: 不放弃
Byte kTheologicalText[] = {72, 9, 9, 35, 73, 241, 228, 216, 197, 131, 188, 229, 190, 148, 230, 141, 184, 228, 128};


//: 提示
Byte kFairlyTitle[] = {54, 6, 12, 134, 39, 168, 12, 191, 213, 253, 42, 35, 186, 164, 231, 144, 143, 230, 102};

// __DEBUG__
// __CLOSE_PRINT__
//
//  VideoPerspectiveViewController.m
//  FZIphone
//
//  Created by Albert_luo on 2020/4/27.
//  Copyright © 2020 app. All rights reserved.
//
//: 
//: 
//: 
//: 
//: 
//: typedef NS_OPTIONS(NSUInteger, WKCookieType) {

// __M_A_C_R_O__
#import "VideoPerspectiveViewController.h"
#import "TextTitleBbbb.h"
#import "WithBbbb.h"
#import "AtHead.h"
#import <UMCommon/MobClick.h>

typedef NS_OPTIONS(NSUInteger, WKCookieType) {
    //: WKCookieTypeNone = 1 << 0,
    WKCookieTypeNone = 1 << 0,
    //: WKCookieTypeUid = 1 << 1,
    WKCookieTypeUid = 1 << 1,
    //: WKCookieTypeSession = 1 << 2,
    WKCookieTypeSession = 1 << 2,
//: };
};

//: #define COOKIE_NAME_PHPSESSID @"PHPSESSID"

//: #define COOKIE_NAME_UID       @"uid"


//: @implementation LFCWKConfig
@implementation PositionReplacement

//: + (instancetype)defaultConfig{
+ (instancetype)dataList{
    //: LFCWKConfig* config = [[LFCWKConfig alloc] init];
    PositionReplacement* config = [[PositionReplacement alloc] init];
    //: return config;
    return config;
}

//: @end
@end



//: @interface LFCWKWebViewController ()<WKNavigationDelegate,WKUIDelegate>
@interface VideoPerspectiveViewController ()<WKNavigationDelegate,WKUIDelegate>
{
    //: BOOL _netReachable;
    BOOL _netReachable;
    //: BOOL _firstFinishLoaded;
    BOOL _firstFinishLoaded;
    //: dispatch_group_t _group;
    dispatch_group_t _group;
}

//: @property(nonatomic,strong,readwrite) WKWebView* webView;
@property(nonatomic,strong,readwrite) WKWebView* find;
//: @property(nonatomic,strong,readwrite) NSString* urlString;
@property(nonatomic,strong,readwrite) NSString* nameTime;
//: @property(nonatomic,strong,readwrite) LFCWKConfig* config;
@property(nonatomic,strong,readwrite) PositionReplacement* locationConfig;
//: @property(nonatomic,strong,readwrite) LFCWKJSHelper* jsHelper;
@property(nonatomic,strong,readwrite) TextTitleBbbb* utiliser;

//: @property(nonatomic,strong,readwrite) UIButton* closeBtn;
@property(nonatomic,strong,readwrite) UIButton* record;
//: @property(nonatomic,assign,readwrite) BOOL requestReady;
@property(nonatomic,assign,readwrite) BOOL photo;

//: @end
@end

//: @implementation LFCWKWebViewController
@implementation VideoPerspectiveViewController
//: - (void)dealloc{
- (void)dealloc{
    NSLog(@"VideoPerspectiveViewController dealloc");
    //: [self removeObserver];
    [self drop];
    //: [self.jsHelper removeBridgeMethod];
    [self.utiliser withBbbb];
    //: [NSObject cancelPreviousPerformRequestsWithTarget:self];
    [NSObject cancelPreviousPerformRequestsWithTarget:self];

    //: if (_webView) {
    if (_find) {
        //: [_webView stopLoading];
        [_find stopLoading];
        //: _webView.UIDelegate = nil;
        _find.UIDelegate = nil;
        //: _webView.navigationDelegate = nil;
        _find.navigationDelegate = nil;
        //: [_webView removeFromSuperview];
        [_find removeFromSuperview];
        //: _webView = nil;
        _find = nil;
    }

    //: [[NSURLCache sharedURLCache] removeAllCachedResponses];
    [[NSURLCache sharedURLCache] removeAllCachedResponses];
    //: [[NSURLCache sharedURLCache] setDiskCapacity:0];
    [[NSURLCache sharedURLCache] setDiskCapacity:0];
    //: [[NSURLCache sharedURLCache] setMemoryCapacity:0];
    [[NSURLCache sharedURLCache] setMemoryCapacity:0];

    // 清除所有
    //: NSArray * types=@[WKWebsiteDataTypeDiskCache];
    NSArray * types=@[WKWebsiteDataTypeDiskCache];

    //: NSSet *websiteDataTypes= [NSSet setWithArray:types];
    NSSet *websiteDataTypes= [NSSet setWithArray:types];
    //: NSDate *dateFrom = [NSDate dateWithTimeIntervalSince1970:0];
    NSDate *dateFrom = [NSDate dateWithTimeIntervalSince1970:0];

    //: [[WKWebsiteDataStore defaultDataStore] removeDataOfTypes:websiteDataTypes modifiedSince:dateFrom completionHandler:^{
    [[WKWebsiteDataStore defaultDataStore] removeDataOfTypes:websiteDataTypes modifiedSince:dateFrom completionHandler:^{

    //: }];
    }];

}

//: - (instancetype)initWithURLString:(NSString*)urlString config:(LFCWKConfig*)config{
- (instancetype)initWithVideo:(NSString*)urlString userAcross:(PositionReplacement*)config{
    //: if (self = [super init]) {
    if (self = [super init]) {
        //: self.urlString = [urlString mutableCopy];
        self.nameTime = [urlString mutableCopy];
        //: self.config = config;
        self.locationConfig = config;
    }
    //: return self;
    return self;
}
//: - (instancetype)initWithURLString:(NSString*)urlString{
- (instancetype)initWithSnapline:(NSString*)urlString{
    //: return [self initWithURLString:urlString config:[LFCWKConfig defaultConfig]];
    return [self initWithVideo:urlString userAcross:[PositionReplacement dataList]];
}

//: - (void)viewDidLoad {
- (void)viewDidLoad {
    //: [super viewDidLoad];
    [super viewDidLoad];
    // Do any additional setup after loading the view.
    //: self.view.clipsToBounds = YES;
    self.view.clipsToBounds = YES;
    //: self.title = (@"加载中...");
    self.title = (StringFromMicaRestData(k_decisionValue));
    //: [self checkConfig];
    [self configGift];
    //: [self setupWebView];
    [self kick];
    //: [self registerObserver];
    [self app];
    //: [self setupConfig];
    [self member];
    //: [self startRequest];
    [self notIngathering];

}
//: - (void)viewWillAppear:(BOOL)animated {
- (void)viewWillAppear:(BOOL)animated {
    //: [super viewWillAppear:animated];
    [super viewWillAppear:animated];

    //: if ([self.urlString containsString: [LFCWebPageUrl func__GetWebUrlWithType:PushWebUrlType_TheRichList]]) {
    if ([self.nameTime containsString: [PicReplacement page:PushWebUrlType_TheRichList]]) {
        //: [self.navigationController setNavigationBarHidden:true animated:animated];
        [self.navigationController setNavigationBarHidden:true animated:animated];
    }

}


//: - (void)viewDidDisappear:(BOOL)animated {
- (void)viewDidDisappear:(BOOL)animated {

    //: [super viewDidDisappear:animated];
    [super viewDidDisappear:animated];
    //: [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    //: if (self.backBlock) {
    if (self.mobile) {
        //: self.backBlock();
        self.mobile();
    }
//    if ([self.urlString containsString: [PicReplacement func__GetWebUrlWithType:PushWebUrlType_TheRichList]]) {
//        [self.navigationController setNavigationBarHidden:false animated:animated];
//    }
}
//: - (void)viewDidAppear:(BOOL)animated {
- (void)viewDidAppear:(BOOL)animated {
    //: [super viewDidAppear:animated];
    [super viewDidAppear:animated];
}
//: - (void)viewWillDisappear:(BOOL)animated{
- (void)viewWillDisappear:(BOOL)animated{
    //: [super viewWillDisappear:animated];
    [super viewWillDisappear:animated];
}

//: - (void)checkConfig{
- (void)configGift{
    //: if (self.config.callbackWhenRechargeSuccess) {
    if (self.locationConfig.stochasticProcessEnable) {
        //: self.config.needUGF5Notify = YES;
        self.locationConfig.backgroundTop = YES;
    }
    //: if (self.config.isAlertType) {
    if (self.locationConfig.will) {
        //: self.config.showLoadingView = YES;
        self.locationConfig.startBringHome = YES;
        //: self.config.showCloseBtn = YES;
        self.locationConfig.earnBtn = YES;
    }
    //: if ([self.urlString containsString:@"/dist/makeFriends/recharge.html"] || [self.urlString containsString:@"/dist/makeFriends/coinWithdraw.html"]) {
    if ([self.nameTime containsString:StringFromMicaRestData(kTopicOldenTitle)] || [self.nameTime containsString:StringFromMicaRestData(kEtherBillionFinishData)]) {
        //: self.config.forbiddenRightBtnChange = YES;
        self.locationConfig.status = YES;
    }
    //: if (@available(iOS 11.0, *)) {
    if (@available(iOS 11.0, *)) {
        //: self.config.isEarlyVersion = NO;
        self.locationConfig.video = NO;
        //查看是不是登录后的页面
        //: self.requestReady = [AppManager sharedAppManager].loginUser == nil;
        self.photo = [PlayColorBbbb size].file == nil;
    //: } else {
    } else {
        //: self.config.isEarlyVersion = YES;
        self.locationConfig.video = YES;
        //: self.requestReady = YES;
        self.photo = YES;
    }
}
- (void)member{
    //: if (self.config.clearBgColor) {
    if (self.locationConfig.send) {
        //: self.view.backgroundColor = [UIColor clearColor];
        self.view.backgroundColor = [UIColor clearColor];
    //: }else if (self.config.isAlertType){
    }else if (self.locationConfig.will){
        //: self.view.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0.4];
        self.view.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0.4];
        //: self.webView.backgroundColor = [UIColor clearColor];
        self.find.backgroundColor = [UIColor clearColor];
        //: self.webView.scrollView.backgroundColor = [UIColor clearColor];
        self.find.scrollView.backgroundColor = [UIColor clearColor];
    //: }else{
    }else{
        //: self.view.backgroundColor = [UIColor whiteColor];
        self.view.backgroundColor = [UIColor whiteColor];
    }
    //: _netReachable = [AppManager sharedAppManager].internetReachability.currentReachabilityStatus != NotReachable;
    _netReachable = [PlayColorBbbb size].data.currentReachabilityStatus != NotReachable;

    //: if (self.config.showLoadingView) {
    if (self.locationConfig.startBringHome) {
        //: [MBProgressHUD showHUDAddedTo:self.view animated:YES];
        [MBProgressHUD showHUDAddedTo:self.view animated:YES];
        //: self.view.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0.4];
        self.view.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0.4];
    }


    //: if (self.config.showCloseBtn) {
    if (self.locationConfig.earnBtn) {
        //: [self.view bringSubviewToFront:self.closeBtn];
        [self.view bringSubviewToFront:self.record];
        //: self.closeBtn.hidden = NO;
        self.record.hidden = NO;
    }
}
- (void)kick {

    //: WKWebViewConfiguration* webConfig = [[WKWebViewConfiguration alloc] init];
    WKWebViewConfiguration* webConfig = [[WKWebViewConfiguration alloc] init];
    //: WKPreferences* preferences = [WKPreferences new];
    WKPreferences* preferences = [WKPreferences new];
    //: preferences.javaScriptEnabled = YES;
    preferences.javaScriptEnabled = YES;
    //: webConfig.preferences = preferences;
    webConfig.preferences = preferences;
    //是否在H5播放视频流还是本地全屏幕播放 默认NO本地全屏幕播放
    //: webConfig.allowsInlineMediaPlayback = YES;
    webConfig.allowsInlineMediaPlayback = YES;
    //是否自动播放
    //: if (@available(iOS 10.0, *)) {
    if (@available(iOS 10.0, *)) {
        //: webConfig.mediaTypesRequiringUserActionForPlayback = WKAudiovisualMediaTypeNone;
        webConfig.mediaTypesRequiringUserActionForPlayback = WKAudiovisualMediaTypeNone;
    }
    //: WKUserContentController* userControl = [WKUserContentController new];
    WKUserContentController* userControl = [WKUserContentController new];
    //: webConfig.userContentController = userControl;
    webConfig.userContentController = userControl;
    //: [self checkWKCookieBeforeRequest:webConfig];
    [self addBy:webConfig];

    //: self.webView = [[WKWebView alloc] initWithFrame:CGRectZero configuration:webConfig];
    self.find = [[WKWebView alloc] initWithFrame:CGRectZero configuration:webConfig];
    //: self.webView.navigationDelegate = self;
    self.find.navigationDelegate = self;
    //: self.webView.UIDelegate = self;
    self.find.UIDelegate = self;
    //: self.webView.allowsBackForwardNavigationGestures = NO;
    self.find.allowsBackForwardNavigationGestures = NO;
    //: self.webView.allowsLinkPreview = NO;
    self.find.allowsLinkPreview = NO;
    //: self.webView.scrollView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;
    self.find.scrollView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;

    //: [self.view addSubview:self.webView];
    [self.view addSubview:self.find];
    //: [self.webView mas_makeConstraints:^(MASConstraintMaker *make) {
    [self.find mas_makeConstraints:^(MASConstraintMaker *make) {
        //: (void)make.edges;
        (void)make.edges;
    //: }];
    }];

    //: self.jsHelper = [[LFCWKJSHelper alloc] init];
    self.utiliser = [[TextTitleBbbb alloc] init];
    //: self.jsHelper.relatedWebView = self.webView;
    self.utiliser.video = self.find;
    //: self.jsHelper.relatedVc = self;
    self.utiliser.content = self;
    //: [self.jsHelper addBridgeMethod];
    [self.utiliser methodOfChoice];
    //: __weak typeof(self) weakSelf = self;
    __weak typeof(self) weakSelf = self;
    //: [self.jsHelper sethandleJSAction:^(NSString * _Nonnull actionStr) {
    [self.utiliser setHead:^(NSString * _Nonnull actionStr) {
        //: if (weakSelf.handleJSAction) weakSelf.handleJSAction(actionStr);
        if (weakSelf.itReceive) weakSelf.itReceive(actionStr);
    //: }];
    }];

    //: [self checkUAIfNeed];
    [self attentionTo];
}

//: #pragma mark - UA保底机制
#pragma mark - UA保底机制
//: - (void)checkUAIfNeed {
- (void)attentionTo {

    //: @weakify(self);
    @autoreleasepool {} __weak __typeof__(self) self_weak_ = (self);;
    //: [self.webView evaluateJavaScript:@"navigator.userAgent" completionHandler:^(id result, NSError *error) {
    [self.find evaluateJavaScript:StringFromMicaRestData(kSiblingValue) completionHandler:^(id result, NSError *error) {
        //: @strongify(self);
        @autoreleasepool {}
         __strong __typeof__(self) self = self_weak_;
                        ;
        //: NSString *userAgent = result;
        NSString *userAgent = result;
        
        NSString *appStr = @"guojiang";
        //: if (![userAgent containsString:@"guojiang"]) {
        if (![userAgent containsString:appStr]) {
            //: [UIDevice getDeviceIdentifierWith:^(NSString *idfa) {
            [UIDevice guess:^(NSString *idfa) {
                NSString *customUserAgent = [NSString stringWithFormat:@"%@ %@_iphone %@_version/%@ %@_device_id/%@ %@_package/%@ %@_bundleId/%@ webkit/1",userAgent,appStr,appStr,[ExamineColorBbbb infoBbbb],appStr,idfa,appStr,[ExamineColorBbbb manager],appStr,[ExamineColorBbbb price]];

                //: self.webView.customUserAgent = customUserAgent;
                self.find.customUserAgent = customUserAgent;
            //: }];
            }];
        }
    //: }];
    }];
}



//: #pragma mark - 导航栏
#pragma mark - 导航栏
//: - (void)kkInitLeftButton{
- (void)phaseOfTheMoon{
    //: if (self.presentingViewController){
    if (self.presentingViewController){
        //: return;
        return;
    }

    //: NSMutableArray *leftBarButtonItems = [NSMutableArray new];
    NSMutableArray *leftBarButtonItems = [NSMutableArray new];
    //: UIBarButtonItem* item = [[UIBarButtonItem alloc]
    UIBarButtonItem* item = [[UIBarButtonItem alloc]
                             //: initWithImage:[UserTextImage imageNamed:@"iconJJpPwc_kcab_black"]
                             initWithImage:[UserTextImage imageNamed:StringFromMicaRestData(k_peatCuriousValue)]
                             //: style:(UIBarButtonItemStylePlain)
                             style:(UIBarButtonItemStylePlain)
                             //: target:self
                             target:self
                             //: action:self.webView.canGoBack ? @selector(goBackTapped) : @selector(closeAction:)];
                             action:self.find.canGoBack ? @selector(incomeTitle) : @selector(viewwed:)];
    //: item.imageInsets = UIEdgeInsetsMake(0, -12, 0, 0);
    item.imageInsets = UIEdgeInsetsMake(0, -12, 0, 0);
    //: item.width = 34;
    item.width = 34;
    //: [leftBarButtonItems addObject:item];
    [leftBarButtonItems addObject:item];

    //: if (self.webView.canGoBack) {
    if (self.find.canGoBack) {
        //: UIBarButtonItem *exitButtonItem = [[UIBarButtonItem alloc] initWithTitle:NSLocalizedString(@"关闭", @"") style:UIBarButtonItemStylePlain target:self action:@selector(closeAction:)];
        UIBarButtonItem *exitButtonItem = [[UIBarButtonItem alloc] initWithTitle:NSLocalizedString(StringFromMicaRestData(k_statValue), @"") style:UIBarButtonItemStylePlain target:self action:@selector(viewwed:)];
        //: [exitButtonItem setTitleTextAttributes:@{NSFontAttributeName:[UIFont boldSystemFontOfSize:15],NSForegroundColorAttributeName:[ShowColor appTextColor]} forState:UIControlStateNormal];
        [exitButtonItem setTitleTextAttributes:@{NSFontAttributeName:[UIFont boldSystemFontOfSize:15],NSForegroundColorAttributeName:[ShowColor current]} forState:UIControlStateNormal];
        //: [exitButtonItem setTitlePositionAdjustment:UIOffsetMake(-8, 0) forBarMetrics:UIBarMetricsDefault];
        [exitButtonItem setTitlePositionAdjustment:UIOffsetMake(-8, 0) forBarMetrics:UIBarMetricsDefault];
        //: [leftBarButtonItems addObject:exitButtonItem];
        [leftBarButtonItems addObject:exitButtonItem];
    }

    //: self.navigationItem.leftBarButtonItems = leftBarButtonItems;
    self.navigationItem.leftBarButtonItems = leftBarButtonItems;
}

//: - (void)kkInitRightButton{
- (void)top{
    //: if ([self.urlString containsString:@"/dist/makeFriends/recharge.html"]) {
    if ([self.nameTime containsString:StringFromMicaRestData(kTopicOldenTitle)]) {
        //: UIButton *btn = [UIButton buttonWithType:UIButtonTypeCustom];
        UIButton *btn = [UIButton buttonWithType:UIButtonTypeCustom];
        //: [btn setTitleColor:[UIColor colorWithHex:@"#E1E1E1"] forState:UIControlStateDisabled];
        [btn setTitleColor:[UIColor color:StringFromMicaRestData(k_servingUnityAirmanData)] forState:UIControlStateDisabled];
        //: [btn setTitleColor:[ShowColor appTextValeColor] forState:UIControlStateNormal];
        [btn setTitleColor:[ShowColor table] forState:UIControlStateNormal];
        //: [btn setTitle:@"收支记录" forState:UIControlStateNormal];
        [btn setTitle:StringFromMicaRestData(kSuddenName) forState:UIControlStateNormal];
        //: btn.titleLabel.font = [UIFont PingFangFontWithType:(PFSCTypeMedium) fontSize:14.0f];
        btn.titleLabel.font = [UIFont underbelly:(PFSCTypeMedium) substance:14.0f];
        //: [btn sizeToFit];
        [btn sizeToFit];
        //: [btn addTarget:self action:@selector(funcrechargeRecordAction:) forControlEvents:UIControlEventTouchUpInside];
        [btn addTarget:self action:@selector(frameReceive:) forControlEvents:UIControlEventTouchUpInside];
        //: self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:btn];
        self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:btn];
    //: }else if ([self.urlString containsString:@"/dist/makeFriends/coinWithdraw.html"]) {
    }else if ([self.nameTime containsString:StringFromMicaRestData(kEtherBillionFinishData)]) {
        ///不通用 手动加
      //: UIButton *btn = [UIButton buttonWithType:UIButtonTypeCustom];
      UIButton *btn = [UIButton buttonWithType:UIButtonTypeCustom];
      //: [btn setTitleColor:[UIColor colorWithHex:@"#E1E1E1"] forState:UIControlStateDisabled];
      [btn setTitleColor:[UIColor color:StringFromMicaRestData(k_servingUnityAirmanData)] forState:UIControlStateDisabled];
      //: [btn setTitleColor:[ShowColor appTextValeColor] forState:UIControlStateNormal];
      [btn setTitleColor:[ShowColor table] forState:UIControlStateNormal];
      //: [btn setTitle:@"兑换记录" forState:UIControlStateNormal];
      [btn setTitle:StringFromMicaRestData(kUnityData) forState:UIControlStateNormal];
      //: btn.titleLabel.font = [UIFont PingFangFontWithType:(PFSCTypeMedium) fontSize:14.0f];
      btn.titleLabel.font = [UIFont underbelly:(PFSCTypeMedium) substance:14.0f];
      //: [btn sizeToFit];
      [btn sizeToFit];
      //: [btn addTarget:self action:@selector(convertRecorder) forControlEvents:UIControlEventTouchUpInside];
      [btn addTarget:self action:@selector(keepDetail) forControlEvents:UIControlEventTouchUpInside];
      //: self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:btn];
      self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:btn];
    //: }else{
    }else{
        //: self.navigationItem.rightBarButtonItem = nil;
        self.navigationItem.rightBarButtonItem = nil;
    }
    //: return;
    return;
}

//: #pragma mark - notification register
#pragma mark - notification register
//: - (void)registerObserver{
- (void)app{
    //: [self.webView addObserver:self forKeyPath:@"title" options:NSKeyValueObservingOptionNew context:nil];
    [self.find addObserver:self forKeyPath:StringFromMicaRestData(kStrawElevenName) options:NSKeyValueObservingOptionNew context:nil];

    //: [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(reloadNoti) name:UIApplicationDidBecomeActiveNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(withBbbb) name:UIApplicationDidBecomeActiveNotification object:nil];

    //: if ([self.urlString containsString:@"/dist/makeFriends/index.html"] ||
    if ([self.nameTime containsString:StringFromMicaRestData(kMetalLatteAvailableName)] ||
        //: [self.urlString containsString:@"exchange"]) {
        [self.nameTime containsString:StringFromMicaRestData(kProductiveValue)]) {

        ///更新提现气泡(隐藏气泡)
        //: [[NSNotificationCenter defaultCenter] postNotificationName:[NotificationDef ShowWithdrawNoti] object:nil userInfo:nil];
        [[NSNotificationCenter defaultCenter] postNotificationName:[CurrentUp success] object:nil userInfo:nil];
    }
}

//: - (void)removeObserver{
- (void)drop{
    //: [_webView removeObserver:self forKeyPath:NSStringFromSelector(@selector(title))];
    [_find removeObserver:self forKeyPath:NSStringFromSelector(@selector(title))];
    //: [[NSNotificationCenter defaultCenter] removeObserver:self];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

//: #pragma mark - request
#pragma mark - request
//: - (void)startRequest{
- (void)notIngathering{
    //: if (!self.requestReady) {
    if (!self.photo) {
        //: return;
        return;
    }

    //: if (self.config.isAlertType) {
    if (self.locationConfig.will) {
        //: [self clearJSBgColor];
        [self data];
        //: dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
        dispatch_after(dispatch_time((0ull), (int64_t)(1 * 1000000000ull)), dispatch_get_main_queue(), ^{
            //: [self excuteRequest];
            [self cost];
        //: });
        });
    //: }else{
    }else{
        //: [self excuteRequest];
        [self cost];
    }
}

//: - (void)excuteRequest{
- (void)cost{
    //: [self addUserScript:self.webView];
    [self userWithScript:self.find];
    //: NSMutableURLRequest* urlRequest = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:self.urlString]];
    NSMutableURLRequest* urlRequest = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:self.nameTime]];
    //: NSInteger uid = [AppManager sharedAppManager].loginUser.id;
    NSInteger uid = [PlayColorBbbb size].file.id;
    //: NSString* ssid = [AppManager sharedAppManager].sessionId;
    NSString* ssid = [PlayColorBbbb size].girl;
    //: NSString* cookieStr = [NSString stringWithFormat:@"PHPSESSID=%@",ssid];
    NSString* cookieStr = [NSString stringWithFormat:StringFromMicaRestData(k_taxName),ssid];
    //: if (uid) {
    if (uid) {
        //: cookieStr = [cookieStr stringByAppendingString:[NSString stringWithFormat:@";uid=%zd",uid]];
        cookieStr = [cookieStr stringByAppendingString:[NSString stringWithFormat:StringFromMicaRestData(kWithinTitle),uid]];
    }
    //: [urlRequest addValue:cookieStr forHTTPHeaderField:@"Cookie"];
    [urlRequest addValue:cookieStr forHTTPHeaderField:StringFromMicaRestData(k_wordText)];
    //: urlRequest.HTTPShouldHandleCookies = NO;
    urlRequest.HTTPShouldHandleCookies = NO;
    //: [self.webView loadRequest:urlRequest];
    [self.find loadRequest:urlRequest];
    //有些操作必须在Request开始后 比如调用JS
    //: [self clearJSBgColor];
    [self data];
    //: [self kkInitRightButton];
    [self top];
}

//: - (void)reloadUrl{
- (void)cellShow{

    //: [self.webView reload];
    [self.find reload];
}
// 重定向到url
//: - (void)redirectToUrlWith:(NSString *)redirectUrl {
- (void)finish:(NSString *)redirectUrl {

    //: NSURL *url = [NSURL URLWithString:redirectUrl];
    NSURL *url = [NSURL URLWithString:redirectUrl];
    //: if (url) {
    if (url) {
        //: NSURLRequest* request = [NSURLRequest requestWithURL:url];
        NSURLRequest* request = [NSURLRequest requestWithURL:url];
        //: [self.webView loadRequest:request];
        [self.find loadRequest:request];
    }

}

//: #pragma mark - cookie js insert
#pragma mark - cookie js insert
//: - (WKUserScript*)futhureCookieScript{
- (WKUserScript*)jam{
    //: NSArray* cookies = @[@{@"name":@"uid",@"value":@([AppManager sharedAppManager].loginUser.id).description},
    NSArray* cookies = @[@{StringFromMicaRestData(k_smokeTuneDisturbTitle):StringFromMicaRestData(k_fluentName),StringFromMicaRestData(kMagName):@([PlayColorBbbb size].file.id).description},
    //: @{@"name":@"PHPSESSID",@"value":[AppManager sharedAppManager].sessionId}];
    @{StringFromMicaRestData(k_smokeTuneDisturbTitle):StringFromMicaRestData(kHealEventText),StringFromMicaRestData(kMagName):[PlayColorBbbb size].girl}];
    //: NSString* htmlDomain = [NSURL URLWithString:[AppManager sharedAppManager].urlDomain].host;
    NSString* htmlDomain = [NSURL URLWithString:[PlayColorBbbb size].greetNotice].host;
    //: NSMutableString *script = [NSMutableString string];
    NSMutableString *script = [NSMutableString string];
    //: [script appendString:@"var cookieNames = document.cookie.split('; ').map(function(cookie) { return cookie.split('=')[0] } );\n"];
    [script appendString:StringFromMicaRestData(kSuraBunTitle)];
    //: for (int i = 0; i < cookies.count; ++i) {
    for (int i = 0; i < cookies.count; ++i) {
        //: NSDictionary* cookie = [cookies objectAtIndex:i];
        NSDictionary* cookie = [cookies objectAtIndex:i];
            //: NSString *string = [NSString stringWithFormat:@"%@=%@;domain=%@;path=%@",
            NSString *string = [NSString stringWithFormat:StringFromMicaRestData(k_sexualityValue),
                                //: cookie[@"name"],
                                cookie[StringFromMicaRestData(k_smokeTuneDisturbTitle)],
                                //: cookie[@"value"],
                                cookie[StringFromMicaRestData(kMagName)],
                                //: htmlDomain,
                                htmlDomain,
                                //: @"/"];
                                @"/"];
        //: if (i == 0){
        if (i == 0){
            //: [script appendFormat:@"document.cookie='%@';\n",string];
            [script appendFormat:StringFromMicaRestData(kAnalName),string];
        //: }else{
        }else{
            //: [script appendFormat:@"if (cookieNames.indexOf('%@') == -1) { document.cookie='%@'; };\n", cookie[@"name"], string];
            [script appendFormat:StringFromMicaRestData(kIqLanceName), cookie[StringFromMicaRestData(k_smokeTuneDisturbTitle)], string];
        }
    }
    //: WKUserScript * cookieScript = [[WKUserScript alloc] initWithSource:script injectionTime:WKUserScriptInjectionTimeAtDocumentStart forMainFrameOnly:NO];
    WKUserScript * cookieScript = [[WKUserScript alloc] initWithSource:script injectionTime:WKUserScriptInjectionTimeAtDocumentStart forMainFrameOnly:NO];
    // NSLog(@"script = %@",script);
    //: return cookieScript;
    return cookieScript;
}

//: - (void)addUserScript:(WKWebView*)webView{
- (void)userWithScript:(WKWebView*)webView{
    //: if (@available(iOS 11.0, *)) {
    if (@available(iOS 11.0, *)) {
        //: WKUserScript* js = [self futhureCookieScript];
        WKUserScript* js = [self jam];
        //: [webView.configuration.userContentController addUserScript:js];
        [webView.configuration.userContentController addUserScript:js];
        //: return;
        return;
    }
    //: NSString* htmlDomain = [NSURL URLWithString:[AppManager sharedAppManager].urlDomain].host;
    NSString* htmlDomain = [NSURL URLWithString:[PlayColorBbbb size].greetNotice].host;
    //: NSArray* cookies = @[@{@"name":@"uid",@"value":@([AppManager sharedAppManager].loginUser.id).description},
    NSArray* cookies = @[@{StringFromMicaRestData(k_smokeTuneDisturbTitle):StringFromMicaRestData(k_fluentName),StringFromMicaRestData(kMagName):@([PlayColorBbbb size].file.id).description},
    //: @{@"name":@"PHPSESSID",@"value":[AppManager sharedAppManager].sessionId}];
    @{StringFromMicaRestData(k_smokeTuneDisturbTitle):StringFromMicaRestData(kHealEventText),StringFromMicaRestData(kMagName):[PlayColorBbbb size].girl}];
    //: NSMutableString *script = [NSMutableString string];
    NSMutableString *script = [NSMutableString string];
    //: for (int i = 0; i < cookies.count; ++i) {
    for (int i = 0; i < cookies.count; ++i) {
        //: NSDictionary* cookie = [cookies objectAtIndex:i];
        NSDictionary* cookie = [cookies objectAtIndex:i];
        //: NSString *string = [NSString stringWithFormat:@"%@=%@;domain=%@;path=%@",
        NSString *string = [NSString stringWithFormat:StringFromMicaRestData(k_sexualityValue),
                            //: cookie[@"name"],
                            cookie[StringFromMicaRestData(k_smokeTuneDisturbTitle)],
                            //: cookie[@"value"],
                            cookie[StringFromMicaRestData(kMagName)],
                            //: htmlDomain,
                            htmlDomain,
                            //: @"/"];
                            @"/"];
        //: [script appendFormat:@"document.cookie='%@';",string];
        [script appendFormat:StringFromMicaRestData(kProtestElevenData),string];
    }
    //: NSLog(@"cookie = %@",script);
    //: WKUserScript* sp = [[WKUserScript alloc] initWithSource:script injectionTime:(WKUserScriptInjectionTimeAtDocumentStart) forMainFrameOnly:NO];
    WKUserScript* sp = [[WKUserScript alloc] initWithSource:script injectionTime:(WKUserScriptInjectionTimeAtDocumentStart) forMainFrameOnly:NO];
    //: [webView.configuration.userContentController addUserScript:sp];
    [webView.configuration.userContentController addUserScript:sp];
}

//iOS11+ 判断当前的WKWebViewCookie
//: - (void)checkWKCookieBeforeRequest:(WKWebViewConfiguration*)config {
- (void)addBy:(WKWebViewConfiguration*)config {
    //: if (@available(iOS 11.0, *)) {
    if (@available(iOS 11.0, *)) {
        //: if (self.requestReady) {
        if (self.photo) {
            //: return;
            return;
        }
        //: WKHTTPCookieStore *cookieStore = config.websiteDataStore.httpCookieStore;
        WKHTTPCookieStore *cookieStore = config.websiteDataStore.httpCookieStore;
        //: NSString* domain = [NSURL URLWithString:[AppManager sharedAppManager].urlDomain].host;
        NSString* domain = [NSURL URLWithString:[PlayColorBbbb size].greetNotice].host;
        //: NSInteger uid = [AppManager sharedAppManager].loginUser.id;
        NSInteger uid = [PlayColorBbbb size].file.id;
        //: @weakify(self);
        @autoreleasepool {} __weak __typeof__(self) self_weak_ = (self);;
        //: [cookieStore getAllCookies:^(NSArray<NSHTTPCookie *> * _Nonnull siteCookies) {
        [cookieStore getAllCookies:^(NSArray<NSHTTPCookie *> * _Nonnull siteCookies) {
            //: @strongify(self);
            @autoreleasepool {}
             __strong __typeof__(self) self = self_weak_;
                            ;
            //: __block BOOL hasUidCookie = NO;
            __block BOOL hasUidCookie = NO;
            //: __block BOOL hasSessionCookie = NO;
            __block BOOL hasSessionCookie = NO;
            //: [siteCookies enumerateObjectsUsingBlock:^(NSHTTPCookie * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
            [siteCookies enumerateObjectsUsingBlock:^(NSHTTPCookie * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
                //: NSLog(@"cookie = %@",obj);
                //: if ([obj.domain isEqualToString:domain]) {
                if ([obj.domain isEqualToString:domain]) {
                    //: if ([obj.name isEqualToString:COOKIE_NAME_PHPSESSID]) {
                    if ([obj.name isEqualToString:StringFromMicaRestData(kHealEventText)]) {
                        //: hasSessionCookie = YES;
                        hasSessionCookie = YES;
                    //: }else if ([obj.name isEqualToString:COOKIE_NAME_UID] && uid == [obj.value integerValue]){
                    }else if ([obj.name isEqualToString:StringFromMicaRestData(k_fluentName)] && uid == [obj.value integerValue]){
                        //: hasUidCookie = YES;
                        hasUidCookie = YES;
                    }
                }
                //: if (hasUidCookie && hasSessionCookie) {
                if (hasUidCookie && hasSessionCookie) {
                    //: *stop = YES;
                    *stop = YES;
                }
            //: }];
            }];
            //: if (hasUidCookie && hasSessionCookie) {
            if (hasUidCookie && hasSessionCookie) {
                //: self.requestReady = YES;
                self.photo = YES;
                //: [self startRequest];
                [self notIngathering];
            //: }else{
            }else{
                //: WKCookieType type = 0;
                WKCookieType type = 0;
                //: type = hasUidCookie ? type : (type | WKCookieTypeUid);
                type = hasUidCookie ? type : (type | WKCookieTypeUid);
                //: type = hasSessionCookie ? type : (type | WKCookieTypeSession);
                type = hasSessionCookie ? type : (type | WKCookieTypeSession);
                //: [self insertHTMLCookie:type config:config];
                [self detailReceive:type value:config];
            }
        //: }];
        }];
    }
}

//: - (void)insertHTMLCookie:(WKCookieType)type config:(WKWebViewConfiguration*)config{
- (void)detailReceive:(WKCookieType)type value:(WKWebViewConfiguration*)config{

    //: if (@available(iOS 11.0, *)) {
    if (@available(iOS 11.0, *)) {
        //: WKHTTPCookieStore *cookieStore = config.websiteDataStore.httpCookieStore;
        WKHTTPCookieStore *cookieStore = config.websiteDataStore.httpCookieStore;
        //: NSString* domain = [NSURL URLWithString:[AppManager sharedAppManager].urlDomain].host;
        NSString* domain = [NSURL URLWithString:[PlayColorBbbb size].greetNotice].host;
        //: NSURL *serverUrl = [NSURL URLWithString:[LFCAddressConfig sharedInstance].serverUrl];
        NSURL *serverUrl = [NSURL URLWithString:[NameAt sharedWithCon].picture];
        //: NSArray *cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:serverUrl];
        NSArray *cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:serverUrl];
        //: _group = dispatch_group_create();
        _group = dispatch_group_create();
        //: NSMutableArray* arr = [NSMutableArray array];
        NSMutableArray* arr = [NSMutableArray array];
        //: for (NSHTTPCookie* cookie in cookies) {
        for (NSHTTPCookie* cookie in cookies) {
            //: if ([cookie.name isEqualToString:COOKIE_NAME_UID] && (type & WKCookieTypeUid)) {
            if ([cookie.name isEqualToString:StringFromMicaRestData(k_fluentName)] && (type & WKCookieTypeUid)) {
                //: dispatch_group_enter(_group);
                dispatch_group_enter(_group);
                //: NSMutableDictionary *tmp = [NSMutableDictionary dictionaryWithDictionary:cookie.properties];
                NSMutableDictionary *tmp = [NSMutableDictionary dictionaryWithDictionary:cookie.properties];
                //: tmp[NSHTTPCookieName]   = COOKIE_NAME_UID;
                tmp[NSHTTPCookieName] = StringFromMicaRestData(k_fluentName);
                //: tmp[NSHTTPCookieDomain] = domain;
                tmp[NSHTTPCookieDomain] = domain;
                //: NSHTTPCookie* uidCookie = [NSHTTPCookie cookieWithProperties:tmp];
                NSHTTPCookie* uidCookie = [NSHTTPCookie cookieWithProperties:tmp];
                //: if (uidCookie) {
                if (uidCookie) {
                    //: [arr addObject:uidCookie];
                    [arr addObject:uidCookie];
                }

            //: }else if ([cookie.name isEqualToString:COOKIE_NAME_PHPSESSID] && (type & WKCookieTypeSession)){
            }else if ([cookie.name isEqualToString:StringFromMicaRestData(kHealEventText)] && (type & WKCookieTypeSession)){
                //: dispatch_group_enter(_group);
                dispatch_group_enter(_group);
                //: NSMutableDictionary *tmp = [NSMutableDictionary dictionaryWithDictionary:cookie.properties];
                NSMutableDictionary *tmp = [NSMutableDictionary dictionaryWithDictionary:cookie.properties];
                //: tmp[NSHTTPCookieName]   = COOKIE_NAME_PHPSESSID;
                tmp[NSHTTPCookieName] = StringFromMicaRestData(kHealEventText);
                //: tmp[NSHTTPCookieDomain] = domain;
                tmp[NSHTTPCookieDomain] = domain;
                //: NSHTTPCookie* phpCookie = [NSHTTPCookie cookieWithProperties:tmp];
                NSHTTPCookie* phpCookie = [NSHTTPCookie cookieWithProperties:tmp];
                //: if (phpCookie) {
                if (phpCookie) {
                    //: [arr addObject:phpCookie];
                    [arr addObject:phpCookie];
                }
            }
        }

        //: for (NSHTTPCookie* insertCookie in arr) {
        for (NSHTTPCookie* insertCookie in arr) {
            //: [cookieStore setCookie:insertCookie completionHandler:^{
            [cookieStore setCookie:insertCookie completionHandler:^{
                //: dispatch_group_leave(_group); 
                dispatch_group_leave(_group);
            //: }];
            }];
        }
        //: @weakify(self);
        @autoreleasepool {} __weak __typeof__(self) self_weak_ = (self);;
        //: dispatch_group_notify(_group, dispatch_get_main_queue(), ^{
        dispatch_group_notify(_group, dispatch_get_main_queue(), ^{
            //: @strongify(self);
            @autoreleasepool {}
             __strong __typeof__(self) self = self_weak_;
                            ;
            //: dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.1 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
            dispatch_after(dispatch_time((0ull), (int64_t)(0.1 * 1000000000ull)), dispatch_get_main_queue(), ^{
                //: self.requestReady = YES;
                self.photo = YES;
                //: [self startRequest];
                [self notIngathering];
            //: });
            });
        //: });
        });
    }
}

//: - (NSURLRequest *)fixRequest:(NSURLRequest *)request
- (NSURLRequest *)extendedFamily:(NSURLRequest *)request
{
    //: NSMutableURLRequest *fixedRequest;
    NSMutableURLRequest *fixedRequest;
    //: if ([request isKindOfClass:[NSMutableURLRequest class]]) {
    if ([request isKindOfClass:[NSMutableURLRequest class]]) {
        //: fixedRequest = (NSMutableURLRequest *)request;
        fixedRequest = (NSMutableURLRequest *)request;
    //: } else {
    } else {
        //: fixedRequest = request.mutableCopy;
        fixedRequest = request.mutableCopy;
    }
    //防止Cookie丢失
    //: NSDictionary *dict = [NSHTTPCookie requestHeaderFieldsWithCookies:[NSHTTPCookieStorage sharedHTTPCookieStorage].cookies];
    NSDictionary *dict = [NSHTTPCookie requestHeaderFieldsWithCookies:[NSHTTPCookieStorage sharedHTTPCookieStorage].cookies];
    //: if (dict.count) {
    if (dict.count) {
        //: NSMutableDictionary *mDict = request.allHTTPHeaderFields.mutableCopy;
        NSMutableDictionary *mDict = request.allHTTPHeaderFields.mutableCopy;
        //: [mDict setValuesForKeysWithDictionary:dict];
        [mDict setValuesForKeysWithDictionary:dict];
        //: fixedRequest.allHTTPHeaderFields = mDict;
        fixedRequest.allHTTPHeaderFields = mDict;
    }
    //: return fixedRequest;
    return fixedRequest;
}

//: - (void)currentCookies{
- (void)current{

//    NSArray* arr = [NSHTTPCookieStorage sharedHTTPCookieStorage].cookies;
//    [arr enumerateObjectsUsingBlock:^(id  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
//        NSLog(@"http cookie = %@",obj);
//    }];
}

//: - (void)hideLoadingBgViewAndCloseBtn:(BOOL)success {
- (void)part:(BOOL)success {
    //: [MBProgressHUD hideHUDForView:self.view animated:NO];
    [MBProgressHUD hideHUDForView:self.view animated:NO];
    //: [UIView animateWithDuration:0.1 animations:^{
    [UIView animateWithDuration:0.1 animations:^{
        //: self.view.backgroundColor = [UIColor clearColor];
        self.view.backgroundColor = [UIColor clearColor];
        //: if (success) {
        if (success) {
            //: self.closeBtn.hidden = YES;
            self.record.hidden = YES;
        }
    //: }];
    }];
}

//: #pragma mark - CALL JS METHOD
#pragma mark - CALL JS METHOD
//: - (void)clearJSBgColor{
- (void)data{
    //: if (self.config.clearBgColor) {
    if (self.locationConfig.send) {
        //: NSString *jsStr = [NSString stringWithFormat:@"document.getElementsByTagName('body')[0].style.background='rgba(0,0,0,0)'"];
        NSString *jsStr = [NSString stringWithFormat:StringFromMicaRestData(kMetalValue)];
        //: [self.webView evaluateJavaScript:jsStr completionHandler:^(id _Nullable data, NSError * _Nullable error) {
        [self.find evaluateJavaScript:jsStr completionHandler:^(id _Nullable data, NSError * _Nullable error) {

        //: }];
        }];
        //: [self.webView setOpaque:NO];
        [self.find setOpaque:NO];
    }
}

//: - (void)stringByEvaluatingJavaScriptFromString:(NSString*)jsStr{
- (void)angelName:(NSString*)jsStr{
    //: [self.webView evaluateJavaScript:jsStr completionHandler:^(id _Nullable data, NSError * _Nullable error) {
    [self.find evaluateJavaScript:jsStr completionHandler:^(id _Nullable data, NSError * _Nullable error) {

    //: }];
    }];
}

//: #pragma mark - GJWKJSHelperProtocol
#pragma mark - ModelAttention
//: - (void)showMoreView:(id)sender{
- (void)gift:(id)sender{

}

//: - (void)changeMenuButton:(NSString*)title :(NSString*)url {
- (void)buttonTableDhoteExpiry:(NSString*)title :(NSString*)url {

    //: if (self.config.forbiddenRightBtnChange) {
    if (self.locationConfig.status) {


    //: } else {
    } else {
        //: AtControl* customRightBarButton  = [AtControl buttonWithType:UIButtonTypeCustom];
        AtControl* customRightBarButton = [AtControl buttonWithType:UIButtonTypeCustom];
        //: customRightBarButton.titleLabel.font = [UIFont systemFontOfSize:14];
        customRightBarButton.titleLabel.font = [UIFont systemFontOfSize:14];
        //: [customRightBarButton setTitleColor:[ShowColor appTextColor] forState:UIControlStateNormal];
        [customRightBarButton setTitleColor:[ShowColor current] forState:UIControlStateNormal];
        //: [customRightBarButton addTarget:self action:@selector(customRightAction:) forControlEvents:UIControlEventTouchUpInside];
        [customRightBarButton addTarget:self action:@selector(rearName:) forControlEvents:UIControlEventTouchUpInside];
        //: [customRightBarButton setTitle:title forState:UIControlStateNormal];
        [customRightBarButton setTitle:title forState:UIControlStateNormal];
        //: [customRightBarButton sizeToFit];
        [customRightBarButton sizeToFit];
        //: customRightBarButton.viewInfo = [@{@"url":url} mutableCopy];
        customRightBarButton.key = [@{StringFromMicaRestData(kNatureCoordinateData):url} mutableCopy];
        //: self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:customRightBarButton];
        self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:customRightBarButton];
    }
}

//: - (void)toUrl:(NSString *)urlStr{
- (void)noMessage:(NSString *)urlStr{
    //: if (!FZUtils.isEmptyString(urlStr)) {
    if (!FZUtils.isEmptyString(urlStr)) {
        //: dispatch_async(dispatch_get_main_queue(), ^{
        dispatch_async(dispatch_get_main_queue(), ^{
            //: LFCWKWebViewController *webView = [[LFCWKWebViewController alloc] initWithURLString:urlStr];
            VideoPerspectiveViewController *webView = [[VideoPerspectiveViewController alloc] initWithSnapline:urlStr];
            //: [self.navigationController pushViewController:webView animated:YES];
            [self.navigationController pushViewController:webView animated:YES];
        //: });
        });
    }
}

//: - (void)pasteInviteCode:(NSString*)inviteCode{
- (void)filter:(NSString*)inviteCode{
    //: UIPasteboard *pasteboard = [UIPasteboard generalPasteboard];
    UIPasteboard *pasteboard = [UIPasteboard generalPasteboard];
    //: [pasteboard setPersistent:YES];
    [pasteboard setPersistent:YES];
    //: pasteboard.string = inviteCode;
    pasteboard.string = inviteCode;
}

//: #pragma mark - notification & KVO
#pragma mark - notification & KVO
//: -(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey,id> *)change context:(void *)context{
-(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey,id> *)change context:(void *)context{
    //: if([keyPath isEqualToString:@"title"] && object == self.webView){
    if([keyPath isEqualToString:StringFromMicaRestData(kStrawElevenName)] && object == self.find){
        //: self.navigationItem.title = self.webView.title;
        self.navigationItem.title = self.find.title;
    //: }else{
    }else{

    }
}


//: - (void)func__cancelCharge:(NSNotification *)noti{
- (void)tiptoe:(NSNotification *)noti{
    //: NSDictionary *userInfo = noti.userInfo;
    NSDictionary *userInfo = noti.userInfo;
    //: [self showStatusBarErrorStr:userInfo[@"msg"]?:@"支付取消"];
    [self push:userInfo[StringFromMicaRestData(k_hapVivoTitle)]?:StringFromMicaRestData(kCredibleCueSkyContent)];
}


//: - (void)reloadNoti{
- (void)withBbbb{
    //: if ([UGF5Manager sharedManager].needRefreshWeb) {
    if ([AtHead time].door) {
        //: [self performSelector:@selector(reloadUrl) withObject:nil afterDelay:0.5];
        [self performSelector:@selector(cellShow) withObject:nil afterDelay:0.5];
        //: [UGF5Manager sharedManager].needRefreshWeb = NO;
        [AtHead time].door = NO;
    }
}

//: #pragma mark - actions
#pragma mark - actions
//: - (void)closeAction:(id)sender{
- (void)viewwed:(id)sender{

    //: BOOL isCloseAll = NO;
    BOOL isCloseAll = NO;
    //: if ([sender isKindOfClass:[UIBarButtonItem class]]) {
    if ([sender isKindOfClass:[UIBarButtonItem class]]) {
        //: UIBarButtonItem *item = (UIBarButtonItem *)sender;
        UIBarButtonItem *item = (UIBarButtonItem *)sender;
        //: isCloseAll = [item.title isEqualToString:@"关闭"];
        isCloseAll = [item.title isEqualToString:StringFromMicaRestData(k_statValue)];
    //: }else if (sender == nil) {
    }else if (sender == nil) {
        //: isCloseAll = YES;
        isCloseAll = YES;
    }

    //: if ([self.webView canGoBack] && !isCloseAll) {
    if ([self.find canGoBack] && !isCloseAll) {
        //: WKNavigation *navigation = [self.webView goBack];
        WKNavigation *navigation = [self.find goBack];
        //: if (navigation) {
        if (navigation) {
            //: return;
            return;
        }
    }


    //: if (self.exitBlock) {
    if (self.block) {
        //: self.exitBlock();
        self.block();
    }

    //: else if (self.presentingViewController){
    else if (self.presentingViewController){
        //: [self dismissViewControllerAnimated:YES completion:nil];
        [self dismissViewControllerAnimated:YES completion:nil];
    //: }else{
    }else{
        //: [self.navigationController popViewControllerAnimated:YES];
        [self.navigationController popViewControllerAnimated:YES];
    }
}

//: - (void)goBackTapped{
- (void)incomeTitle{
    //: if (!self.webView.canGoBack) {
    if (!self.find.canGoBack) {
        //: return;
        return;
    }
    //: [self.webView goBack];
    [self.find goBack];
}

//: - (void)customRightAction:(AtControl*)sender{
- (void)rearName:(AtControl*)sender{

    //: if (![sender isKindOfClass:[AtControl class]]) {
    if (![sender isKindOfClass:[AtControl class]]) {
        //: return;
        return;
    }
    //: NSString *urlString = sender.viewInfo[@"url"];
    NSString *urlString = sender.key[StringFromMicaRestData(kNatureCoordinateData)];
    //: if (urlString.length>0) {
    if (urlString.length>0) {
        //: NSURL *url = [NSURL URLWithString:urlString];
        NSURL *url = [NSURL URLWithString:urlString];
        //: if (!url) {
        if (!url) {
            //: return;
            return;
        }
        //: NSURLRequest *request = [NSURLRequest requestWithURL:url];
        NSURLRequest *request = [NSURLRequest requestWithURL:url];
        //: self.urlString = urlString;
        self.nameTime = urlString;
        //: [self.webView loadRequest:request];
        [self.find loadRequest:request];
    }
}

//: - (void)recharge {
- (void)clickPic {
    //: [[AppManager sharedAppManager] func__pushRechargeViewController];
    [[PlayColorBbbb size] duringRank];
}

//半屏充值页
//: - (void)halfRecharge {
- (void)pairGuest {
    //: [[AppManager sharedAppManager] func__showHalfChargeViewWithTitle:nil];
    [[PlayColorBbbb size] natalDayName:nil];
}


/// 兑换记录
//: - (void)convertRecorder{
- (void)keepDetail{
    //: [[AppManager sharedAppManager] func__pushWebViewController:[LFCWebPageUrl func__GetWebUrlWithType:PushWebUrlType_coinExchangeRecord]];
    [[PlayColorBbbb size] extreme:[PicReplacement page:PushWebUrlType_coinExchangeRecord]];
}

//: - (void)funcrechargeRecordAction:(id)sender{
- (void)frameReceive:(id)sender{
    //: [[AppManager sharedAppManager] func__pushWebViewController:[LFCWebPageUrl func__GetWebUrlWithType:PushWebUrlType_incomeRecord]];
    [[PlayColorBbbb size] extreme:[PicReplacement page:PushWebUrlType_incomeRecord]];
}

//: - (void)goBackNeedAlert{
- (void)goDoing{

    //: [Helper showAlert:@"还差一步就完成登录了,确定放弃吗?" title:@" " cancelAction:@"放弃" cancelBlock:^{
    [WritingGrantBbbb antheralBbbb:StringFromMicaRestData(k_developName) clickWith:@" " wrapRemindVideo:StringFromMicaRestData(kHamGuyValue) album:^{
        //: [[AppManager sharedAppManager] showLoginActionSheel];
        [[PlayColorBbbb size] buttonBbbb];
    //: } okAction:@"不放弃" okBlock:^{
    } listBy:StringFromMicaRestData(kTheologicalText) model:^{
    //: }];
    }];
}

//: #pragma mark - WKNavigationDelegate
#pragma mark - WKNavigationDelegate
//开始加载一个Request
//: - (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler{
- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler{
    //: NSLog(@"load url = %@,type = %zd",navigationAction.request.URL.absoluteString,navigationAction.navigationType);
//    [self currentCookies];
    //: BOOL isHTTPOrFile = [navigationAction.request.URL.absoluteString isUrlOrFile];
    BOOL isHTTPOrFile = [navigationAction.request.URL.absoluteString mentionTitleBbbb];
    //: NSURLRequest* request = navigationAction.request;
    NSURLRequest* request = navigationAction.request;

    //: NSString *requestUrlString = request.URL.absoluteString;
    NSString *requestUrlString = request.URL.absoluteString;

    //: if ([requestUrlString containsString:@"income/auResult"]) {
    if ([requestUrlString containsString:StringFromMicaRestData(kBagHoleName)]) {
        //: NSDictionary *dict = [navigationAction.request.URL.query analysisUrlParametersFromQuery];
        NSDictionary *dict = [navigationAction.request.URL.query to];
        //: if (!FZUtils.isEmptyString(dict[@"status"])) {
        if (!FZUtils.isEmptyString(dict[StringFromMicaRestData(kTabLocalDiscoverValue)])) {
            //: [AppManager sharedAppManager].loginUser.identityVerifyStatus = [dict[@"status"] integerValue];
            [PlayColorBbbb size].file.identityVerifyStatus = [dict[StringFromMicaRestData(kTabLocalDiscoverValue)] integerValue];
        }
    }



    //: if (!isHTTPOrFile) {
    if (!isHTTPOrFile) {
        //: if ([[UIApplication sharedApplication] canOpenURL:request.URL]) {
        if ([[UIApplication sharedApplication] canOpenURL:request.URL]) {

            //: [UIApplication appOpenUrl:request.URL];
            [UIApplication appPrise:request.URL];

            //: dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.1 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
            dispatch_after(dispatch_time((0ull), (int64_t)(0.1 * 1000000000ull)), dispatch_get_main_queue(), ^{
                //: [self closeAction:nil];
                [self viewwed:nil];
            //: });
            });
            //: decisionHandler(WKNavigationActionPolicyCancel);
            decisionHandler(WKNavigationActionPolicyCancel);
            //: return;
            return;
        }
    }

    //: decisionHandler(WKNavigationActionPolicyAllow);
    decisionHandler(WKNavigationActionPolicyAllow);
}

//: - (void)webView:(WKWebView *)webView didStartProvisionalNavigation:(WKNavigation *)navigation{
- (void)webView:(WKWebView *)webView didStartProvisionalNavigation:(WKNavigation *)navigation{
    //: [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];

    //: if (self.config.showCloseBtn) {
    if (self.locationConfig.earnBtn) {
        //: [self.view bringSubviewToFront:self.closeBtn];
        [self.view bringSubviewToFront:self.record];
    }

}

//: - (void)webView:(WKWebView *)webView didFinishNavigation:(WKNavigation *)navigation{
- (void)webView:(WKWebView *)webView didFinishNavigation:(WKNavigation *)navigation{
    //: [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];

    //: _firstFinishLoaded = YES;
    _firstFinishLoaded = YES;

    //: [self kkInitLeftButton];
    [self phaseOfTheMoon];

    //: if (self.config.showCloseBtn || self.config.showLoadingView) {
    if (self.locationConfig.earnBtn || self.locationConfig.startBringHome) {
        //: [self hideLoadingBgViewAndCloseBtn:YES];
        [self part:YES];
    }

    //: [self clearJSBgColor];
    [self data];

    //: if (self.openWebSuccess) {
    if (self.collection) {
        //: self.openWebSuccess(YES);
        self.collection(YES);
    }
//: #if 0
}

//: - (void)webView:(WKWebView *)webView didFailProvisionalNavigation:(null_unspecified WKNavigation *)navigation withError:(NSError *)error{
- (void)webView:(WKWebView *)webView didFailProvisionalNavigation:(null_unspecified WKNavigation *)navigation withError:(NSError *)error{
    //: NSLog(@"didFailProvisionalNavigation error = %@",error);
    //: [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];

    //: if (self.config.showCloseBtn || self.config.showLoadingView) {
    if (self.locationConfig.earnBtn || self.locationConfig.startBringHome) {
        //: [self hideLoadingBgViewAndCloseBtn:NO];
        [self part:NO];
    }

    //: if (self.openWebSuccess) {
    if (self.collection) {
        //: self.openWebSuccess(NO);
        self.collection(NO);
    }
}

//: - (void)webView:(WKWebView *)webView didFailNavigation:(WKNavigation *)navigation withError:(NSError *)error{
- (void)webView:(WKWebView *)webView didFailNavigation:(WKNavigation *)navigation withError:(NSError *)error{
    //: NSLog(@"didFailNavigation error = %@",error);
    //: [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];

    //: if (self.config.showCloseBtn || self.config.showLoadingView) {
    if (self.locationConfig.earnBtn || self.locationConfig.startBringHome) {
        //: [self hideLoadingBgViewAndCloseBtn:NO];
        [self part:NO];
    }

    //: if (self.openWebSuccess) {
    if (self.collection) {
        //: self.openWebSuccess(NO);
        self.collection(NO);
    }
}

//: - (void)webView:(WKWebView *)webView didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential * _Nullable credential))completionHandler{
- (void)webView:(WKWebView *)webView didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential * _Nullable credential))completionHandler{
     // 判断服务器采用的验证方法
    //: if (challenge.protectionSpace.authenticationMethod == NSURLAuthenticationMethodServerTrust) {
    if (challenge.protectionSpace.authenticationMethod == NSURLAuthenticationMethodServerTrust) {
         // 如果没有错误的情况下 创建一个凭证，并使用证书
        //: if (challenge.previousFailureCount == 0) {
        if (challenge.previousFailureCount == 0) {
            //: NSURLCredential *credential = [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust];
            NSURLCredential *credential = [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust];
            //: completionHandler(NSURLSessionAuthChallengeUseCredential, credential);
            completionHandler(NSURLSessionAuthChallengeUseCredential, credential);
        //: }else {
        }else {
        // 验证失败，取消本次验证
            //: completionHandler(NSURLSessionAuthChallengeCancelAuthenticationChallenge, nil);
            completionHandler(NSURLSessionAuthChallengeCancelAuthenticationChallenge, nil);
        }
    //: }else {
    }else {
        //: completionHandler(NSURLSessionAuthChallengeCancelAuthenticationChallenge, nil);
        completionHandler(NSURLSessionAuthChallengeCancelAuthenticationChallenge, nil);

    }
}

//: #pragma mark - WKUIDelegate
#pragma mark - WKUIDelegate
//alert
//: - (void)webView:(WKWebView *)webView runJavaScriptAlertPanelWithMessage:(NSString *)message initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(void))completionHandler{
- (void)webView:(WKWebView *)webView runJavaScriptAlertPanelWithMessage:(NSString *)message initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(void))completionHandler{
    //: UIAlertController *alertController = [UIAlertController alertControllerWithTitle:@"提示" message:message?:@"" preferredStyle:UIAlertControllerStyleAlert];
    UIAlertController *alertController = [UIAlertController alertControllerWithTitle:StringFromMicaRestData(kFairlyTitle) message:message?:@"" preferredStyle:UIAlertControllerStyleAlert];
    //: [alertController addAction:([UIAlertAction actionWithTitle:@"确认" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
    [alertController addAction:([UIAlertAction actionWithTitle:StringFromMicaRestData(kChickValue) style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        //: completionHandler();
        completionHandler();
    //: }])];
    }])];
    //: [self presentViewController:alertController animated:YES completion:nil];
    [self presentViewController:alertController animated:YES completion:nil];

}
//confirm
//: - (void)webView:(WKWebView *)webView runJavaScriptConfirmPanelWithMessage:(NSString *)message initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(BOOL))completionHandler{
- (void)webView:(WKWebView *)webView runJavaScriptConfirmPanelWithMessage:(NSString *)message initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(BOOL))completionHandler{
    //: UIAlertController *alertController = [UIAlertController alertControllerWithTitle:@"提示" message:message?:@"" preferredStyle:UIAlertControllerStyleAlert];
    UIAlertController *alertController = [UIAlertController alertControllerWithTitle:StringFromMicaRestData(kFairlyTitle) message:message?:@"" preferredStyle:UIAlertControllerStyleAlert];
    //: [alertController addAction:([UIAlertAction actionWithTitle:@"取消" style:UIAlertActionStyleCancel handler:^(UIAlertAction * _Nonnull action) {
    [alertController addAction:([UIAlertAction actionWithTitle:StringFromMicaRestData(k_markRequestData) style:UIAlertActionStyleCancel handler:^(UIAlertAction * _Nonnull action) {
        //: completionHandler(NO);
        completionHandler(NO);
    //: }])];
    }])];
    //: [alertController addAction:([UIAlertAction actionWithTitle:@"确认" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
    [alertController addAction:([UIAlertAction actionWithTitle:StringFromMicaRestData(kChickValue) style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        //: completionHandler(YES);
        completionHandler(YES);
    //: }])];
    }])];
    //: [self presentViewController:alertController animated:YES completion:nil];
    [self presentViewController:alertController animated:YES completion:nil];
}
//prompt
//: - (void)webView:(WKWebView *)webView runJavaScriptTextInputPanelWithPrompt:(NSString *)prompt defaultText:(NSString *)defaultText initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(NSString * _Nullable))completionHandler{
- (void)webView:(WKWebView *)webView runJavaScriptTextInputPanelWithPrompt:(NSString *)prompt defaultText:(NSString *)defaultText initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(NSString * _Nullable))completionHandler{
    //: UIAlertController *alertController = [UIAlertController alertControllerWithTitle:prompt message:@"" preferredStyle:UIAlertControllerStyleAlert];
    UIAlertController *alertController = [UIAlertController alertControllerWithTitle:prompt message:@"" preferredStyle:UIAlertControllerStyleAlert];
    //: [alertController addTextFieldWithConfigurationHandler:^(UITextField * _Nonnull textField) {
    [alertController addTextFieldWithConfigurationHandler:^(UITextField * _Nonnull textField) {
        //: textField.text = defaultText;
        textField.text = defaultText;
    //: }];
    }];
    //: [alertController addAction:([UIAlertAction actionWithTitle:@"完成" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
    [alertController addAction:([UIAlertAction actionWithTitle:StringFromMicaRestData(kPossibleTitle) style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        //: completionHandler(alertController.textFields[0].text?:@"");
        completionHandler(alertController.textFields[0].text?:@"");
    //: }])];
    }])];

    //: [self presentViewController:alertController animated:YES completion:nil];
    [self presentViewController:alertController animated:YES completion:nil];
}

//: #pragma mark - views init
#pragma mark - views init
//: - (UIButton *)closeBtn{
- (UIButton *)record{
    //: if (!_closeBtn) {
    if (!_record) {
        //: _closeBtn = [UIButton buttonWithType:UIButtonTypeCustom];
        _record = [UIButton buttonWithType:UIButtonTypeCustom];
        //: [_closeBtn setImage:[UserTextImage imageNamed:@"webview43uLtm_esolc_nor"] forState:UIControlStateNormal];
        [_record setImage:[UserTextImage imageNamed:StringFromMicaRestData(kJudgmentData)] forState:UIControlStateNormal];
        //: [_closeBtn setImage:[UserTextImage imageNamed:@"webview8uKbrl_esolc_pre"] forState:UIControlStateHighlighted];
        [_record setImage:[UserTextImage imageNamed:StringFromMicaRestData(kPunishmentContent)] forState:UIControlStateHighlighted];
        //: [_closeBtn addTarget:self  action:@selector(closeAction:) forControlEvents:UIControlEventTouchUpInside];
        [_record addTarget:self action:@selector(viewwed:) forControlEvents:UIControlEventTouchUpInside];
        //: [self.view addSubview:_closeBtn];
        [self.view addSubview:_record];

        //: [_closeBtn mas_makeConstraints:^(MASConstraintMaker *make) {
        [_record mas_makeConstraints:^(MASConstraintMaker *make) {
            //: make.height.and.width.mas_equalTo(50);
            make.height.and.width.mas_equalTo(50);
            //: make.top.equalTo(self.view).offset(statusBarHeight());
            make.top.equalTo(self.view).offset(statusBarHeight());
            //: make.right.equalTo(self.view).offset(-10);
            make.right.equalTo(self.view).offset(-10);
        //: }];
        }];
    }
    //: return _closeBtn;
    return _record;
}

//: @end
@end


Byte * MicaRestDataToCache(Byte *data) {
    int offer = data[0];
    int everybody = data[1];
    int unhappySelect = data[2];
    if (!offer) return data + unhappySelect;
    for (int i = 0; i < everybody / 2; i++) {
        int begin = unhappySelect + i;
        int end = unhappySelect + everybody - i - 1;
        Byte temp = data[begin];
        data[begin] = data[end];
        data[end] = temp;
    }
    data[0] = 0;
    data[unhappySelect + everybody] = 0;
    return data + unhappySelect;
}

NSString *StringFromMicaRestData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)MicaRestDataToCache(data)];
}  
